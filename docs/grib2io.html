<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.2"/>
    <title>grib2io API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

        <h2>Contents</h2>
        <ul>
  <li><a href="#introduction">Introduction</a></li>
</ul>


        <h2>Submodules</h2>
        <ul>
                <li><a href="grib2io/tables.html">tables</a></li>
                <li><a href="grib2io/utils.html">utils</a></li>
        </ul>

        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#open">open</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#open.__init__">open</a>
                        </li>
                        <li>
                                <a class="function" href="#open.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#open.read">read</a>
                        </li>
                        <li>
                                <a class="function" href="#open.rewind">rewind</a>
                        </li>
                        <li>
                                <a class="function" href="#open.seek">seek</a>
                        </li>
                        <li>
                                <a class="function" href="#open.tell">tell</a>
                        </li>
                        <li>
                                <a class="function" href="#open.select">select</a>
                        </li>
                        <li>
                                <a class="function" href="#open.write">write</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Grib2Message">Grib2Message</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Grib2Message.__init__">Grib2Message</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.unpack">unpack</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.decode">decode</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.data">data</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.latlons">latlons</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.grid">grid</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.addlocal">addlocal</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.addgrid">addgrid</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.addfield">addfield</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.end">end</a>
                        </li>
                        <li>
                                <a class="function" href="#Grib2Message.to_bytes">to_bytes</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Grib2Metadata">Grib2Metadata</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Grib2Metadata.__init__">Grib2Metadata</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#show_config">show_config</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
grib2io    </h1>

                        <div class="docstring"><h1 id="introduction">Introduction</h1>

<p>grib2io is a Python package that provides an interface to the <a href="https://github.com/NOAA-EMC/NCEPLIBS-g2c">NCEP GRIB2 C (g2c)</a> 
library for the purpose of reading and writing WMO GRIdded Binary, Edition 2 (GRIB2) messages. A physical file can contain one 
or more GRIB2 messages.</p>

<p>GRIB2 file IO is performed directly in Python.  The unpacking/packing of GRIB2 integer, coded metadata and data sections is performed 
by the g2c library functions via the g2clib Cython wrapper module.  The decoding/encoding of GRIB2 metadata is translated into more 
descriptive, plain language metadata by looking up the integer code values against the appropriate GRIB2 code tables.  These code tables 
are a part of the grib2io module.</p>
</div>

                        <input id="grib2io-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="grib2io-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="kn">from</span> <span class="nn">._grib2io</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="kn">from</span> <span class="nn">._grib2io</span> <span class="kn">import</span> <span class="vm">__doc__</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="k">try</span><span class="p">:</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">__config__</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>    <span class="n">__version__</span> <span class="o">=</span> <span class="n">__config__</span><span class="o">.</span><span class="n">grib2io_version</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="k">except</span><span class="p">(</span><span class="ne">ImportError</span><span class="p">):</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>    <span class="k">pass</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span><span class="s1">&#39;Grib2Message&#39;</span><span class="p">,</span><span class="s1">&#39;Grib2Metadata&#39;</span><span class="p">,</span><span class="s1">&#39;show_config&#39;</span><span class="p">,</span><span class="s1">&#39;tables&#39;</span><span class="p">,</span><span class="s1">&#39;utils&#39;</span><span class="p">]</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="k">def</span> <span class="nf">show_config</span><span class="p">():</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">    Print grib2io build configuration information.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="kn">from</span> <span class="nn">g2clib</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">g2clib_version</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>    <span class="n">have_jpeg</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="s1">&#39;jasper&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="ow">or</span> <span class="s1">&#39;openjp2&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>    <span class="n">have_png</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="s1">&#39;png&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>    <span class="n">jpeglib</span> <span class="o">=</span> <span class="s1">&#39;OpenJPEG&#39;</span> <span class="k">if</span> <span class="s1">&#39;openjp2&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;Jasper&#39;</span> <span class="k">if</span> <span class="s1">&#39;jasper&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>    <span class="n">pnglib</span> <span class="o">=</span> <span class="s1">&#39;libpng&#39;</span> <span class="k">if</span> <span class="s1">&#39;png&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;grib2io version </span><span class="si">%s</span><span class="s2"> Configuration:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">__version__</span><span class="p">))</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">g2c library version:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">g2clib_version</span><span class="p">)</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">JPEG compression support:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">have_jpeg</span><span class="p">)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>    <span class="k">if</span> <span class="n">have_jpeg</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Library:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">jpeglib</span><span class="p">)</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">PNG compression support:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">have_png</span><span class="p">)</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="k">if</span> <span class="n">have_png</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Library:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">pnglib</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="open">
                            <input id="open-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">open</span>:

                <label class="view-source-button" for="open-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open-41"><a href="#open-41"><span class="linenos"> 41</span></a><span class="k">class</span> <span class="nc">open</span><span class="p">():</span>
</span><span id="open-42"><a href="#open-42"><span class="linenos"> 42</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-43"><a href="#open-43"><span class="linenos"> 43</span></a><span class="sd">    GRIB2 File Object.  A physical file can contain one or more GRIB2 messages.  When instantiated,</span>
</span><span id="open-44"><a href="#open-44"><span class="linenos"> 44</span></a><span class="sd">    class `grib2io.open`, the file named `filename` is opened for reading (`mode = &#39;r&#39;`) and is</span>
</span><span id="open-45"><a href="#open-45"><span class="linenos"> 45</span></a><span class="sd">    automatically indexed.  The indexing procedure reads some of the GRIB2 metadata for all GRIB2 Messages.</span>
</span><span id="open-46"><a href="#open-46"><span class="linenos"> 46</span></a>
</span><span id="open-47"><a href="#open-47"><span class="linenos"> 47</span></a><span class="sd">    A GRIB2 Message may contain submessages whereby Section 2-7 can be repeated.  grib2io accommodates</span>
</span><span id="open-48"><a href="#open-48"><span class="linenos"> 48</span></a><span class="sd">    for this by flattening any GRIB2 submessages into multiple individual messages.</span>
</span><span id="open-49"><a href="#open-49"><span class="linenos"> 49</span></a>
</span><span id="open-50"><a href="#open-50"><span class="linenos"> 50</span></a><span class="sd">    Attributes</span>
</span><span id="open-51"><a href="#open-51"><span class="linenos"> 51</span></a><span class="sd">    ----------</span>
</span><span id="open-52"><a href="#open-52"><span class="linenos"> 52</span></a>
</span><span id="open-53"><a href="#open-53"><span class="linenos"> 53</span></a><span class="sd">    **`mode`**: File IO mode of opening the file.</span>
</span><span id="open-54"><a href="#open-54"><span class="linenos"> 54</span></a>
</span><span id="open-55"><a href="#open-55"><span class="linenos"> 55</span></a><span class="sd">    **`name`**: Full path name of the GRIB2 file.</span>
</span><span id="open-56"><a href="#open-56"><span class="linenos"> 56</span></a>
</span><span id="open-57"><a href="#open-57"><span class="linenos"> 57</span></a><span class="sd">    **`messages`**: Count of GRIB2 Messages contained in the file.</span>
</span><span id="open-58"><a href="#open-58"><span class="linenos"> 58</span></a>
</span><span id="open-59"><a href="#open-59"><span class="linenos"> 59</span></a><span class="sd">    **`current_message`**: Current position of the file in units of GRIB2 Messages.</span>
</span><span id="open-60"><a href="#open-60"><span class="linenos"> 60</span></a>
</span><span id="open-61"><a href="#open-61"><span class="linenos"> 61</span></a><span class="sd">    **`size`**: Size of the file in units of bytes.</span>
</span><span id="open-62"><a href="#open-62"><span class="linenos"> 62</span></a>
</span><span id="open-63"><a href="#open-63"><span class="linenos"> 63</span></a><span class="sd">    **`closed`** `True` is file handle is close; `False` otherwise.</span>
</span><span id="open-64"><a href="#open-64"><span class="linenos"> 64</span></a>
</span><span id="open-65"><a href="#open-65"><span class="linenos"> 65</span></a><span class="sd">    **`decode `**: If `True` [DEFAULT] automatically decode metadata from unpacked </span>
</span><span id="open-66"><a href="#open-66"><span class="linenos"> 66</span></a><span class="sd">    section data for Grib2Messages.</span>
</span><span id="open-67"><a href="#open-67"><span class="linenos"> 67</span></a>
</span><span id="open-68"><a href="#open-68"><span class="linenos"> 68</span></a><span class="sd">    **`variables`**: Tuple containing a unique list of variable short names (i.e. GRIB2 abbreviation names).</span>
</span><span id="open-69"><a href="#open-69"><span class="linenos"> 69</span></a>
</span><span id="open-70"><a href="#open-70"><span class="linenos"> 70</span></a><span class="sd">    **`levels`**: Tuple containing a unique list of wgrib2-formatted level/layer strings.</span>
</span><span id="open-71"><a href="#open-71"><span class="linenos"> 71</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="open-72"><a href="#open-72"><span class="linenos"> 72</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="open-73"><a href="#open-73"><span class="linenos"> 73</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-74"><a href="#open-74"><span class="linenos"> 74</span></a><span class="sd">        `open` Constructor</span>
</span><span id="open-75"><a href="#open-75"><span class="linenos"> 75</span></a>
</span><span id="open-76"><a href="#open-76"><span class="linenos"> 76</span></a><span class="sd">        Parameters</span>
</span><span id="open-77"><a href="#open-77"><span class="linenos"> 77</span></a><span class="sd">        ----------</span>
</span><span id="open-78"><a href="#open-78"><span class="linenos"> 78</span></a>
</span><span id="open-79"><a href="#open-79"><span class="linenos"> 79</span></a><span class="sd">        **`filename`**: File name containing GRIB2 messages.</span>
</span><span id="open-80"><a href="#open-80"><span class="linenos"> 80</span></a>
</span><span id="open-81"><a href="#open-81"><span class="linenos"> 81</span></a><span class="sd">        **`mode `**: File access mode where `r` opens the files for reading only;</span>
</span><span id="open-82"><a href="#open-82"><span class="linenos"> 82</span></a><span class="sd">        `w` opens the file for writing.</span>
</span><span id="open-83"><a href="#open-83"><span class="linenos"> 83</span></a>
</span><span id="open-84"><a href="#open-84"><span class="linenos"> 84</span></a><span class="sd">        **`decode `**: If `True` [DEFAULT] automatically decode metadata from </span>
</span><span id="open-85"><a href="#open-85"><span class="linenos"> 85</span></a><span class="sd">        unpacked section data for Grib2Messages.</span>
</span><span id="open-86"><a href="#open-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-87"><a href="#open-87"><span class="linenos"> 87</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">]:</span>
</span><span id="open-88"><a href="#open-88"><span class="linenos"> 88</span></a>            <span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="o">+</span><span class="s1">&#39;b&#39;</span>
</span><span id="open-89"><a href="#open-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">buffering</span><span class="o">=</span><span class="n">ONE_MB</span><span class="p">)</span>
</span><span id="open-90"><a href="#open-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_hasindex</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="open-91"><a href="#open-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="open-92"><a href="#open-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
</span><span id="open-93"><a href="#open-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="open-94"><a href="#open-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-95"><a href="#open-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-96"><a href="#open-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="open-97"><a href="#open-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">closed</span>
</span><span id="open-98"><a href="#open-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decode</span> <span class="o">=</span> <span class="n">decode</span>
</span><span id="open-99"><a href="#open-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_index</span><span class="p">()</span>
</span><span id="open-100"><a href="#open-100"><span class="linenos">100</span></a>        <span class="c1"># FIX: Cannot perform reads on mode=&#39;a&#39;</span>
</span><span id="open-101"><a href="#open-101"><span class="linenos">101</span></a>        <span class="c1">#if &#39;a&#39; in self.mode and self.size &gt; 0: self._build_index()</span>
</span><span id="open-102"><a href="#open-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasindex</span><span class="p">:</span>
</span><span id="open-103"><a href="#open-103"><span class="linenos">103</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">]))))</span>
</span><span id="open-104"><a href="#open-104"><span class="linenos">104</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;levelString&#39;</span><span class="p">]))))</span>
</span><span id="open-105"><a href="#open-105"><span class="linenos">105</span></a>
</span><span id="open-106"><a href="#open-106"><span class="linenos">106</span></a>
</span><span id="open-107"><a href="#open-107"><span class="linenos">107</span></a>    <span class="k">def</span> <span class="fm">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
</span><span id="open-108"><a href="#open-108"><span class="linenos">108</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-109"><a href="#open-109"><span class="linenos">109</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-110"><a href="#open-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="open-111"><a href="#open-111"><span class="linenos">111</span></a>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>
</span><span id="open-112"><a href="#open-112"><span class="linenos">112</span></a>
</span><span id="open-113"><a href="#open-113"><span class="linenos">113</span></a>
</span><span id="open-114"><a href="#open-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-115"><a href="#open-115"><span class="linenos">115</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-116"><a href="#open-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-117"><a href="#open-117"><span class="linenos">117</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="open-118"><a href="#open-118"><span class="linenos">118</span></a>
</span><span id="open-119"><a href="#open-119"><span class="linenos">119</span></a>
</span><span id="open-120"><a href="#open-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atype</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
</span><span id="open-121"><a href="#open-121"><span class="linenos">121</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-122"><a href="#open-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-123"><a href="#open-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="open-124"><a href="#open-124"><span class="linenos">124</span></a>
</span><span id="open-125"><a href="#open-125"><span class="linenos">125</span></a>
</span><span id="open-126"><a href="#open-126"><span class="linenos">126</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-127"><a href="#open-127"><span class="linenos">127</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-128"><a href="#open-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-129"><a href="#open-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="open-130"><a href="#open-130"><span class="linenos">130</span></a>
</span><span id="open-131"><a href="#open-131"><span class="linenos">131</span></a>
</span><span id="open-132"><a href="#open-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-133"><a href="#open-133"><span class="linenos">133</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-134"><a href="#open-134"><span class="linenos">134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-135"><a href="#open-135"><span class="linenos">135</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">:</span>
</span><span id="open-136"><a href="#open-136"><span class="linenos">136</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-137"><a href="#open-137"><span class="linenos">137</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="open-138"><a href="#open-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="open-139"><a href="#open-139"><span class="linenos">139</span></a>            <span class="k">raise</span> <span class="ne">StopIteration</span>
</span><span id="open-140"><a href="#open-140"><span class="linenos">140</span></a>
</span><span id="open-141"><a href="#open-141"><span class="linenos">141</span></a>
</span><span id="open-142"><a href="#open-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-143"><a href="#open-143"><span class="linenos">143</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-144"><a href="#open-144"><span class="linenos">144</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-145"><a href="#open-145"><span class="linenos">145</span></a>        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="open-146"><a href="#open-146"><span class="linenos">146</span></a>        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="open-147"><a href="#open-147"><span class="linenos">147</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="open-148"><a href="#open-148"><span class="linenos">148</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
</span><span id="open-149"><a href="#open-149"><span class="linenos">149</span></a>                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
</span><span id="open-150"><a href="#open-150"><span class="linenos">150</span></a>        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
</span><span id="open-151"><a href="#open-151"><span class="linenos">151</span></a>
</span><span id="open-152"><a href="#open-152"><span class="linenos">152</span></a>
</span><span id="open-153"><a href="#open-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="open-154"><a href="#open-154"><span class="linenos">154</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-155"><a href="#open-155"><span class="linenos">155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-156"><a href="#open-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="nb">slice</span><span class="p">):</span>
</span><span id="open-157"><a href="#open-157"><span class="linenos">157</span></a>            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="open-158"><a href="#open-158"><span class="linenos">158</span></a>                <span class="n">beg</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="open-159"><a href="#open-159"><span class="linenos">159</span></a>                <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">+</span><span class="mi">1</span>
</span><span id="open-160"><a href="#open-160"><span class="linenos">160</span></a>                <span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="open-161"><a href="#open-161"><span class="linenos">161</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="open-162"><a href="#open-162"><span class="linenos">162</span></a>                <span class="n">beg</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">inc</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">)</span>
</span><span id="open-163"><a href="#open-163"><span class="linenos">163</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">beg</span><span class="p">,</span><span class="n">end</span><span class="p">,</span><span class="n">inc</span><span class="p">)]</span>
</span><span id="open-164"><a href="#open-164"><span class="linenos">164</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
</span><span id="open-165"><a href="#open-165"><span class="linenos">165</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open-166"><a href="#open-166"><span class="linenos">166</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;GRIB2 Message number 0 does not exist.&quot;</span><span class="p">)</span>
</span><span id="open-167"><a href="#open-167"><span class="linenos">167</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="open-168"><a href="#open-168"><span class="linenos">168</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">])</span>
</span><span id="open-169"><a href="#open-169"><span class="linenos">169</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">Grib2Message</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]),</span>
</span><span id="open-170"><a href="#open-170"><span class="linenos">170</span></a>                                 <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="open-171"><a href="#open-171"><span class="linenos">171</span></a>                                 <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;messageNumber&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">],</span>
</span><span id="open-172"><a href="#open-172"><span class="linenos">172</span></a>                                 <span class="n">decode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">)]</span>
</span><span id="open-173"><a href="#open-173"><span class="linenos">173</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
</span><span id="open-174"><a href="#open-174"><span class="linenos">174</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">shortName</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
</span><span id="open-175"><a href="#open-175"><span class="linenos">175</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="open-176"><a href="#open-176"><span class="linenos">176</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Key must be an integer, slice, or GRIB2 variable shortName.&#39;</span><span class="p">)</span>
</span><span id="open-177"><a href="#open-177"><span class="linenos">177</span></a>
</span><span id="open-178"><a href="#open-178"><span class="linenos">178</span></a>
</span><span id="open-179"><a href="#open-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">_build_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-180"><a href="#open-180"><span class="linenos">180</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-181"><a href="#open-181"><span class="linenos">181</span></a><span class="sd">        Perform indexing of GRIB2 Messages.</span>
</span><span id="open-182"><a href="#open-182"><span class="linenos">182</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-183"><a href="#open-183"><span class="linenos">183</span></a>        <span class="c1"># Initialize index dictionary</span>
</span><span id="open-184"><a href="#open-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-185"><a href="#open-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;discipline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-186"><a href="#open-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;edition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-187"><a href="#open-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-188"><a href="#open-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageOffset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-189"><a href="#open-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageBeginSection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-190"><a href="#open-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;isSubmessage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-191"><a href="#open-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;messageNumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-192"><a href="#open-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;identificationSection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-193"><a href="#open-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;refDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-194"><a href="#open-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;productDefinitionTemplateNumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-195"><a href="#open-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;productDefinitionTemplate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-196"><a href="#open-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;leadTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-197"><a href="#open-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-198"><a href="#open-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-199"><a href="#open-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;bitMap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-200"><a href="#open-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;levelString&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-201"><a href="#open-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;probString&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="open-202"><a href="#open-202"><span class="linenos">202</span></a>
</span><span id="open-203"><a href="#open-203"><span class="linenos">203</span></a>        <span class="c1"># Iterate</span>
</span><span id="open-204"><a href="#open-204"><span class="linenos">204</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="open-205"><a href="#open-205"><span class="linenos">205</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="open-206"><a href="#open-206"><span class="linenos">206</span></a>                <span class="c1"># Read first 4 bytes and decode...looking for &quot;GRIB&quot;</span>
</span><span id="open-207"><a href="#open-207"><span class="linenos">207</span></a>                <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
</span><span id="open-208"><a href="#open-208"><span class="linenos">208</span></a>                <span class="n">header</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;4s&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="open-209"><a href="#open-209"><span class="linenos">209</span></a>
</span><span id="open-210"><a href="#open-210"><span class="linenos">210</span></a>                <span class="c1"># Test header. Then get information from GRIB2 Section 0: the discipline</span>
</span><span id="open-211"><a href="#open-211"><span class="linenos">211</span></a>                <span class="c1"># number, edition number (should always be 2), and GRIB2 message size.</span>
</span><span id="open-212"><a href="#open-212"><span class="linenos">212</span></a>                <span class="c1"># Then iterate to check for submessages.</span>
</span><span id="open-213"><a href="#open-213"><span class="linenos">213</span></a>                <span class="k">if</span> <span class="n">header</span> <span class="o">==</span> <span class="s1">&#39;GRIB&#39;</span><span class="p">:</span>
</span><span id="open-214"><a href="#open-214"><span class="linenos">214</span></a>                    <span class="n">_issubmessage</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="open-215"><a href="#open-215"><span class="linenos">215</span></a>                    <span class="n">_submsgoffset</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-216"><a href="#open-216"><span class="linenos">216</span></a>                    <span class="n">_submsgbegin</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-217"><a href="#open-217"><span class="linenos">217</span></a>
</span><span id="open-218"><a href="#open-218"><span class="linenos">218</span></a>                    <span class="c1"># Read and unpack Section 0. Note that this is not done through</span>
</span><span id="open-219"><a href="#open-219"><span class="linenos">219</span></a>                    <span class="c1"># the g2clib.</span>
</span><span id="open-220"><a href="#open-220"><span class="linenos">220</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
</span><span id="open-221"><a href="#open-221"><span class="linenos">221</span></a>                    <span class="n">discipline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;B&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="open-222"><a href="#open-222"><span class="linenos">222</span></a>                    <span class="n">edition</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;B&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="open-223"><a href="#open-223"><span class="linenos">223</span></a>                    <span class="k">assert</span> <span class="n">edition</span> <span class="o">==</span> <span class="mi">2</span>
</span><span id="open-224"><a href="#open-224"><span class="linenos">224</span></a>                    <span class="n">size</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;Q&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-225"><a href="#open-225"><span class="linenos">225</span></a>
</span><span id="open-226"><a href="#open-226"><span class="linenos">226</span></a>                    <span class="c1"># Read and unpack Section 1</span>
</span><span id="open-227"><a href="#open-227"><span class="linenos">227</span></a>                    <span class="n">secsize</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;i&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-228"><a href="#open-228"><span class="linenos">228</span></a>                    <span class="n">secnum</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;B&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-229"><a href="#open-229"><span class="linenos">229</span></a>                    <span class="k">assert</span> <span class="n">secnum</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="open-230"><a href="#open-230"><span class="linenos">230</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</span><span id="open-231"><a href="#open-231"><span class="linenos">231</span></a>                    <span class="n">_grbmsg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">secsize</span><span class="p">)</span>
</span><span id="open-232"><a href="#open-232"><span class="linenos">232</span></a>                    <span class="n">_grbpos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-233"><a href="#open-233"><span class="linenos">233</span></a>                    <span class="n">_grbsec1</span><span class="p">,</span><span class="n">_grbpos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack1</span><span class="p">(</span><span class="n">_grbmsg</span><span class="p">,</span><span class="n">_grbpos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="open-234"><a href="#open-234"><span class="linenos">234</span></a>                    <span class="n">_grbsec1</span> <span class="o">=</span> <span class="n">_grbsec1</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="open-235"><a href="#open-235"><span class="linenos">235</span></a>                    <span class="n">_refdate</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">getdate</span><span class="p">(</span><span class="n">_grbsec1</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">_grbsec1</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">_grbsec1</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">_grbsec1</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
</span><span id="open-236"><a href="#open-236"><span class="linenos">236</span></a>                    <span class="n">secrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span><span id="open-237"><a href="#open-237"><span class="linenos">237</span></a>                    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="open-238"><a href="#open-238"><span class="linenos">238</span></a>                        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">secrange</span><span class="p">:</span>
</span><span id="open-239"><a href="#open-239"><span class="linenos">239</span></a>                            <span class="n">secsize</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;i&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-240"><a href="#open-240"><span class="linenos">240</span></a>                            <span class="n">secnum</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;B&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-241"><a href="#open-241"><span class="linenos">241</span></a>                            <span class="k">if</span> <span class="n">secnum</span> <span class="o">==</span> <span class="n">num</span><span class="p">:</span>
</span><span id="open-242"><a href="#open-242"><span class="linenos">242</span></a>                                <span class="k">if</span> <span class="n">secnum</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="open-243"><a href="#open-243"><span class="linenos">243</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</span><span id="open-244"><a href="#open-244"><span class="linenos">244</span></a>                                    <span class="n">_grbmsg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">secsize</span><span class="p">)</span>
</span><span id="open-245"><a href="#open-245"><span class="linenos">245</span></a>                                    <span class="n">_grbpos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-246"><a href="#open-246"><span class="linenos">246</span></a>                                    <span class="c1"># Unpack Section 3</span>
</span><span id="open-247"><a href="#open-247"><span class="linenos">247</span></a>                                    <span class="n">_gds</span><span class="p">,</span><span class="n">_gdtn</span><span class="p">,</span><span class="n">_deflist</span><span class="p">,</span><span class="n">_grbpos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack3</span><span class="p">(</span><span class="n">_grbmsg</span><span class="p">,</span><span class="n">_grbpos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="open-248"><a href="#open-248"><span class="linenos">248</span></a>                                <span class="k">elif</span> <span class="n">secnum</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="open-249"><a href="#open-249"><span class="linenos">249</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</span><span id="open-250"><a href="#open-250"><span class="linenos">250</span></a>                                    <span class="n">_grbmsg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">secsize</span><span class="p">)</span>
</span><span id="open-251"><a href="#open-251"><span class="linenos">251</span></a>                                    <span class="n">_grbpos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-252"><a href="#open-252"><span class="linenos">252</span></a>                                    <span class="c1"># Unpack Section 4</span>
</span><span id="open-253"><a href="#open-253"><span class="linenos">253</span></a>                                    <span class="n">_pdt</span><span class="p">,</span><span class="n">_pdtnum</span><span class="p">,</span><span class="n">_coordlist</span><span class="p">,</span><span class="n">_grbpos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack4</span><span class="p">(</span><span class="n">_grbmsg</span><span class="p">,</span><span class="n">_grbpos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="open-254"><a href="#open-254"><span class="linenos">254</span></a>                                    <span class="n">_pdt</span> <span class="o">=</span> <span class="n">_pdt</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="open-255"><a href="#open-255"><span class="linenos">255</span></a>                                    <span class="n">_varinfo</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_varinfo_from_table</span><span class="p">(</span><span class="n">discipline</span><span class="p">,</span><span class="n">_pdt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">_pdt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="open-256"><a href="#open-256"><span class="linenos">256</span></a>                                <span class="k">elif</span> <span class="n">secnum</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="open-257"><a href="#open-257"><span class="linenos">257</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</span><span id="open-258"><a href="#open-258"><span class="linenos">258</span></a>                                    <span class="n">_grbmsg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">secsize</span><span class="p">)</span>
</span><span id="open-259"><a href="#open-259"><span class="linenos">259</span></a>                                    <span class="n">_grbpos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open-260"><a href="#open-260"><span class="linenos">260</span></a>                                    <span class="c1"># Unpack Section 6. Save bitmap</span>
</span><span id="open-261"><a href="#open-261"><span class="linenos">261</span></a>                                    <span class="n">_bmap</span><span class="p">,</span><span class="n">_bmapflag</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack6</span><span class="p">(</span><span class="n">_grbmsg</span><span class="p">,</span><span class="n">_gds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">_grbpos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="open-262"><a href="#open-262"><span class="linenos">262</span></a>                                    <span class="k">if</span> <span class="n">_bmapflag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open-263"><a href="#open-263"><span class="linenos">263</span></a>                                        <span class="n">_bmap_save</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_bmap</span><span class="p">)</span>
</span><span id="open-264"><a href="#open-264"><span class="linenos">264</span></a>                                    <span class="k">elif</span> <span class="n">_bmapflag</span> <span class="o">==</span> <span class="mi">254</span><span class="p">:</span>
</span><span id="open-265"><a href="#open-265"><span class="linenos">265</span></a>                                        <span class="n">_bmap</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_bmap_save</span><span class="p">)</span>
</span><span id="open-266"><a href="#open-266"><span class="linenos">266</span></a>                                <span class="k">else</span><span class="p">:</span>
</span><span id="open-267"><a href="#open-267"><span class="linenos">267</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="n">secsize</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</span><span id="open-268"><a href="#open-268"><span class="linenos">268</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="open-269"><a href="#open-269"><span class="linenos">269</span></a>                                <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">secnum</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="open-270"><a href="#open-270"><span class="linenos">270</span></a>                                    <span class="k">pass</span> <span class="c1"># Allow this.  Just means no Local Use Section.</span>
</span><span id="open-271"><a href="#open-271"><span class="linenos">271</span></a>                                <span class="k">else</span><span class="p">:</span>
</span><span id="open-272"><a href="#open-272"><span class="linenos">272</span></a>                                    <span class="n">_issubmessage</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="open-273"><a href="#open-273"><span class="linenos">273</span></a>                                    <span class="n">_submsgoffset</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">])</span>
</span><span id="open-274"><a href="#open-274"><span class="linenos">274</span></a>                                    <span class="n">_submsgbegin</span> <span class="o">=</span> <span class="n">secnum</span>
</span><span id="open-275"><a href="#open-275"><span class="linenos">275</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</span><span id="open-276"><a href="#open-276"><span class="linenos">276</span></a>                                <span class="k">continue</span>
</span><span id="open-277"><a href="#open-277"><span class="linenos">277</span></a>                        <span class="n">trailer</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;4s&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="open-278"><a href="#open-278"><span class="linenos">278</span></a>                        <span class="k">if</span> <span class="n">trailer</span> <span class="o">==</span> <span class="s1">&#39;7777&#39;</span><span class="p">:</span>
</span><span id="open-279"><a href="#open-279"><span class="linenos">279</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open-280"><a href="#open-280"><span class="linenos">280</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="open-281"><a href="#open-281"><span class="linenos">281</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;discipline&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">discipline</span><span class="p">)</span>
</span><span id="open-282"><a href="#open-282"><span class="linenos">282</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;edition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edition</span><span class="p">)</span>
</span><span id="open-283"><a href="#open-283"><span class="linenos">283</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span id="open-284"><a href="#open-284"><span class="linenos">284</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;messageNumber&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">)</span>
</span><span id="open-285"><a href="#open-285"><span class="linenos">285</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;isSubmessage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_issubmessage</span><span class="p">)</span>
</span><span id="open-286"><a href="#open-286"><span class="linenos">286</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;identificationSection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_grbsec1</span><span class="p">)</span>
</span><span id="open-287"><a href="#open-287"><span class="linenos">287</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;refDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_refdate</span><span class="p">)</span>
</span><span id="open-288"><a href="#open-288"><span class="linenos">288</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;productDefinitionTemplateNumber&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_pdtnum</span><span class="p">)</span>
</span><span id="open-289"><a href="#open-289"><span class="linenos">289</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;productDefinitionTemplate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_pdt</span><span class="p">)</span>
</span><span id="open-290"><a href="#open-290"><span class="linenos">290</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;leadTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">getleadtime</span><span class="p">(</span><span class="n">_grbsec1</span><span class="p">,</span><span class="n">_pdtnum</span><span class="p">,</span><span class="n">_pdt</span><span class="p">))</span>
</span><span id="open-291"><a href="#open-291"><span class="linenos">291</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">getduration</span><span class="p">(</span><span class="n">_pdtnum</span><span class="p">,</span><span class="n">_pdt</span><span class="p">))</span>
</span><span id="open-292"><a href="#open-292"><span class="linenos">292</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_varinfo</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="open-293"><a href="#open-293"><span class="linenos">293</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;bitMap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_bmap</span><span class="p">)</span>
</span><span id="open-294"><a href="#open-294"><span class="linenos">294</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;levelString&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">get_wgrib2_level_string</span><span class="p">(</span><span class="o">*</span><span class="n">_pdt</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">15</span><span class="p">]))</span>
</span><span id="open-295"><a href="#open-295"><span class="linenos">295</span></a>                            <span class="k">if</span> <span class="n">_pdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">]:</span>
</span><span id="open-296"><a href="#open-296"><span class="linenos">296</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;probString&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_wgrib2_prob_string</span><span class="p">(</span><span class="o">*</span><span class="n">_pdt</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">22</span><span class="p">]))</span>
</span><span id="open-297"><a href="#open-297"><span class="linenos">297</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="open-298"><a href="#open-298"><span class="linenos">298</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;probString&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="open-299"><a href="#open-299"><span class="linenos">299</span></a>                            <span class="k">if</span> <span class="n">_issubmessage</span><span class="p">:</span>
</span><span id="open-300"><a href="#open-300"><span class="linenos">300</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageOffset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_submsgoffset</span><span class="p">)</span>
</span><span id="open-301"><a href="#open-301"><span class="linenos">301</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageBeginSection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_submsgbegin</span><span class="p">)</span>
</span><span id="open-302"><a href="#open-302"><span class="linenos">302</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="open-303"><a href="#open-303"><span class="linenos">303</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageOffset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="open-304"><a href="#open-304"><span class="linenos">304</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageBeginSection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_submsgbegin</span><span class="p">)</span>
</span><span id="open-305"><a href="#open-305"><span class="linenos">305</span></a>                            <span class="k">break</span>
</span><span id="open-306"><a href="#open-306"><span class="linenos">306</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="open-307"><a href="#open-307"><span class="linenos">307</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
</span><span id="open-308"><a href="#open-308"><span class="linenos">308</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open-309"><a href="#open-309"><span class="linenos">309</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="open-310"><a href="#open-310"><span class="linenos">310</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;discipline&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">discipline</span><span class="p">)</span>
</span><span id="open-311"><a href="#open-311"><span class="linenos">311</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;edition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edition</span><span class="p">)</span>
</span><span id="open-312"><a href="#open-312"><span class="linenos">312</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span id="open-313"><a href="#open-313"><span class="linenos">313</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;messageNumber&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">)</span>
</span><span id="open-314"><a href="#open-314"><span class="linenos">314</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;isSubmessage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_issubmessage</span><span class="p">)</span>
</span><span id="open-315"><a href="#open-315"><span class="linenos">315</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;identificationSection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_grbsec1</span><span class="p">)</span>
</span><span id="open-316"><a href="#open-316"><span class="linenos">316</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;refDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_refdate</span><span class="p">)</span>
</span><span id="open-317"><a href="#open-317"><span class="linenos">317</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;productDefinitionTemplateNumber&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_pdtnum</span><span class="p">)</span>
</span><span id="open-318"><a href="#open-318"><span class="linenos">318</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;productDefinitionTemplate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_pdt</span><span class="p">)</span>
</span><span id="open-319"><a href="#open-319"><span class="linenos">319</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;leadTime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">getleadtime</span><span class="p">(</span><span class="n">_grbsec1</span><span class="p">,</span><span class="n">_pdtnum</span><span class="p">,</span><span class="n">_pdt</span><span class="p">))</span>
</span><span id="open-320"><a href="#open-320"><span class="linenos">320</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">getduration</span><span class="p">(</span><span class="n">_pdtnum</span><span class="p">,</span><span class="n">_pdt</span><span class="p">))</span>
</span><span id="open-321"><a href="#open-321"><span class="linenos">321</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_varinfo</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="open-322"><a href="#open-322"><span class="linenos">322</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;bitMap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_bmap</span><span class="p">)</span>
</span><span id="open-323"><a href="#open-323"><span class="linenos">323</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;levelString&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">get_wgrib2_level_string</span><span class="p">(</span><span class="o">*</span><span class="n">_pdt</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">15</span><span class="p">]))</span>
</span><span id="open-324"><a href="#open-324"><span class="linenos">324</span></a>                            <span class="k">if</span> <span class="n">_pdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">]:</span>
</span><span id="open-325"><a href="#open-325"><span class="linenos">325</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;probString&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_wgrib2_prob_string</span><span class="p">(</span><span class="o">*</span><span class="n">_pdt</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">22</span><span class="p">]))</span>
</span><span id="open-326"><a href="#open-326"><span class="linenos">326</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="open-327"><a href="#open-327"><span class="linenos">327</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;probString&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="open-328"><a href="#open-328"><span class="linenos">328</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageOffset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_submsgoffset</span><span class="p">)</span>
</span><span id="open-329"><a href="#open-329"><span class="linenos">329</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageBeginSection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_submsgbegin</span><span class="p">)</span>
</span><span id="open-330"><a href="#open-330"><span class="linenos">330</span></a>                            <span class="k">continue</span>
</span><span id="open-331"><a href="#open-331"><span class="linenos">331</span></a>
</span><span id="open-332"><a href="#open-332"><span class="linenos">332</span></a>            <span class="k">except</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">error</span><span class="p">):</span>
</span><span id="open-333"><a href="#open-333"><span class="linenos">333</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="open-334"><a href="#open-334"><span class="linenos">334</span></a>                <span class="k">break</span>
</span><span id="open-335"><a href="#open-335"><span class="linenos">335</span></a>
</span><span id="open-336"><a href="#open-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_hasindex</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="open-337"><a href="#open-337"><span class="linenos">337</span></a>
</span><span id="open-338"><a href="#open-338"><span class="linenos">338</span></a>
</span><span id="open-339"><a href="#open-339"><span class="linenos">339</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-340"><a href="#open-340"><span class="linenos">340</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-341"><a href="#open-341"><span class="linenos">341</span></a><span class="sd">        Close the file handle</span>
</span><span id="open-342"><a href="#open-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-343"><a href="#open-343"><span class="linenos">343</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="open-344"><a href="#open-344"><span class="linenos">344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="open-345"><a href="#open-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">closed</span>
</span><span id="open-346"><a href="#open-346"><span class="linenos">346</span></a>
</span><span id="open-347"><a href="#open-347"><span class="linenos">347</span></a>
</span><span id="open-348"><a href="#open-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="open-349"><a href="#open-349"><span class="linenos">349</span></a>        <span class="sd">&quot;&quot;&quot;    </span>
</span><span id="open-350"><a href="#open-350"><span class="linenos">350</span></a><span class="sd">        Read num GRIB2 messages from the current position. If num &gt; total number of</span>
</span><span id="open-351"><a href="#open-351"><span class="linenos">351</span></a><span class="sd">        remaining messages in the file, then only those GRIB2 messages will be returned.</span>
</span><span id="open-352"><a href="#open-352"><span class="linenos">352</span></a>
</span><span id="open-353"><a href="#open-353"><span class="linenos">353</span></a><span class="sd">        Parameters</span>
</span><span id="open-354"><a href="#open-354"><span class="linenos">354</span></a><span class="sd">        ----------</span>
</span><span id="open-355"><a href="#open-355"><span class="linenos">355</span></a>
</span><span id="open-356"><a href="#open-356"><span class="linenos">356</span></a><span class="sd">        **`num`**: integer number of GRIB2 Message to read.</span>
</span><span id="open-357"><a href="#open-357"><span class="linenos">357</span></a>
</span><span id="open-358"><a href="#open-358"><span class="linenos">358</span></a><span class="sd">        Returns</span>
</span><span id="open-359"><a href="#open-359"><span class="linenos">359</span></a><span class="sd">        -------</span>
</span><span id="open-360"><a href="#open-360"><span class="linenos">360</span></a>
</span><span id="open-361"><a href="#open-361"><span class="linenos">361</span></a><span class="sd">        **`list`**: list of `grib2io.Grib2Message` instances.</span>
</span><span id="open-362"><a href="#open-362"><span class="linenos">362</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-363"><a href="#open-363"><span class="linenos">363</span></a>        <span class="n">msgs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="open-364"><a href="#open-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">:</span> <span class="k">return</span> <span class="n">msgs</span>
</span><span id="open-365"><a href="#open-365"><span class="linenos">365</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="open-366"><a href="#open-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open-367"><a href="#open-367"><span class="linenos">367</span></a>                <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="open-368"><a href="#open-368"><span class="linenos">368</span></a>                    <span class="n">msgrange</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="open-369"><a href="#open-369"><span class="linenos">369</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="open-370"><a href="#open-370"><span class="linenos">370</span></a>                    <span class="n">beg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
</span><span id="open-371"><a href="#open-371"><span class="linenos">371</span></a>                    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">num</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">num</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span>
</span><span id="open-372"><a href="#open-372"><span class="linenos">372</span></a>                    <span class="n">msgrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">beg</span><span class="p">,</span><span class="n">end</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="open-373"><a href="#open-373"><span class="linenos">373</span></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">msgrange</span><span class="p">:</span>
</span><span id="open-374"><a href="#open-374"><span class="linenos">374</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">])</span>
</span><span id="open-375"><a href="#open-375"><span class="linenos">375</span></a>                    <span class="n">msgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Grib2Message</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]),</span>
</span><span id="open-376"><a href="#open-376"><span class="linenos">376</span></a>                                             <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="open-377"><a href="#open-377"><span class="linenos">377</span></a>                                             <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;messageNumber&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">],</span>
</span><span id="open-378"><a href="#open-378"><span class="linenos">378</span></a>                                             <span class="n">decode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">))</span>
</span><span id="open-379"><a href="#open-379"><span class="linenos">379</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open-380"><a href="#open-380"><span class="linenos">380</span></a>        <span class="k">except</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
</span><span id="open-381"><a href="#open-381"><span class="linenos">381</span></a>            <span class="k">pass</span>
</span><span id="open-382"><a href="#open-382"><span class="linenos">382</span></a>        <span class="k">return</span> <span class="n">msgs</span>
</span><span id="open-383"><a href="#open-383"><span class="linenos">383</span></a>
</span><span id="open-384"><a href="#open-384"><span class="linenos">384</span></a>
</span><span id="open-385"><a href="#open-385"><span class="linenos">385</span></a>    <span class="k">def</span> <span class="nf">rewind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-386"><a href="#open-386"><span class="linenos">386</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-387"><a href="#open-387"><span class="linenos">387</span></a><span class="sd">        Set the position of the file to zero in units of GRIB2 messages.</span>
</span><span id="open-388"><a href="#open-388"><span class="linenos">388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-389"><a href="#open-389"><span class="linenos">389</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="open-390"><a href="#open-390"><span class="linenos">390</span></a>
</span><span id="open-391"><a href="#open-391"><span class="linenos">391</span></a>
</span><span id="open-392"><a href="#open-392"><span class="linenos">392</span></a>    <span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
</span><span id="open-393"><a href="#open-393"><span class="linenos">393</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-394"><a href="#open-394"><span class="linenos">394</span></a><span class="sd">        Set the position within the file in units of GRIB2 messages. The value of</span>
</span><span id="open-395"><a href="#open-395"><span class="linenos">395</span></a><span class="sd">        `pos` sets the position to that GRIB2 message, so the next record read will</span>
</span><span id="open-396"><a href="#open-396"><span class="linenos">396</span></a><span class="sd">        be `pos + 1`.</span>
</span><span id="open-397"><a href="#open-397"><span class="linenos">397</span></a>
</span><span id="open-398"><a href="#open-398"><span class="linenos">398</span></a><span class="sd">        Parameters</span>
</span><span id="open-399"><a href="#open-399"><span class="linenos">399</span></a><span class="sd">        ----------</span>
</span><span id="open-400"><a href="#open-400"><span class="linenos">400</span></a>
</span><span id="open-401"><a href="#open-401"><span class="linenos">401</span></a><span class="sd">        **`pos`**: GRIB2 Message number to set the read pointer to.</span>
</span><span id="open-402"><a href="#open-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-403"><a href="#open-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasindex</span><span class="p">:</span>
</span><span id="open-404"><a href="#open-404"><span class="linenos">404</span></a>            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open-405"><a href="#open-405"><span class="linenos">405</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="open-406"><a href="#open-406"><span class="linenos">406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">=</span> <span class="n">pos</span>
</span><span id="open-407"><a href="#open-407"><span class="linenos">407</span></a>            <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open-408"><a href="#open-408"><span class="linenos">408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">][</span><span class="n">pos</span><span class="p">])</span>
</span><span id="open-409"><a href="#open-409"><span class="linenos">409</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">=</span> <span class="n">pos</span>
</span><span id="open-410"><a href="#open-410"><span class="linenos">410</span></a>
</span><span id="open-411"><a href="#open-411"><span class="linenos">411</span></a>
</span><span id="open-412"><a href="#open-412"><span class="linenos">412</span></a>    <span class="k">def</span> <span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open-413"><a href="#open-413"><span class="linenos">413</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-414"><a href="#open-414"><span class="linenos">414</span></a><span class="sd">        Returns the position of the file in units of GRIB2 Messages.</span>
</span><span id="open-415"><a href="#open-415"><span class="linenos">415</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-416"><a href="#open-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span>
</span><span id="open-417"><a href="#open-417"><span class="linenos">417</span></a>
</span><span id="open-418"><a href="#open-418"><span class="linenos">418</span></a>
</span><span id="open-419"><a href="#open-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="open-420"><a href="#open-420"><span class="linenos">420</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-421"><a href="#open-421"><span class="linenos">421</span></a><span class="sd">        Returns a list of `grib2io.Grib2Message` instances based on the selection **`**kwargs`**.</span>
</span><span id="open-422"><a href="#open-422"><span class="linenos">422</span></a>
</span><span id="open-423"><a href="#open-423"><span class="linenos">423</span></a><span class="sd">        The following keywords are currently supported:</span>
</span><span id="open-424"><a href="#open-424"><span class="linenos">424</span></a>
</span><span id="open-425"><a href="#open-425"><span class="linenos">425</span></a><span class="sd">        **`duration : int`** specifiying the time duration (in unit of hours) of a GRIB2 Message that is </span>
</span><span id="open-426"><a href="#open-426"><span class="linenos">426</span></a><span class="sd">        determined from a period of time.</span>
</span><span id="open-427"><a href="#open-427"><span class="linenos">427</span></a>
</span><span id="open-428"><a href="#open-428"><span class="linenos">428</span></a><span class="sd">        **`leadTime : int`** specifying ending lead time (in units of hours) of a GRIB2 Message.</span>
</span><span id="open-429"><a href="#open-429"><span class="linenos">429</span></a>
</span><span id="open-430"><a href="#open-430"><span class="linenos">430</span></a><span class="sd">        **`level : str`** wgrib2-formatted layer/level string.</span>
</span><span id="open-431"><a href="#open-431"><span class="linenos">431</span></a>
</span><span id="open-432"><a href="#open-432"><span class="linenos">432</span></a><span class="sd">        **`percentile : int`** specify the percentile value.</span>
</span><span id="open-433"><a href="#open-433"><span class="linenos">433</span></a>
</span><span id="open-434"><a href="#open-434"><span class="linenos">434</span></a><span class="sd">        **`refDate : int`** specifying the reference date in `YYYYMMDDHH[MMSS]` format.</span>
</span><span id="open-435"><a href="#open-435"><span class="linenos">435</span></a>
</span><span id="open-436"><a href="#open-436"><span class="linenos">436</span></a><span class="sd">        **`shortName : str`** the GRIB2 `shortName`.  This is the abbreviation name found in the NCEP GRIB2 tables.</span>
</span><span id="open-437"><a href="#open-437"><span class="linenos">437</span></a>
</span><span id="open-438"><a href="#open-438"><span class="linenos">438</span></a><span class="sd">        **`threshold : str`** wgrib2-formatted probability threshold string.</span>
</span><span id="open-439"><a href="#open-439"><span class="linenos">439</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-440"><a href="#open-440"><span class="linenos">440</span></a>        <span class="n">kwargs_allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">,</span><span class="s1">&#39;leadTime&#39;</span><span class="p">,</span><span class="s1">&#39;level&#39;</span><span class="p">,</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span><span class="s1">&#39;refDate&#39;</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">,</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="open-441"><a href="#open-441"><span class="linenos">441</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="open-442"><a href="#open-442"><span class="linenos">442</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="open-443"><a href="#open-443"><span class="linenos">443</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs_allowed</span><span class="p">:</span> <span class="k">continue</span>
</span><span id="open-444"><a href="#open-444"><span class="linenos">444</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span>
</span><span id="open-445"><a href="#open-445"><span class="linenos">445</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-446"><a href="#open-446"><span class="linenos">446</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;leadTime&#39;</span><span class="p">:</span>
</span><span id="open-447"><a href="#open-447"><span class="linenos">447</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;leadTime&#39;</span><span class="p">]])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-448"><a href="#open-448"><span class="linenos">448</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;level&#39;</span><span class="p">:</span>
</span><span id="open-449"><a href="#open-449"><span class="linenos">449</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;levelString&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-450"><a href="#open-450"><span class="linenos">450</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;percentile&#39;</span><span class="p">:</span>
</span><span id="open-451"><a href="#open-451"><span class="linenos">451</span></a>                <span class="n">tmp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s2">&quot;productDefinitionTemplateNumber&quot;</span><span class="p">])</span><span class="o">==</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-452"><a href="#open-452"><span class="linenos">452</span></a>                <span class="n">tmp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s2">&quot;productDefinitionTemplateNumber&quot;</span><span class="p">])</span><span class="o">==</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-453"><a href="#open-453"><span class="linenos">453</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">tmp1</span><span class="p">,</span><span class="n">tmp2</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s2">&quot;productDefinitionTemplate&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">15</span><span class="p">]</span><span class="o">==</span><span class="n">v</span><span class="p">]</span>
</span><span id="open-454"><a href="#open-454"><span class="linenos">454</span></a>                <span class="k">del</span> <span class="n">tmp1</span><span class="p">,</span><span class="n">tmp2</span>
</span><span id="open-455"><a href="#open-455"><span class="linenos">455</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;refDate&#39;</span><span class="p">:</span>
</span><span id="open-456"><a href="#open-456"><span class="linenos">456</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;refDate&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-457"><a href="#open-457"><span class="linenos">457</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;shortName&#39;</span><span class="p">:</span>
</span><span id="open-458"><a href="#open-458"><span class="linenos">458</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-459"><a href="#open-459"><span class="linenos">459</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;threshold&#39;</span><span class="p">:</span>
</span><span id="open-460"><a href="#open-460"><span class="linenos">460</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;probString&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open-461"><a href="#open-461"><span class="linenos">461</span></a>        <span class="n">idxsarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="open-462"><a href="#open-462"><span class="linenos">462</span></a>        <span class="n">nidxs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">idxs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="open-463"><a href="#open-463"><span class="linenos">463</span></a>        <span class="k">if</span> <span class="n">nidxs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="open-464"><a href="#open-464"><span class="linenos">464</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxsarr</span><span class="p">]</span>
</span><span id="open-465"><a href="#open-465"><span class="linenos">465</span></a>        <span class="k">elif</span> <span class="n">nidxs</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="open-466"><a href="#open-466"><span class="linenos">466</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ii</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">idxsarr</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">()</span> <span class="k">if</span> <span class="n">ii</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">nidxs</span><span class="p">]]</span>
</span><span id="open-467"><a href="#open-467"><span class="linenos">467</span></a>
</span><span id="open-468"><a href="#open-468"><span class="linenos">468</span></a>
</span><span id="open-469"><a href="#open-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="open-470"><a href="#open-470"><span class="linenos">470</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open-471"><a href="#open-471"><span class="linenos">471</span></a><span class="sd">        Writes a packed GRIB2 message to file.</span>
</span><span id="open-472"><a href="#open-472"><span class="linenos">472</span></a>
</span><span id="open-473"><a href="#open-473"><span class="linenos">473</span></a><span class="sd">        Parameters</span>
</span><span id="open-474"><a href="#open-474"><span class="linenos">474</span></a><span class="sd">        ----------</span>
</span><span id="open-475"><a href="#open-475"><span class="linenos">475</span></a>
</span><span id="open-476"><a href="#open-476"><span class="linenos">476</span></a><span class="sd">        **`msg`**: instance of `Grib2Message`.</span>
</span><span id="open-477"><a href="#open-477"><span class="linenos">477</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open-478"><a href="#open-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="n">Grib2Message</span><span class="p">):</span>
</span><span id="open-479"><a href="#open-479"><span class="linenos">479</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">_msg</span><span class="p">)</span>
</span><span id="open-480"><a href="#open-480"><span class="linenos">480</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="open-481"><a href="#open-481"><span class="linenos">481</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open-482"><a href="#open-482"><span class="linenos">482</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open-483"><a href="#open-483"><span class="linenos">483</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="open-484"><a href="#open-484"><span class="linenos">484</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;msg must be a Grib2Message object.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>GRIB2 File Object.  A physical file can contain one or more GRIB2 messages.  When instantiated,
class <code><a href="#open">grib2io.open</a></code>, the file named <code>filename</code> is opened for reading (<code>mode = 'r'</code>) and is
automatically indexed.  The indexing procedure reads some of the GRIB2 metadata for all GRIB2 Messages.</p>

<p>A GRIB2 Message may contain submessages whereby Section 2-7 can be repeated.  grib2io accommodates
for this by flattening any GRIB2 submessages into multiple individual messages.</p>

<h2 id="attributes">Attributes</h2>

<p><strong><code>mode</code></strong>: File IO mode of opening the file.</p>

<p><strong><code>name</code></strong>: Full path name of the GRIB2 file.</p>

<p><strong><code>messages</code></strong>: Count of GRIB2 Messages contained in the file.</p>

<p><strong><code>current_message</code></strong>: Current position of the file in units of GRIB2 Messages.</p>

<p><strong><code>size</code></strong>: Size of the file in units of bytes.</p>

<p><strong><code>closed</code></strong> <code>True</code> is file handle is close; <code>False</code> otherwise.</p>

<p><strong><code>decode</code></strong>: If <code>True</code> [DEFAULT] automatically decode metadata from unpacked 
section data for Grib2Messages.</p>

<p><strong><code>variables</code></strong>: Tuple containing a unique list of variable short names (i.e. GRIB2 abbreviation names).</p>

<p><strong><code>levels</code></strong>: Tuple containing a unique list of wgrib2-formatted level/layer strings.</p>
</div>


                            <div id="open.__init__" class="classattr">
                                        <input id="open.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">open</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span>, </span><span class="param"><span class="n">decode</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="open.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.__init__-72"><a href="#open.__init__-72"><span class="linenos"> 72</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="open.__init__-73"><a href="#open.__init__-73"><span class="linenos"> 73</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open.__init__-74"><a href="#open.__init__-74"><span class="linenos"> 74</span></a><span class="sd">        `open` Constructor</span>
</span><span id="open.__init__-75"><a href="#open.__init__-75"><span class="linenos"> 75</span></a>
</span><span id="open.__init__-76"><a href="#open.__init__-76"><span class="linenos"> 76</span></a><span class="sd">        Parameters</span>
</span><span id="open.__init__-77"><a href="#open.__init__-77"><span class="linenos"> 77</span></a><span class="sd">        ----------</span>
</span><span id="open.__init__-78"><a href="#open.__init__-78"><span class="linenos"> 78</span></a>
</span><span id="open.__init__-79"><a href="#open.__init__-79"><span class="linenos"> 79</span></a><span class="sd">        **`filename`**: File name containing GRIB2 messages.</span>
</span><span id="open.__init__-80"><a href="#open.__init__-80"><span class="linenos"> 80</span></a>
</span><span id="open.__init__-81"><a href="#open.__init__-81"><span class="linenos"> 81</span></a><span class="sd">        **`mode `**: File access mode where `r` opens the files for reading only;</span>
</span><span id="open.__init__-82"><a href="#open.__init__-82"><span class="linenos"> 82</span></a><span class="sd">        `w` opens the file for writing.</span>
</span><span id="open.__init__-83"><a href="#open.__init__-83"><span class="linenos"> 83</span></a>
</span><span id="open.__init__-84"><a href="#open.__init__-84"><span class="linenos"> 84</span></a><span class="sd">        **`decode `**: If `True` [DEFAULT] automatically decode metadata from </span>
</span><span id="open.__init__-85"><a href="#open.__init__-85"><span class="linenos"> 85</span></a><span class="sd">        unpacked section data for Grib2Messages.</span>
</span><span id="open.__init__-86"><a href="#open.__init__-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.__init__-87"><a href="#open.__init__-87"><span class="linenos"> 87</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">]:</span>
</span><span id="open.__init__-88"><a href="#open.__init__-88"><span class="linenos"> 88</span></a>            <span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="o">+</span><span class="s1">&#39;b&#39;</span>
</span><span id="open.__init__-89"><a href="#open.__init__-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">buffering</span><span class="o">=</span><span class="n">ONE_MB</span><span class="p">)</span>
</span><span id="open.__init__-90"><a href="#open.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_hasindex</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="open.__init__-91"><a href="#open.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="open.__init__-92"><a href="#open.__init__-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
</span><span id="open.__init__-93"><a href="#open.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="open.__init__-94"><a href="#open.__init__-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open.__init__-95"><a href="#open.__init__-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="open.__init__-96"><a href="#open.__init__-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="open.__init__-97"><a href="#open.__init__-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">closed</span>
</span><span id="open.__init__-98"><a href="#open.__init__-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decode</span> <span class="o">=</span> <span class="n">decode</span>
</span><span id="open.__init__-99"><a href="#open.__init__-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_index</span><span class="p">()</span>
</span><span id="open.__init__-100"><a href="#open.__init__-100"><span class="linenos">100</span></a>        <span class="c1"># FIX: Cannot perform reads on mode=&#39;a&#39;</span>
</span><span id="open.__init__-101"><a href="#open.__init__-101"><span class="linenos">101</span></a>        <span class="c1">#if &#39;a&#39; in self.mode and self.size &gt; 0: self._build_index()</span>
</span><span id="open.__init__-102"><a href="#open.__init__-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasindex</span><span class="p">:</span>
</span><span id="open.__init__-103"><a href="#open.__init__-103"><span class="linenos">103</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">]))))</span>
</span><span id="open.__init__-104"><a href="#open.__init__-104"><span class="linenos">104</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;levelString&#39;</span><span class="p">]))))</span>
</span></pre></div>


            <div class="docstring"><p><code><a href="#open">open</a></code> Constructor</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>filename</code></strong>: File name containing GRIB2 messages.</p>

<p><strong><code>mode</code></strong>: File access mode where <code>r</code> opens the files for reading only;
<code>w</code> opens the file for writing.</p>

<p><strong><code>decode</code></strong>: If <code>True</code> [DEFAULT] automatically decode metadata from 
unpacked section data for Grib2Messages.</p>
</div>


                            </div>
                            <div id="open.close" class="classattr">
                                        <input id="open.close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="open.close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.close-339"><a href="#open.close-339"><span class="linenos">339</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open.close-340"><a href="#open.close-340"><span class="linenos">340</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open.close-341"><a href="#open.close-341"><span class="linenos">341</span></a><span class="sd">        Close the file handle</span>
</span><span id="open.close-342"><a href="#open.close-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.close-343"><a href="#open.close-343"><span class="linenos">343</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
</span><span id="open.close-344"><a href="#open.close-344"><span class="linenos">344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="open.close-345"><a href="#open.close-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">closed</span>
</span></pre></div>


            <div class="docstring"><p>Close the file handle</p>
</div>


                            </div>
                            <div id="open.read" class="classattr">
                                        <input id="open.read-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num</span><span class="o">=</span><span class="mi">1</span></span>)</span>

                <label class="view-source-button" for="open.read-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.read"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.read-348"><a href="#open.read-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="open.read-349"><a href="#open.read-349"><span class="linenos">349</span></a>        <span class="sd">&quot;&quot;&quot;    </span>
</span><span id="open.read-350"><a href="#open.read-350"><span class="linenos">350</span></a><span class="sd">        Read num GRIB2 messages from the current position. If num &gt; total number of</span>
</span><span id="open.read-351"><a href="#open.read-351"><span class="linenos">351</span></a><span class="sd">        remaining messages in the file, then only those GRIB2 messages will be returned.</span>
</span><span id="open.read-352"><a href="#open.read-352"><span class="linenos">352</span></a>
</span><span id="open.read-353"><a href="#open.read-353"><span class="linenos">353</span></a><span class="sd">        Parameters</span>
</span><span id="open.read-354"><a href="#open.read-354"><span class="linenos">354</span></a><span class="sd">        ----------</span>
</span><span id="open.read-355"><a href="#open.read-355"><span class="linenos">355</span></a>
</span><span id="open.read-356"><a href="#open.read-356"><span class="linenos">356</span></a><span class="sd">        **`num`**: integer number of GRIB2 Message to read.</span>
</span><span id="open.read-357"><a href="#open.read-357"><span class="linenos">357</span></a>
</span><span id="open.read-358"><a href="#open.read-358"><span class="linenos">358</span></a><span class="sd">        Returns</span>
</span><span id="open.read-359"><a href="#open.read-359"><span class="linenos">359</span></a><span class="sd">        -------</span>
</span><span id="open.read-360"><a href="#open.read-360"><span class="linenos">360</span></a>
</span><span id="open.read-361"><a href="#open.read-361"><span class="linenos">361</span></a><span class="sd">        **`list`**: list of `grib2io.Grib2Message` instances.</span>
</span><span id="open.read-362"><a href="#open.read-362"><span class="linenos">362</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.read-363"><a href="#open.read-363"><span class="linenos">363</span></a>        <span class="n">msgs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="open.read-364"><a href="#open.read-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">:</span> <span class="k">return</span> <span class="n">msgs</span>
</span><span id="open.read-365"><a href="#open.read-365"><span class="linenos">365</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="open.read-366"><a href="#open.read-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open.read-367"><a href="#open.read-367"><span class="linenos">367</span></a>                <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="open.read-368"><a href="#open.read-368"><span class="linenos">368</span></a>                    <span class="n">msgrange</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="open.read-369"><a href="#open.read-369"><span class="linenos">369</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="open.read-370"><a href="#open.read-370"><span class="linenos">370</span></a>                    <span class="n">beg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
</span><span id="open.read-371"><a href="#open.read-371"><span class="linenos">371</span></a>                    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">num</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">num</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span>
</span><span id="open.read-372"><a href="#open.read-372"><span class="linenos">372</span></a>                    <span class="n">msgrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">beg</span><span class="p">,</span><span class="n">end</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="open.read-373"><a href="#open.read-373"><span class="linenos">373</span></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">msgrange</span><span class="p">:</span>
</span><span id="open.read-374"><a href="#open.read-374"><span class="linenos">374</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">])</span>
</span><span id="open.read-375"><a href="#open.read-375"><span class="linenos">375</span></a>                    <span class="n">msgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Grib2Message</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]),</span>
</span><span id="open.read-376"><a href="#open.read-376"><span class="linenos">376</span></a>                                             <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="open.read-377"><a href="#open.read-377"><span class="linenos">377</span></a>                                             <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;messageNumber&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">],</span>
</span><span id="open.read-378"><a href="#open.read-378"><span class="linenos">378</span></a>                                             <span class="n">decode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">))</span>
</span><span id="open.read-379"><a href="#open.read-379"><span class="linenos">379</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open.read-380"><a href="#open.read-380"><span class="linenos">380</span></a>        <span class="k">except</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">):</span>
</span><span id="open.read-381"><a href="#open.read-381"><span class="linenos">381</span></a>            <span class="k">pass</span>
</span><span id="open.read-382"><a href="#open.read-382"><span class="linenos">382</span></a>        <span class="k">return</span> <span class="n">msgs</span>
</span></pre></div>


            <div class="docstring"><p>Read num GRIB2 messages from the current position. If num &gt; total number of
remaining messages in the file, then only those GRIB2 messages will be returned.</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>num</code></strong>: integer number of GRIB2 Message to read.</p>

<h2 id="returns">Returns</h2>

<p><strong><code>list</code></strong>: list of <code><a href="#Grib2Message">grib2io.Grib2Message</a></code> instances.</p>
</div>


                            </div>
                            <div id="open.rewind" class="classattr">
                                        <input id="open.rewind-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rewind</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="open.rewind-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.rewind"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.rewind-385"><a href="#open.rewind-385"><span class="linenos">385</span></a>    <span class="k">def</span> <span class="nf">rewind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open.rewind-386"><a href="#open.rewind-386"><span class="linenos">386</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open.rewind-387"><a href="#open.rewind-387"><span class="linenos">387</span></a><span class="sd">        Set the position of the file to zero in units of GRIB2 messages.</span>
</span><span id="open.rewind-388"><a href="#open.rewind-388"><span class="linenos">388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.rewind-389"><a href="#open.rewind-389"><span class="linenos">389</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set the position of the file to zero in units of GRIB2 messages.</p>
</div>


                            </div>
                            <div id="open.seek" class="classattr">
                                        <input id="open.seek-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">seek</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pos</span></span>)</span>

                <label class="view-source-button" for="open.seek-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.seek"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.seek-392"><a href="#open.seek-392"><span class="linenos">392</span></a>    <span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
</span><span id="open.seek-393"><a href="#open.seek-393"><span class="linenos">393</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open.seek-394"><a href="#open.seek-394"><span class="linenos">394</span></a><span class="sd">        Set the position within the file in units of GRIB2 messages. The value of</span>
</span><span id="open.seek-395"><a href="#open.seek-395"><span class="linenos">395</span></a><span class="sd">        `pos` sets the position to that GRIB2 message, so the next record read will</span>
</span><span id="open.seek-396"><a href="#open.seek-396"><span class="linenos">396</span></a><span class="sd">        be `pos + 1`.</span>
</span><span id="open.seek-397"><a href="#open.seek-397"><span class="linenos">397</span></a>
</span><span id="open.seek-398"><a href="#open.seek-398"><span class="linenos">398</span></a><span class="sd">        Parameters</span>
</span><span id="open.seek-399"><a href="#open.seek-399"><span class="linenos">399</span></a><span class="sd">        ----------</span>
</span><span id="open.seek-400"><a href="#open.seek-400"><span class="linenos">400</span></a>
</span><span id="open.seek-401"><a href="#open.seek-401"><span class="linenos">401</span></a><span class="sd">        **`pos`**: GRIB2 Message number to set the read pointer to.</span>
</span><span id="open.seek-402"><a href="#open.seek-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.seek-403"><a href="#open.seek-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasindex</span><span class="p">:</span>
</span><span id="open.seek-404"><a href="#open.seek-404"><span class="linenos">404</span></a>            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open.seek-405"><a href="#open.seek-405"><span class="linenos">405</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="open.seek-406"><a href="#open.seek-406"><span class="linenos">406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">=</span> <span class="n">pos</span>
</span><span id="open.seek-407"><a href="#open.seek-407"><span class="linenos">407</span></a>            <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="open.seek-408"><a href="#open.seek-408"><span class="linenos">408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">][</span><span class="n">pos</span><span class="p">])</span>
</span><span id="open.seek-409"><a href="#open.seek-409"><span class="linenos">409</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">=</span> <span class="n">pos</span>
</span></pre></div>


            <div class="docstring"><p>Set the position within the file in units of GRIB2 messages. The value of
<code>pos</code> sets the position to that GRIB2 message, so the next record read will
be <code>pos + 1</code>.</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>pos</code></strong>: GRIB2 Message number to set the read pointer to.</p>
</div>


                            </div>
                            <div id="open.tell" class="classattr">
                                        <input id="open.tell-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tell</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="open.tell-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.tell"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.tell-412"><a href="#open.tell-412"><span class="linenos">412</span></a>    <span class="k">def</span> <span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="open.tell-413"><a href="#open.tell-413"><span class="linenos">413</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open.tell-414"><a href="#open.tell-414"><span class="linenos">414</span></a><span class="sd">        Returns the position of the file in units of GRIB2 Messages.</span>
</span><span id="open.tell-415"><a href="#open.tell-415"><span class="linenos">415</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.tell-416"><a href="#open.tell-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span>
</span></pre></div>


            <div class="docstring"><p>Returns the position of the file in units of GRIB2 Messages.</p>
</div>


                            </div>
                            <div id="open.select" class="classattr">
                                        <input id="open.select-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">select</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="open.select-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.select"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.select-419"><a href="#open.select-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="open.select-420"><a href="#open.select-420"><span class="linenos">420</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open.select-421"><a href="#open.select-421"><span class="linenos">421</span></a><span class="sd">        Returns a list of `grib2io.Grib2Message` instances based on the selection **`**kwargs`**.</span>
</span><span id="open.select-422"><a href="#open.select-422"><span class="linenos">422</span></a>
</span><span id="open.select-423"><a href="#open.select-423"><span class="linenos">423</span></a><span class="sd">        The following keywords are currently supported:</span>
</span><span id="open.select-424"><a href="#open.select-424"><span class="linenos">424</span></a>
</span><span id="open.select-425"><a href="#open.select-425"><span class="linenos">425</span></a><span class="sd">        **`duration : int`** specifiying the time duration (in unit of hours) of a GRIB2 Message that is </span>
</span><span id="open.select-426"><a href="#open.select-426"><span class="linenos">426</span></a><span class="sd">        determined from a period of time.</span>
</span><span id="open.select-427"><a href="#open.select-427"><span class="linenos">427</span></a>
</span><span id="open.select-428"><a href="#open.select-428"><span class="linenos">428</span></a><span class="sd">        **`leadTime : int`** specifying ending lead time (in units of hours) of a GRIB2 Message.</span>
</span><span id="open.select-429"><a href="#open.select-429"><span class="linenos">429</span></a>
</span><span id="open.select-430"><a href="#open.select-430"><span class="linenos">430</span></a><span class="sd">        **`level : str`** wgrib2-formatted layer/level string.</span>
</span><span id="open.select-431"><a href="#open.select-431"><span class="linenos">431</span></a>
</span><span id="open.select-432"><a href="#open.select-432"><span class="linenos">432</span></a><span class="sd">        **`percentile : int`** specify the percentile value.</span>
</span><span id="open.select-433"><a href="#open.select-433"><span class="linenos">433</span></a>
</span><span id="open.select-434"><a href="#open.select-434"><span class="linenos">434</span></a><span class="sd">        **`refDate : int`** specifying the reference date in `YYYYMMDDHH[MMSS]` format.</span>
</span><span id="open.select-435"><a href="#open.select-435"><span class="linenos">435</span></a>
</span><span id="open.select-436"><a href="#open.select-436"><span class="linenos">436</span></a><span class="sd">        **`shortName : str`** the GRIB2 `shortName`.  This is the abbreviation name found in the NCEP GRIB2 tables.</span>
</span><span id="open.select-437"><a href="#open.select-437"><span class="linenos">437</span></a>
</span><span id="open.select-438"><a href="#open.select-438"><span class="linenos">438</span></a><span class="sd">        **`threshold : str`** wgrib2-formatted probability threshold string.</span>
</span><span id="open.select-439"><a href="#open.select-439"><span class="linenos">439</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.select-440"><a href="#open.select-440"><span class="linenos">440</span></a>        <span class="n">kwargs_allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">,</span><span class="s1">&#39;leadTime&#39;</span><span class="p">,</span><span class="s1">&#39;level&#39;</span><span class="p">,</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span><span class="s1">&#39;refDate&#39;</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">,</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="open.select-441"><a href="#open.select-441"><span class="linenos">441</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="open.select-442"><a href="#open.select-442"><span class="linenos">442</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="open.select-443"><a href="#open.select-443"><span class="linenos">443</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs_allowed</span><span class="p">:</span> <span class="k">continue</span>
</span><span id="open.select-444"><a href="#open.select-444"><span class="linenos">444</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span>
</span><span id="open.select-445"><a href="#open.select-445"><span class="linenos">445</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-446"><a href="#open.select-446"><span class="linenos">446</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;leadTime&#39;</span><span class="p">:</span>
</span><span id="open.select-447"><a href="#open.select-447"><span class="linenos">447</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">i</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;leadTime&#39;</span><span class="p">]])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-448"><a href="#open.select-448"><span class="linenos">448</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;level&#39;</span><span class="p">:</span>
</span><span id="open.select-449"><a href="#open.select-449"><span class="linenos">449</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;levelString&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-450"><a href="#open.select-450"><span class="linenos">450</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;percentile&#39;</span><span class="p">:</span>
</span><span id="open.select-451"><a href="#open.select-451"><span class="linenos">451</span></a>                <span class="n">tmp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s2">&quot;productDefinitionTemplateNumber&quot;</span><span class="p">])</span><span class="o">==</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-452"><a href="#open.select-452"><span class="linenos">452</span></a>                <span class="n">tmp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s2">&quot;productDefinitionTemplateNumber&quot;</span><span class="p">])</span><span class="o">==</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-453"><a href="#open.select-453"><span class="linenos">453</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">tmp1</span><span class="p">,</span><span class="n">tmp2</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s2">&quot;productDefinitionTemplate&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">15</span><span class="p">]</span><span class="o">==</span><span class="n">v</span><span class="p">]</span>
</span><span id="open.select-454"><a href="#open.select-454"><span class="linenos">454</span></a>                <span class="k">del</span> <span class="n">tmp1</span><span class="p">,</span><span class="n">tmp2</span>
</span><span id="open.select-455"><a href="#open.select-455"><span class="linenos">455</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;refDate&#39;</span><span class="p">:</span>
</span><span id="open.select-456"><a href="#open.select-456"><span class="linenos">456</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;refDate&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-457"><a href="#open.select-457"><span class="linenos">457</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;shortName&#39;</span><span class="p">:</span>
</span><span id="open.select-458"><a href="#open.select-458"><span class="linenos">458</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-459"><a href="#open.select-459"><span class="linenos">459</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;threshold&#39;</span><span class="p">:</span>
</span><span id="open.select-460"><a href="#open.select-460"><span class="linenos">460</span></a>                <span class="n">idxs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;probString&#39;</span><span class="p">])</span><span class="o">==</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="open.select-461"><a href="#open.select-461"><span class="linenos">461</span></a>        <span class="n">idxsarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="open.select-462"><a href="#open.select-462"><span class="linenos">462</span></a>        <span class="n">nidxs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">idxs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="open.select-463"><a href="#open.select-463"><span class="linenos">463</span></a>        <span class="k">if</span> <span class="n">nidxs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="open.select-464"><a href="#open.select-464"><span class="linenos">464</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxsarr</span><span class="p">]</span>
</span><span id="open.select-465"><a href="#open.select-465"><span class="linenos">465</span></a>        <span class="k">elif</span> <span class="n">nidxs</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="open.select-466"><a href="#open.select-466"><span class="linenos">466</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ii</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">idxsarr</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">()</span> <span class="k">if</span> <span class="n">ii</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">nidxs</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Returns a list of <code><a href="#Grib2Message">grib2io.Grib2Message</a></code> instances based on the selection <strong><code>**kwargs</code></strong>.</p>

<p>The following keywords are currently supported:</p>

<p><strong><code>duration : int</code></strong> specifiying the time duration (in unit of hours) of a GRIB2 Message that is 
determined from a period of time.</p>

<p><strong><code>leadTime : int</code></strong> specifying ending lead time (in units of hours) of a GRIB2 Message.</p>

<p><strong><code>level : str</code></strong> wgrib2-formatted layer/level string.</p>

<p><strong><code>percentile : int</code></strong> specify the percentile value.</p>

<p><strong><code>refDate : int</code></strong> specifying the reference date in <code>YYYYMMDDHH[MMSS]</code> format.</p>

<p><strong><code>shortName : str</code></strong> the GRIB2 <code>shortName</code>.  This is the abbreviation name found in the NCEP GRIB2 tables.</p>

<p><strong><code>threshold : str</code></strong> wgrib2-formatted probability threshold string.</p>
</div>


                            </div>
                            <div id="open.write" class="classattr">
                                        <input id="open.write-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">msg</span></span>)</span>

                <label class="view-source-button" for="open.write-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open.write"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open.write-469"><a href="#open.write-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="open.write-470"><a href="#open.write-470"><span class="linenos">470</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="open.write-471"><a href="#open.write-471"><span class="linenos">471</span></a><span class="sd">        Writes a packed GRIB2 message to file.</span>
</span><span id="open.write-472"><a href="#open.write-472"><span class="linenos">472</span></a>
</span><span id="open.write-473"><a href="#open.write-473"><span class="linenos">473</span></a><span class="sd">        Parameters</span>
</span><span id="open.write-474"><a href="#open.write-474"><span class="linenos">474</span></a><span class="sd">        ----------</span>
</span><span id="open.write-475"><a href="#open.write-475"><span class="linenos">475</span></a>
</span><span id="open.write-476"><a href="#open.write-476"><span class="linenos">476</span></a><span class="sd">        **`msg`**: instance of `Grib2Message`.</span>
</span><span id="open.write-477"><a href="#open.write-477"><span class="linenos">477</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="open.write-478"><a href="#open.write-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="n">Grib2Message</span><span class="p">):</span>
</span><span id="open.write-479"><a href="#open.write-479"><span class="linenos">479</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filehandle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">_msg</span><span class="p">)</span>
</span><span id="open.write-480"><a href="#open.write-480"><span class="linenos">480</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="open.write-481"><a href="#open.write-481"><span class="linenos">481</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open.write-482"><a href="#open.write-482"><span class="linenos">482</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_message</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="open.write-483"><a href="#open.write-483"><span class="linenos">483</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="open.write-484"><a href="#open.write-484"><span class="linenos">484</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;msg must be a Grib2Message object.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Writes a packed GRIB2 message to file.</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>msg</code></strong>: instance of <code><a href="#Grib2Message">Grib2Message</a></code>.</p>
</div>


                            </div>
                </section>
                <section id="Grib2Message">
                            <input id="Grib2Message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Grib2Message</span>:

                <label class="view-source-button" for="Grib2Message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message-487"><a href="#Grib2Message-487"><span class="linenos"> 487</span></a><span class="k">class</span> <span class="nc">Grib2Message</span><span class="p">:</span>
</span><span id="Grib2Message-488"><a href="#Grib2Message-488"><span class="linenos"> 488</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">discipline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idsect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Grib2Message-489"><a href="#Grib2Message-489"><span class="linenos"> 489</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-490"><a href="#Grib2Message-490"><span class="linenos"> 490</span></a><span class="sd">        Class Constructor. Instantiation of this class can handle a GRIB2 message from an existing </span>
</span><span id="Grib2Message-491"><a href="#Grib2Message-491"><span class="linenos"> 491</span></a><span class="sd">        file or the creation of new GRIB2 message.  To create a new GRIB2 message, provide the </span>
</span><span id="Grib2Message-492"><a href="#Grib2Message-492"><span class="linenos"> 492</span></a><span class="sd">        appropriate values to the arguments `discipline` and `idsect`.  When these 2 arguments </span>
</span><span id="Grib2Message-493"><a href="#Grib2Message-493"><span class="linenos"> 493</span></a><span class="sd">        are not `None`, then a new GRIB2 message is created. NOTE: All other keyword arguments </span>
</span><span id="Grib2Message-494"><a href="#Grib2Message-494"><span class="linenos"> 494</span></a><span class="sd">        are ignored when a new message is created.</span>
</span><span id="Grib2Message-495"><a href="#Grib2Message-495"><span class="linenos"> 495</span></a>
</span><span id="Grib2Message-496"><a href="#Grib2Message-496"><span class="linenos"> 496</span></a><span class="sd">        ...</span>
</span><span id="Grib2Message-497"><a href="#Grib2Message-497"><span class="linenos"> 497</span></a>
</span><span id="Grib2Message-498"><a href="#Grib2Message-498"><span class="linenos"> 498</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message-499"><a href="#Grib2Message-499"><span class="linenos"> 499</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message-500"><a href="#Grib2Message-500"><span class="linenos"> 500</span></a>
</span><span id="Grib2Message-501"><a href="#Grib2Message-501"><span class="linenos"> 501</span></a><span class="sd">        **`msg`**: Binary string representing the GRIB2 Message read from file.</span>
</span><span id="Grib2Message-502"><a href="#Grib2Message-502"><span class="linenos"> 502</span></a>
</span><span id="Grib2Message-503"><a href="#Grib2Message-503"><span class="linenos"> 503</span></a><span class="sd">        **`source`**: Source of where where this GRIB2 message originated </span>
</span><span id="Grib2Message-504"><a href="#Grib2Message-504"><span class="linenos"> 504</span></a><span class="sd">        from (i.e. the input file). This allow for interaction with the </span>
</span><span id="Grib2Message-505"><a href="#Grib2Message-505"><span class="linenos"> 505</span></a><span class="sd">        instance of `grib2io.open`. Default is None.</span>
</span><span id="Grib2Message-506"><a href="#Grib2Message-506"><span class="linenos"> 506</span></a>
</span><span id="Grib2Message-507"><a href="#Grib2Message-507"><span class="linenos"> 507</span></a><span class="sd">        **`num`**: integer GRIB2 Message number from `grib2io.open`. Default value is -1.</span>
</span><span id="Grib2Message-508"><a href="#Grib2Message-508"><span class="linenos"> 508</span></a>
</span><span id="Grib2Message-509"><a href="#Grib2Message-509"><span class="linenos"> 509</span></a><span class="sd">        **`decode`**: If True [DEFAULT], decode GRIB2 section lists into metadata </span>
</span><span id="Grib2Message-510"><a href="#Grib2Message-510"><span class="linenos"> 510</span></a><span class="sd">        instance variables.</span>
</span><span id="Grib2Message-511"><a href="#Grib2Message-511"><span class="linenos"> 511</span></a>
</span><span id="Grib2Message-512"><a href="#Grib2Message-512"><span class="linenos"> 512</span></a><span class="sd">        **`discipline`**: integer GRIB2 Discipline [GRIB2 Table 0.0](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table0-0.shtml)</span>
</span><span id="Grib2Message-513"><a href="#Grib2Message-513"><span class="linenos"> 513</span></a>
</span><span id="Grib2Message-514"><a href="#Grib2Message-514"><span class="linenos"> 514</span></a><span class="sd">        **`idsect`**: Sequence containing GRIB1 Identification Section values (Section 1).</span>
</span><span id="Grib2Message-515"><a href="#Grib2Message-515"><span class="linenos"> 515</span></a>
</span><span id="Grib2Message-516"><a href="#Grib2Message-516"><span class="linenos"> 516</span></a><span class="sd">        | Index | Description |</span>
</span><span id="Grib2Message-517"><a href="#Grib2Message-517"><span class="linenos"> 517</span></a><span class="sd">        | :---: | :---        |</span>
</span><span id="Grib2Message-518"><a href="#Grib2Message-518"><span class="linenos"> 518</span></a><span class="sd">        | idsect[0] | Id of orginating centre - [ON388 - Table 0](https://www.nco.ncep.noaa.gov/pmb/docs/on388/table0.html)|</span>
</span><span id="Grib2Message-519"><a href="#Grib2Message-519"><span class="linenos"> 519</span></a><span class="sd">        | idsect[1] | Id of orginating sub-centre - [ON388 - Table C](https://www.nco.ncep.noaa.gov/pmb/docs/on388/tablec.html)|</span>
</span><span id="Grib2Message-520"><a href="#Grib2Message-520"><span class="linenos"> 520</span></a><span class="sd">        | idsect[2] | GRIB Master Tables Version Number - [Code Table 1.0](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-0.shtml)|</span>
</span><span id="Grib2Message-521"><a href="#Grib2Message-521"><span class="linenos"> 521</span></a><span class="sd">        | idsect[3] | GRIB Local Tables Version Number - [Code Table 1.1](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-1.shtml)|</span>
</span><span id="Grib2Message-522"><a href="#Grib2Message-522"><span class="linenos"> 522</span></a><span class="sd">        | idsect[4] | Significance of Reference Time - [Code Table 1.2](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-2.shtml)|</span>
</span><span id="Grib2Message-523"><a href="#Grib2Message-523"><span class="linenos"> 523</span></a><span class="sd">        | idsect[5] | Reference Time - Year (4 digits)|</span>
</span><span id="Grib2Message-524"><a href="#Grib2Message-524"><span class="linenos"> 524</span></a><span class="sd">        | idsect[6] | Reference Time - Month|</span>
</span><span id="Grib2Message-525"><a href="#Grib2Message-525"><span class="linenos"> 525</span></a><span class="sd">        | idsect[7] | Reference Time - Day|</span>
</span><span id="Grib2Message-526"><a href="#Grib2Message-526"><span class="linenos"> 526</span></a><span class="sd">        | idsect[8] | Reference Time - Hour|</span>
</span><span id="Grib2Message-527"><a href="#Grib2Message-527"><span class="linenos"> 527</span></a><span class="sd">        | idsect[9] | Reference Time - Minute|</span>
</span><span id="Grib2Message-528"><a href="#Grib2Message-528"><span class="linenos"> 528</span></a><span class="sd">        | idsect[10] | Reference Time - Second|</span>
</span><span id="Grib2Message-529"><a href="#Grib2Message-529"><span class="linenos"> 529</span></a><span class="sd">        | idsect[11] | Production status of data - [Code Table 1.3](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-3.shtml)|</span>
</span><span id="Grib2Message-530"><a href="#Grib2Message-530"><span class="linenos"> 530</span></a><span class="sd">        | idsect[12] | Type of processed data - [Code Table 1.4](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-4.shtml)|</span>
</span><span id="Grib2Message-531"><a href="#Grib2Message-531"><span class="linenos"> 531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-532"><a href="#Grib2Message-532"><span class="linenos"> 532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
</span><span id="Grib2Message-533"><a href="#Grib2Message-533"><span class="linenos"> 533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span> <span class="o">=</span> <span class="n">num</span>
</span><span id="Grib2Message-534"><a href="#Grib2Message-534"><span class="linenos"> 534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span> <span class="o">=</span> <span class="n">decode</span>
</span><span id="Grib2Message-535"><a href="#Grib2Message-535"><span class="linenos"> 535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message-536"><a href="#Grib2Message-536"><span class="linenos"> 536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_datapos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message-537"><a href="#Grib2Message-537"><span class="linenos"> 537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Grib2Message-538"><a href="#Grib2Message-538"><span class="linenos"> 538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hasLocalUseSection</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Grib2Message-539"><a href="#Grib2Message-539"><span class="linenos"> 539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">isNDFD</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Grib2Message-540"><a href="#Grib2Message-540"><span class="linenos"> 540</span></a>        <span class="k">if</span> <span class="n">discipline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">idsect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-541"><a href="#Grib2Message-541"><span class="linenos"> 541</span></a>            <span class="c1"># New message</span>
</span><span id="Grib2Message-542"><a href="#Grib2Message-542"><span class="linenos"> 542</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_create</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">discipline</span><span class="p">,</span><span class="n">GRIB2_EDITION_NUMBER</span><span class="p">],</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message-543"><a href="#Grib2Message-543"><span class="linenos"> 543</span></a>                                                      <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idsect</span><span class="p">,</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">))</span>
</span><span id="Grib2Message-544"><a href="#Grib2Message-544"><span class="linenos"> 544</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-545"><a href="#Grib2Message-545"><span class="linenos"> 545</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-546"><a href="#Grib2Message-546"><span class="linenos"> 546</span></a>            <span class="c1"># Existing message</span>
</span><span id="Grib2Message-547"><a href="#Grib2Message-547"><span class="linenos"> 547</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="o">=</span> <span class="n">msg</span>
</span><span id="Grib2Message-548"><a href="#Grib2Message-548"><span class="linenos"> 548</span></a>        <span class="c1">#self.md5 = {}</span>
</span><span id="Grib2Message-549"><a href="#Grib2Message-549"><span class="linenos"> 549</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span>
</span><span id="Grib2Message-550"><a href="#Grib2Message-550"><span class="linenos"> 550</span></a>
</span><span id="Grib2Message-551"><a href="#Grib2Message-551"><span class="linenos"> 551</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message-552"><a href="#Grib2Message-552"><span class="linenos"> 552</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-553"><a href="#Grib2Message-553"><span class="linenos"> 553</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-554"><a href="#Grib2Message-554"><span class="linenos"> 554</span></a>        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Grib2Message-555"><a href="#Grib2Message-555"><span class="linenos"> 555</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Grib2Message-556"><a href="#Grib2Message-556"><span class="linenos"> 556</span></a>            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span> <span class="k">continue</span>
</span><span id="Grib2Message-557"><a href="#Grib2Message-557"><span class="linenos"> 557</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
</span><span id="Grib2Message-558"><a href="#Grib2Message-558"><span class="linenos"> 558</span></a>                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
</span><span id="Grib2Message-559"><a href="#Grib2Message-559"><span class="linenos"> 559</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
</span><span id="Grib2Message-560"><a href="#Grib2Message-560"><span class="linenos"> 560</span></a>                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
</span><span id="Grib2Message-561"><a href="#Grib2Message-561"><span class="linenos"> 561</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
</span><span id="Grib2Message-562"><a href="#Grib2Message-562"><span class="linenos"> 562</span></a>                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
</span><span id="Grib2Message-563"><a href="#Grib2Message-563"><span class="linenos"> 563</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-564"><a href="#Grib2Message-564"><span class="linenos"> 564</span></a>                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
</span><span id="Grib2Message-565"><a href="#Grib2Message-565"><span class="linenos"> 565</span></a>        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
</span><span id="Grib2Message-566"><a href="#Grib2Message-566"><span class="linenos"> 566</span></a>
</span><span id="Grib2Message-567"><a href="#Grib2Message-567"><span class="linenos"> 567</span></a>
</span><span id="Grib2Message-568"><a href="#Grib2Message-568"><span class="linenos"> 568</span></a>    <span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message-569"><a href="#Grib2Message-569"><span class="linenos"> 569</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-570"><a href="#Grib2Message-570"><span class="linenos"> 570</span></a><span class="sd">        Unpacks GRIB2 section data from the packed, binary message.</span>
</span><span id="Grib2Message-571"><a href="#Grib2Message-571"><span class="linenos"> 571</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-572"><a href="#Grib2Message-572"><span class="linenos"> 572</span></a>        <span class="c1"># Section 0 - Indicator Section</span>
</span><span id="Grib2Message-573"><a href="#Grib2Message-573"><span class="linenos"> 573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Grib2Message-574"><a href="#Grib2Message-574"><span class="linenos"> 574</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;4s&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-575"><a href="#Grib2Message-575"><span class="linenos"> 575</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;H&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-576"><a href="#Grib2Message-576"><span class="linenos"> 576</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span><span id="Grib2Message-577"><a href="#Grib2Message-577"><span class="linenos"> 577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
</span><span id="Grib2Message-578"><a href="#Grib2Message-578"><span class="linenos"> 578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;Q&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-579"><a href="#Grib2Message-579"><span class="linenos"> 579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="mi">16</span>
</span><span id="Grib2Message-580"><a href="#Grib2Message-580"><span class="linenos"> 580</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Grib2Message-581"><a href="#Grib2Message-581"><span class="linenos"> 581</span></a>        <span class="c1">#self.md5[0] = _getmd5str(self.indicatorSection)</span>
</span><span id="Grib2Message-582"><a href="#Grib2Message-582"><span class="linenos"> 582</span></a>
</span><span id="Grib2Message-583"><a href="#Grib2Message-583"><span class="linenos"> 583</span></a>        <span class="c1"># Section 1 - Identification Section via g2clib.unpack1()</span>
</span><span id="Grib2Message-584"><a href="#Grib2Message-584"><span class="linenos"> 584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message-585"><a href="#Grib2Message-585"><span class="linenos"> 585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message-586"><a href="#Grib2Message-586"><span class="linenos"> 586</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Grib2Message-587"><a href="#Grib2Message-587"><span class="linenos"> 587</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">65535</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">isNDFD</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Grib2Message-588"><a href="#Grib2Message-588"><span class="linenos"> 588</span></a>
</span><span id="Grib2Message-589"><a href="#Grib2Message-589"><span class="linenos"> 589</span></a>        <span class="c1"># After Section 1, perform rest of GRIB2 Decoding inside while loop</span>
</span><span id="Grib2Message-590"><a href="#Grib2Message-590"><span class="linenos"> 590</span></a>        <span class="c1"># to account for sub-messages.</span>
</span><span id="Grib2Message-591"><a href="#Grib2Message-591"><span class="linenos"> 591</span></a>        <span class="n">sectnum</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Grib2Message-592"><a href="#Grib2Message-592"><span class="linenos"> 592</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Grib2Message-593"><a href="#Grib2Message-593"><span class="linenos"> 593</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;7777&#39;</span><span class="p">:</span>
</span><span id="Grib2Message-594"><a href="#Grib2Message-594"><span class="linenos"> 594</span></a>                <span class="k">break</span>
</span><span id="Grib2Message-595"><a href="#Grib2Message-595"><span class="linenos"> 595</span></a>
</span><span id="Grib2Message-596"><a href="#Grib2Message-596"><span class="linenos"> 596</span></a>            <span class="c1"># Read the length and section number.</span>
</span><span id="Grib2Message-597"><a href="#Grib2Message-597"><span class="linenos"> 597</span></a>            <span class="n">sectlen</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;i&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message-598"><a href="#Grib2Message-598"><span class="linenos"> 598</span></a>            <span class="n">prevsectnum</span> <span class="o">=</span> <span class="n">sectnum</span>
</span><span id="Grib2Message-599"><a href="#Grib2Message-599"><span class="linenos"> 599</span></a>            <span class="n">sectnum</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;B&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">4</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message-600"><a href="#Grib2Message-600"><span class="linenos"> 600</span></a>
</span><span id="Grib2Message-601"><a href="#Grib2Message-601"><span class="linenos"> 601</span></a>            <span class="c1"># If the previous section number is &gt; current section number, then</span>
</span><span id="Grib2Message-602"><a href="#Grib2Message-602"><span class="linenos"> 602</span></a>            <span class="c1"># we have encountered a submessage.</span>
</span><span id="Grib2Message-603"><a href="#Grib2Message-603"><span class="linenos"> 603</span></a>            <span class="k">if</span> <span class="n">prevsectnum</span> <span class="o">&gt;</span> <span class="n">sectnum</span><span class="p">:</span> <span class="k">break</span>
</span><span id="Grib2Message-604"><a href="#Grib2Message-604"><span class="linenos"> 604</span></a>
</span><span id="Grib2Message-605"><a href="#Grib2Message-605"><span class="linenos"> 605</span></a>            <span class="c1"># Handle submessage accordingly.</span>
</span><span id="Grib2Message-606"><a href="#Grib2Message-606"><span class="linenos"> 606</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span><span class="nb">open</span><span class="p">):</span>
</span><span id="Grib2Message-607"><a href="#Grib2Message-607"><span class="linenos"> 607</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;isSubmessage&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]:</span>
</span><span id="Grib2Message-608"><a href="#Grib2Message-608"><span class="linenos"> 608</span></a>                    <span class="k">if</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageBeginSection&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]:</span>
</span><span id="Grib2Message-609"><a href="#Grib2Message-609"><span class="linenos"> 609</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageOffset&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]</span>
</span><span id="Grib2Message-610"><a href="#Grib2Message-610"><span class="linenos"> 610</span></a>
</span><span id="Grib2Message-611"><a href="#Grib2Message-611"><span class="linenos"> 611</span></a>            <span class="c1"># Section 2 - Local Use Section.</span>
</span><span id="Grib2Message-612"><a href="#Grib2Message-612"><span class="linenos"> 612</span></a>            <span class="k">if</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Grib2Message-613"><a href="#Grib2Message-613"><span class="linenos"> 613</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_lus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">5</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="n">sectlen</span><span class="p">]</span>
</span><span id="Grib2Message-614"><a href="#Grib2Message-614"><span class="linenos"> 614</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">+=</span> <span class="n">sectlen</span>
</span><span id="Grib2Message-615"><a href="#Grib2Message-615"><span class="linenos"> 615</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">hasLocalUseSection</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Grib2Message-616"><a href="#Grib2Message-616"><span class="linenos"> 616</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Grib2Message-617"><a href="#Grib2Message-617"><span class="linenos"> 617</span></a>                <span class="c1">#self.md5[2] = _getmd5str(self.identificationSection)</span>
</span><span id="Grib2Message-618"><a href="#Grib2Message-618"><span class="linenos"> 618</span></a>
</span><span id="Grib2Message-619"><a href="#Grib2Message-619"><span class="linenos"> 619</span></a>            <span class="c1"># Section 3 - Grid Definition Section.</span>
</span><span id="Grib2Message-620"><a href="#Grib2Message-620"><span class="linenos"> 620</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Grib2Message-621"><a href="#Grib2Message-621"><span class="linenos"> 621</span></a>                <span class="n">_gds</span><span class="p">,</span><span class="n">_gdt</span><span class="p">,</span><span class="n">_deflist</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message-622"><a href="#Grib2Message-622"><span class="linenos"> 622</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span> <span class="o">=</span> <span class="n">_gds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message-623"><a href="#Grib2Message-623"><span class="linenos"> 623</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">_gds</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;3.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-624"><a href="#Grib2Message-624"><span class="linenos"> 624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span> <span class="o">=</span> <span class="n">_gdt</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message-625"><a href="#Grib2Message-625"><span class="linenos"> 625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">defList</span> <span class="o">=</span> <span class="n">_deflist</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message-626"><a href="#Grib2Message-626"><span class="linenos"> 626</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Grib2Message-627"><a href="#Grib2Message-627"><span class="linenos"> 627</span></a>                <span class="c1">#self.md5[3] = _getmd5str([self.gridDefinitionTemplateNumber]+self.gridDefinitionTemplate)</span>
</span><span id="Grib2Message-628"><a href="#Grib2Message-628"><span class="linenos"> 628</span></a>
</span><span id="Grib2Message-629"><a href="#Grib2Message-629"><span class="linenos"> 629</span></a>            <span class="c1"># Section 4 - Product Definition Section.</span>
</span><span id="Grib2Message-630"><a href="#Grib2Message-630"><span class="linenos"> 630</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="Grib2Message-631"><a href="#Grib2Message-631"><span class="linenos"> 631</span></a>                <span class="n">_pdt</span><span class="p">,</span><span class="n">_pdtn</span><span class="p">,</span><span class="n">_coordlst</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message-632"><a href="#Grib2Message-632"><span class="linenos"> 632</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span> <span class="o">=</span> <span class="n">_pdt</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message-633"><a href="#Grib2Message-633"><span class="linenos"> 633</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">_pdtn</span><span class="p">),</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-634"><a href="#Grib2Message-634"><span class="linenos"> 634</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">coordinateList</span> <span class="o">=</span> <span class="n">_coordlst</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message-635"><a href="#Grib2Message-635"><span class="linenos"> 635</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Grib2Message-636"><a href="#Grib2Message-636"><span class="linenos"> 636</span></a>                <span class="c1">#self.md5[4] = _getmd5str([self.productDefinitionTemplateNumber]+self.productDefinitionTemplate)</span>
</span><span id="Grib2Message-637"><a href="#Grib2Message-637"><span class="linenos"> 637</span></a>
</span><span id="Grib2Message-638"><a href="#Grib2Message-638"><span class="linenos"> 638</span></a>            <span class="c1"># Section 5 - Data Representation Section.</span>
</span><span id="Grib2Message-639"><a href="#Grib2Message-639"><span class="linenos"> 639</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Grib2Message-640"><a href="#Grib2Message-640"><span class="linenos"> 640</span></a>                <span class="n">_drt</span><span class="p">,</span><span class="n">_drtn</span><span class="p">,</span><span class="n">_npts</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack5</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message-641"><a href="#Grib2Message-641"><span class="linenos"> 641</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span> <span class="o">=</span> <span class="n">_drt</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message-642"><a href="#Grib2Message-642"><span class="linenos"> 642</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">_drtn</span><span class="p">),</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-643"><a href="#Grib2Message-643"><span class="linenos"> 643</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">numberOfDataPoints</span> <span class="o">=</span> <span class="n">_npts</span>
</span><span id="Grib2Message-644"><a href="#Grib2Message-644"><span class="linenos"> 644</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="Grib2Message-645"><a href="#Grib2Message-645"><span class="linenos"> 645</span></a>                <span class="c1">#self.md5[5] = _getmd5str([self.dataRepresentationTemplateNumber]+self.dataRepresentationTemplate)</span>
</span><span id="Grib2Message-646"><a href="#Grib2Message-646"><span class="linenos"> 646</span></a>
</span><span id="Grib2Message-647"><a href="#Grib2Message-647"><span class="linenos"> 647</span></a>            <span class="c1"># Section 6 - Bitmap Section.</span>
</span><span id="Grib2Message-648"><a href="#Grib2Message-648"><span class="linenos"> 648</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="Grib2Message-649"><a href="#Grib2Message-649"><span class="linenos"> 649</span></a>                <span class="n">_bmap</span><span class="p">,</span><span class="n">_bmapflag</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack6</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message-650"><a href="#Grib2Message-650"><span class="linenos"> 650</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">=</span> <span class="n">_bmapflag</span>
</span><span id="Grib2Message-651"><a href="#Grib2Message-651"><span class="linenos"> 651</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-652"><a href="#Grib2Message-652"><span class="linenos"> 652</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">bitMap</span> <span class="o">=</span> <span class="n">_bmap</span>
</span><span id="Grib2Message-653"><a href="#Grib2Message-653"><span class="linenos"> 653</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">254</span><span class="p">:</span>
</span><span id="Grib2Message-654"><a href="#Grib2Message-654"><span class="linenos"> 654</span></a>                    <span class="c1"># Value of 254 says to use a previous bitmap in the file.</span>
</span><span id="Grib2Message-655"><a href="#Grib2Message-655"><span class="linenos"> 655</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message-656"><a href="#Grib2Message-656"><span class="linenos"> 656</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span><span class="nb">open</span><span class="p">):</span>
</span><span id="Grib2Message-657"><a href="#Grib2Message-657"><span class="linenos"> 657</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">bitMap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;bitMap&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]</span>
</span><span id="Grib2Message-658"><a href="#Grib2Message-658"><span class="linenos"> 658</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">+=</span> <span class="n">sectlen</span> <span class="c1"># IMPORTANT: This is here because g2clib.unpack6() does not return updated position.</span>
</span><span id="Grib2Message-659"><a href="#Grib2Message-659"><span class="linenos"> 659</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Grib2Message-660"><a href="#Grib2Message-660"><span class="linenos"> 660</span></a>                <span class="c1">#self.md5[6] = None</span>
</span><span id="Grib2Message-661"><a href="#Grib2Message-661"><span class="linenos"> 661</span></a>
</span><span id="Grib2Message-662"><a href="#Grib2Message-662"><span class="linenos"> 662</span></a>            <span class="c1"># Section 7 - Data Section (data unpacked when data() method is invoked).</span>
</span><span id="Grib2Message-663"><a href="#Grib2Message-663"><span class="linenos"> 663</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
</span><span id="Grib2Message-664"><a href="#Grib2Message-664"><span class="linenos"> 664</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_datapos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span>
</span><span id="Grib2Message-665"><a href="#Grib2Message-665"><span class="linenos"> 665</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">+=</span> <span class="n">sectlen</span> <span class="c1"># REMOVE THIS WHEN UNPACKING DATA IS IMPLEMENTED</span>
</span><span id="Grib2Message-666"><a href="#Grib2Message-666"><span class="linenos"> 666</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Grib2Message-667"><a href="#Grib2Message-667"><span class="linenos"> 667</span></a>                <span class="c1">#self.md5[7] = _getmd5str(self._msg[self._datapos:sectlen+1])</span>
</span><span id="Grib2Message-668"><a href="#Grib2Message-668"><span class="linenos"> 668</span></a>
</span><span id="Grib2Message-669"><a href="#Grib2Message-669"><span class="linenos"> 669</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-670"><a href="#Grib2Message-670"><span class="linenos"> 670</span></a>                <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unknown section number = </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sectnum</span>
</span><span id="Grib2Message-671"><a href="#Grib2Message-671"><span class="linenos"> 671</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span><span id="Grib2Message-672"><a href="#Grib2Message-672"><span class="linenos"> 672</span></a>
</span><span id="Grib2Message-673"><a href="#Grib2Message-673"><span class="linenos"> 673</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="Grib2Message-674"><a href="#Grib2Message-674"><span class="linenos"> 674</span></a>
</span><span id="Grib2Message-675"><a href="#Grib2Message-675"><span class="linenos"> 675</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message-676"><a href="#Grib2Message-676"><span class="linenos"> 676</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-677"><a href="#Grib2Message-677"><span class="linenos"> 677</span></a><span class="sd">        Decode the unpacked GRIB2 integer-coded metadata in human-readable form and linked to GRIB2 tables.</span>
</span><span id="Grib2Message-678"><a href="#Grib2Message-678"><span class="linenos"> 678</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-679"><a href="#Grib2Message-679"><span class="linenos"> 679</span></a>
</span><span id="Grib2Message-680"><a href="#Grib2Message-680"><span class="linenos"> 680</span></a>        <span class="c1"># Section 0 - Indictator Section</span>
</span><span id="Grib2Message-681"><a href="#Grib2Message-681"><span class="linenos"> 681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">discipline</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-682"><a href="#Grib2Message-682"><span class="linenos"> 682</span></a>
</span><span id="Grib2Message-683"><a href="#Grib2Message-683"><span class="linenos"> 683</span></a>        <span class="c1"># Section 1 - Indentification Section.</span>
</span><span id="Grib2Message-684"><a href="#Grib2Message-684"><span class="linenos"> 684</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">originatingCenter</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;originating_centers&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-685"><a href="#Grib2Message-685"><span class="linenos"> 685</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">originatingSubCenter</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;originating_subcenters&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-686"><a href="#Grib2Message-686"><span class="linenos"> 686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">masterTableInfo</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-687"><a href="#Grib2Message-687"><span class="linenos"> 687</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">localTableInfo</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-688"><a href="#Grib2Message-688"><span class="linenos"> 688</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">significanceOfReferenceTime</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.2&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-689"><a href="#Grib2Message-689"><span class="linenos"> 689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="Grib2Message-690"><a href="#Grib2Message-690"><span class="linenos"> 690</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</span><span id="Grib2Message-691"><a href="#Grib2Message-691"><span class="linenos"> 691</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
</span><span id="Grib2Message-692"><a href="#Grib2Message-692"><span class="linenos"> 692</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message-693"><a href="#Grib2Message-693"><span class="linenos"> 693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">minute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
</span><span id="Grib2Message-694"><a href="#Grib2Message-694"><span class="linenos"> 694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message-695"><a href="#Grib2Message-695"><span class="linenos"> 695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refDate</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="o">*</span><span class="mi">1000000</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="o">*</span><span class="mi">10000</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span>
</span><span id="Grib2Message-696"><a href="#Grib2Message-696"><span class="linenos"> 696</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dtReferenceDate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
</span><span id="Grib2Message-697"><a href="#Grib2Message-697"><span class="linenos"> 697</span></a>                                                 <span class="n">hour</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span><span class="n">minute</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span>
</span><span id="Grib2Message-698"><a href="#Grib2Message-698"><span class="linenos"> 698</span></a>                                                 <span class="n">second</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>
</span><span id="Grib2Message-699"><a href="#Grib2Message-699"><span class="linenos"> 699</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">productionStatus</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.3&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-700"><a href="#Grib2Message-700"><span class="linenos"> 700</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">typeOfData</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-701"><a href="#Grib2Message-701"><span class="linenos"> 701</span></a>
</span><span id="Grib2Message-702"><a href="#Grib2Message-702"><span class="linenos"> 702</span></a>        <span class="c1"># ----------------------------</span>
</span><span id="Grib2Message-703"><a href="#Grib2Message-703"><span class="linenos"> 703</span></a>        <span class="c1"># Section 3 -- Grid Definition</span>
</span><span id="Grib2Message-704"><a href="#Grib2Message-704"><span class="linenos"> 704</span></a>        <span class="c1"># ----------------------------</span>
</span><span id="Grib2Message-705"><a href="#Grib2Message-705"><span class="linenos"> 705</span></a>
</span><span id="Grib2Message-706"><a href="#Grib2Message-706"><span class="linenos"> 706</span></a>        <span class="c1"># Set shape of the Earth parameters</span>
</span><span id="Grib2Message-707"><a href="#Grib2Message-707"><span class="linenos"> 707</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">1200</span><span class="p">]:</span>
</span><span id="Grib2Message-708"><a href="#Grib2Message-708"><span class="linenos"> 708</span></a>            <span class="n">earthparams</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-709"><a href="#Grib2Message-709"><span class="linenos"> 709</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-710"><a href="#Grib2Message-710"><span class="linenos"> 710</span></a>            <span class="n">earthparams</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">earth_params</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="Grib2Message-711"><a href="#Grib2Message-711"><span class="linenos"> 711</span></a>        <span class="k">if</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;spherical&#39;</span><span class="p">:</span>
</span><span id="Grib2Message-712"><a href="#Grib2Message-712"><span class="linenos"> 712</span></a>            <span class="k">if</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-713"><a href="#Grib2Message-713"><span class="linenos"> 713</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Grib2Message-714"><a href="#Grib2Message-714"><span class="linenos"> 714</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-715"><a href="#Grib2Message-715"><span class="linenos"> 715</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-716"><a href="#Grib2Message-716"><span class="linenos"> 716</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-717"><a href="#Grib2Message-717"><span class="linenos"> 717</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span>
</span><span id="Grib2Message-718"><a href="#Grib2Message-718"><span class="linenos"> 718</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-719"><a href="#Grib2Message-719"><span class="linenos"> 719</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-720"><a href="#Grib2Message-720"><span class="linenos"> 720</span></a>        <span class="k">elif</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;oblateSpheroid&#39;</span><span class="p">:</span>
</span><span id="Grib2Message-721"><a href="#Grib2Message-721"><span class="linenos"> 721</span></a>            <span class="k">if</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;major_axis&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;minor_axis&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-722"><a href="#Grib2Message-722"><span class="linenos"> 722</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Grib2Message-723"><a href="#Grib2Message-723"><span class="linenos"> 723</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Grib2Message-724"><a href="#Grib2Message-724"><span class="linenos"> 724</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span><span id="Grib2Message-725"><a href="#Grib2Message-725"><span class="linenos"> 725</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-726"><a href="#Grib2Message-726"><span class="linenos"> 726</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span>
</span><span id="Grib2Message-727"><a href="#Grib2Message-727"><span class="linenos"> 727</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;major_axis&#39;</span><span class="p">]</span>
</span><span id="Grib2Message-728"><a href="#Grib2Message-728"><span class="linenos"> 728</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;minor_axis&#39;</span><span class="p">]</span>
</span><span id="Grib2Message-729"><a href="#Grib2Message-729"><span class="linenos"> 729</span></a>
</span><span id="Grib2Message-730"><a href="#Grib2Message-730"><span class="linenos"> 730</span></a>        <span class="n">reggrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1"># self.gridDefinitionSection[2]=0 means regular 2-d grid</span>
</span><span id="Grib2Message-731"><a href="#Grib2Message-731"><span class="linenos"> 731</span></a>        <span class="k">if</span> <span class="n">reggrid</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1200</span><span class="p">]:</span>
</span><span id="Grib2Message-732"><a href="#Grib2Message-732"><span class="linenos"> 732</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
</span><span id="Grib2Message-733"><a href="#Grib2Message-733"><span class="linenos"> 733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message-734"><a href="#Grib2Message-734"><span class="linenos"> 734</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">reggrid</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span>
</span><span id="Grib2Message-735"><a href="#Grib2Message-735"><span class="linenos"> 735</span></a>            <span class="c1"># Reduced Gaussian Grid</span>
</span><span id="Grib2Message-736"><a href="#Grib2Message-736"><span class="linenos"> 736</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message-737"><a href="#Grib2Message-737"><span class="linenos"> 737</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">32768</span><span class="p">,</span><span class="mi">32769</span><span class="p">]:</span>
</span><span id="Grib2Message-738"><a href="#Grib2Message-738"><span class="linenos"> 738</span></a>            <span class="c1"># Regular or Rotated Lat/Lon Grid</span>
</span><span id="Grib2Message-739"><a href="#Grib2Message-739"><span class="linenos"> 739</span></a>            <span class="n">scalefact</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
</span><span id="Grib2Message-740"><a href="#Grib2Message-740"><span class="linenos"> 740</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4294967295</span><span class="p">:</span>
</span><span id="Grib2Message-741"><a href="#Grib2Message-741"><span class="linenos"> 741</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Grib2Message-742"><a href="#Grib2Message-742"><span class="linenos"> 742</span></a>            <span class="n">divisor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
</span><span id="Grib2Message-743"><a href="#Grib2Message-743"><span class="linenos"> 743</span></a>            <span class="k">if</span> <span class="n">scalefact</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">scalefact</span> <span class="o">=</span> <span class="mf">1.</span>
</span><span id="Grib2Message-744"><a href="#Grib2Message-744"><span class="linenos"> 744</span></a>            <span class="k">if</span> <span class="n">divisor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">divisor</span> <span class="o">=</span> <span class="mf">1.e6</span>
</span><span id="Grib2Message-745"><a href="#Grib2Message-745"><span class="linenos"> 745</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-746"><a href="#Grib2Message-746"><span class="linenos"> 746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-747"><a href="#Grib2Message-747"><span class="linenos"> 747</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-748"><a href="#Grib2Message-748"><span class="linenos"> 748</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-749"><a href="#Grib2Message-749"><span class="linenos"> 749</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-750"><a href="#Grib2Message-750"><span class="linenos"> 750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-751"><a href="#Grib2Message-751"><span class="linenos"> 751</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span><span class="p">:</span>
</span><span id="Grib2Message-752"><a href="#Grib2Message-752"><span class="linenos"> 752</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message-753"><a href="#Grib2Message-753"><span class="linenos"> 753</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">:</span>
</span><span id="Grib2Message-754"><a href="#Grib2Message-754"><span class="linenos"> 754</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message-755"><a href="#Grib2Message-755"><span class="linenos"> 755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-756"><a href="#Grib2Message-756"><span class="linenos"> 756</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Grib2Message-757"><a href="#Grib2Message-757"><span class="linenos"> 757</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">latitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-758"><a href="#Grib2Message-758"><span class="linenos"> 758</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">longitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-759"><a href="#Grib2Message-759"><span class="linenos"> 759</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">anglePoleRotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-760"><a href="#Grib2Message-760"><span class="linenos"> 760</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="Grib2Message-761"><a href="#Grib2Message-761"><span class="linenos"> 761</span></a>            <span class="c1"># Mercator</span>
</span><span id="Grib2Message-762"><a href="#Grib2Message-762"><span class="linenos"> 762</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-763"><a href="#Grib2Message-763"><span class="linenos"> 763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-764"><a href="#Grib2Message-764"><span class="linenos"> 764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-765"><a href="#Grib2Message-765"><span class="linenos"> 765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-766"><a href="#Grib2Message-766"><span class="linenos"> 766</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e3</span>
</span><span id="Grib2Message-767"><a href="#Grib2Message-767"><span class="linenos"> 767</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e3</span>
</span><span id="Grib2Message-768"><a href="#Grib2Message-768"><span class="linenos"> 768</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-769"><a href="#Grib2Message-769"><span class="linenos"> 769</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">)</span>
</span><span id="Grib2Message-770"><a href="#Grib2Message-770"><span class="linenos"> 770</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;merc&#39;</span>
</span><span id="Grib2Message-771"><a href="#Grib2Message-771"><span class="linenos"> 771</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-772"><a href="#Grib2Message-772"><span class="linenos"> 772</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
</span><span id="Grib2Message-773"><a href="#Grib2Message-773"><span class="linenos"> 773</span></a>            <span class="c1"># Stereographic</span>
</span><span id="Grib2Message-774"><a href="#Grib2Message-774"><span class="linenos"> 774</span></a>            <span class="n">projflag</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message-775"><a href="#Grib2Message-775"><span class="linenos"> 775</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-776"><a href="#Grib2Message-776"><span class="linenos"> 776</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-777"><a href="#Grib2Message-777"><span class="linenos"> 777</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-778"><a href="#Grib2Message-778"><span class="linenos"> 778</span></a>            <span class="k">if</span> <span class="n">projflag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-779"><a href="#Grib2Message-779"><span class="linenos"> 779</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="mi">90</span>
</span><span id="Grib2Message-780"><a href="#Grib2Message-780"><span class="linenos"> 780</span></a>            <span class="k">elif</span> <span class="n">projflag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Grib2Message-781"><a href="#Grib2Message-781"><span class="linenos"> 781</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
</span><span id="Grib2Message-782"><a href="#Grib2Message-782"><span class="linenos"> 782</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-783"><a href="#Grib2Message-783"><span class="linenos"> 783</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid projection center flag = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">projflag</span><span class="p">)</span>
</span><span id="Grib2Message-784"><a href="#Grib2Message-784"><span class="linenos"> 784</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-785"><a href="#Grib2Message-785"><span class="linenos"> 785</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-786"><a href="#Grib2Message-786"><span class="linenos"> 786</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-787"><a href="#Grib2Message-787"><span class="linenos"> 787</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;stere&#39;</span>
</span><span id="Grib2Message-788"><a href="#Grib2Message-788"><span class="linenos"> 788</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-789"><a href="#Grib2Message-789"><span class="linenos"> 789</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
</span><span id="Grib2Message-790"><a href="#Grib2Message-790"><span class="linenos"> 790</span></a>            <span class="c1"># Lambert Conformal</span>
</span><span id="Grib2Message-791"><a href="#Grib2Message-791"><span class="linenos"> 791</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-792"><a href="#Grib2Message-792"><span class="linenos"> 792</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-793"><a href="#Grib2Message-793"><span class="linenos"> 793</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-794"><a href="#Grib2Message-794"><span class="linenos"> 794</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-795"><a href="#Grib2Message-795"><span class="linenos"> 795</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-796"><a href="#Grib2Message-796"><span class="linenos"> 796</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-797"><a href="#Grib2Message-797"><span class="linenos"> 797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-798"><a href="#Grib2Message-798"><span class="linenos"> 798</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-799"><a href="#Grib2Message-799"><span class="linenos"> 799</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;lcc&#39;</span>
</span><span id="Grib2Message-800"><a href="#Grib2Message-800"><span class="linenos"> 800</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-801"><a href="#Grib2Message-801"><span class="linenos"> 801</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span><span id="Grib2Message-802"><a href="#Grib2Message-802"><span class="linenos"> 802</span></a>            <span class="c1"># Albers Equal Area</span>
</span><span id="Grib2Message-803"><a href="#Grib2Message-803"><span class="linenos"> 803</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-804"><a href="#Grib2Message-804"><span class="linenos"> 804</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-805"><a href="#Grib2Message-805"><span class="linenos"> 805</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-806"><a href="#Grib2Message-806"><span class="linenos"> 806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-807"><a href="#Grib2Message-807"><span class="linenos"> 807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-808"><a href="#Grib2Message-808"><span class="linenos"> 808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-809"><a href="#Grib2Message-809"><span class="linenos"> 809</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-810"><a href="#Grib2Message-810"><span class="linenos"> 810</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-811"><a href="#Grib2Message-811"><span class="linenos"> 811</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;aea&#39;</span>
</span><span id="Grib2Message-812"><a href="#Grib2Message-812"><span class="linenos"> 812</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-813"><a href="#Grib2Message-813"><span class="linenos"> 813</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">40</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">41</span><span class="p">:</span>
</span><span id="Grib2Message-814"><a href="#Grib2Message-814"><span class="linenos"> 814</span></a>            <span class="c1"># Gaussian Grid</span>
</span><span id="Grib2Message-815"><a href="#Grib2Message-815"><span class="linenos"> 815</span></a>            <span class="n">scalefact</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
</span><span id="Grib2Message-816"><a href="#Grib2Message-816"><span class="linenos"> 816</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4294967295</span><span class="p">:</span>
</span><span id="Grib2Message-817"><a href="#Grib2Message-817"><span class="linenos"> 817</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Grib2Message-818"><a href="#Grib2Message-818"><span class="linenos"> 818</span></a>            <span class="n">divisor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
</span><span id="Grib2Message-819"><a href="#Grib2Message-819"><span class="linenos"> 819</span></a>            <span class="k">if</span> <span class="n">scalefact</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">scalefact</span> <span class="o">=</span> <span class="mf">1.</span>
</span><span id="Grib2Message-820"><a href="#Grib2Message-820"><span class="linenos"> 820</span></a>            <span class="k">if</span> <span class="n">divisor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">divisor</span> <span class="o">=</span> <span class="mf">1.e6</span>
</span><span id="Grib2Message-821"><a href="#Grib2Message-821"><span class="linenos"> 821</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pointsBetweenPoleAndEquator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-822"><a href="#Grib2Message-822"><span class="linenos"> 822</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-823"><a href="#Grib2Message-823"><span class="linenos"> 823</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-824"><a href="#Grib2Message-824"><span class="linenos"> 824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-825"><a href="#Grib2Message-825"><span class="linenos"> 825</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-826"><a href="#Grib2Message-826"><span class="linenos"> 826</span></a>            <span class="k">if</span> <span class="n">reggrid</span><span class="p">:</span>
</span><span id="Grib2Message-827"><a href="#Grib2Message-827"><span class="linenos"> 827</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-828"><a href="#Grib2Message-828"><span class="linenos"> 828</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">:</span>
</span><span id="Grib2Message-829"><a href="#Grib2Message-829"><span class="linenos"> 829</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message-830"><a href="#Grib2Message-830"><span class="linenos"> 830</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-831"><a href="#Grib2Message-831"><span class="linenos"> 831</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">41</span><span class="p">:</span>
</span><span id="Grib2Message-832"><a href="#Grib2Message-832"><span class="linenos"> 832</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">latitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-833"><a href="#Grib2Message-833"><span class="linenos"> 833</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">longitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message-834"><a href="#Grib2Message-834"><span class="linenos"> 834</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">anglePoleRotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-835"><a href="#Grib2Message-835"><span class="linenos"> 835</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="Grib2Message-836"><a href="#Grib2Message-836"><span class="linenos"> 836</span></a>            <span class="c1"># Spectral Coefficients</span>
</span><span id="Grib2Message-837"><a href="#Grib2Message-837"><span class="linenos"> 837</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spectralFunctionParameters</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Grib2Message-838"><a href="#Grib2Message-838"><span class="linenos"> 838</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
</span><span id="Grib2Message-839"><a href="#Grib2Message-839"><span class="linenos"> 839</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="Grib2Message-840"><a href="#Grib2Message-840"><span class="linenos"> 840</span></a>            <span class="c1"># Near-sided Vertical Perspective Satellite Projection</span>
</span><span id="Grib2Message-841"><a href="#Grib2Message-841"><span class="linenos"> 841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-842"><a href="#Grib2Message-842"><span class="linenos"> 842</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-843"><a href="#Grib2Message-843"><span class="linenos"> 843</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span><span class="p">)</span>
</span><span id="Grib2Message-844"><a href="#Grib2Message-844"><span class="linenos"> 844</span></a>            <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
</span><span id="Grib2Message-845"><a href="#Grib2Message-845"><span class="linenos"> 845</span></a>            <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message-846"><a href="#Grib2Message-846"><span class="linenos"> 846</span></a>            <span class="c1"># if lat_0 is equator, it&#39;s a geostationary view.</span>
</span><span id="Grib2Message-847"><a href="#Grib2Message-847"><span class="linenos"> 847</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span> <span class="c1"># if lat_0 is equator, it&#39;s a</span>
</span><span id="Grib2Message-848"><a href="#Grib2Message-848"><span class="linenos"> 848</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;geos&#39;</span>
</span><span id="Grib2Message-849"><a href="#Grib2Message-849"><span class="linenos"> 849</span></a>            <span class="c1"># general case of &#39;near-side perspective projection&#39; (untested)</span>
</span><span id="Grib2Message-850"><a href="#Grib2Message-850"><span class="linenos"> 850</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-851"><a href="#Grib2Message-851"><span class="linenos"> 851</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;nsper&#39;</span>
</span><span id="Grib2Message-852"><a href="#Grib2Message-852"><span class="linenos"> 852</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Only geostationary perspective is supported. Lat/Lon values returned by grid method may be incorrect.&#39;</span>
</span><span id="Grib2Message-853"><a href="#Grib2Message-853"><span class="linenos"> 853</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Grib2Message-854"><a href="#Grib2Message-854"><span class="linenos"> 854</span></a>            <span class="c1"># latitude of horizon on central meridian</span>
</span><span id="Grib2Message-855"><a href="#Grib2Message-855"><span class="linenos"> 855</span></a>            <span class="n">lonmax</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span><span class="p">)</span>
</span><span id="Grib2Message-856"><a href="#Grib2Message-856"><span class="linenos"> 856</span></a>            <span class="c1"># longitude of horizon on equator</span>
</span><span id="Grib2Message-857"><a href="#Grib2Message-857"><span class="linenos"> 857</span></a>            <span class="n">latmax</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span><span class="p">)</span>
</span><span id="Grib2Message-858"><a href="#Grib2Message-858"><span class="linenos"> 858</span></a>            <span class="c1"># truncate to nearest thousandth of a degree (to make sure</span>
</span><span id="Grib2Message-859"><a href="#Grib2Message-859"><span class="linenos"> 859</span></a>            <span class="c1"># they aren&#39;t slightly over the horizon)</span>
</span><span id="Grib2Message-860"><a href="#Grib2Message-860"><span class="linenos"> 860</span></a>            <span class="n">latmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">latmax</span><span class="p">)</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-861"><a href="#Grib2Message-861"><span class="linenos"> 861</span></a>            <span class="n">lonmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">lonmax</span><span class="p">)</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-862"><a href="#Grib2Message-862"><span class="linenos"> 862</span></a>            <span class="c1"># h is measured from surface of earth at equator.</span>
</span><span id="Grib2Message-863"><a href="#Grib2Message-863"><span class="linenos"> 863</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span>
</span><span id="Grib2Message-864"><a href="#Grib2Message-864"><span class="linenos"> 864</span></a>            <span class="c1"># width and height of visible projection</span>
</span><span id="Grib2Message-865"><a href="#Grib2Message-865"><span class="linenos"> 865</span></a>            <span class="n">P</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span><span class="p">,</span>\
</span><span id="Grib2Message-866"><a href="#Grib2Message-866"><span class="linenos"> 866</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span><span class="p">,</span>\
</span><span id="Grib2Message-867"><a href="#Grib2Message-867"><span class="linenos"> 867</span></a>                            <span class="n">lat_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span><span class="p">)</span>
</span><span id="Grib2Message-868"><a href="#Grib2Message-868"><span class="linenos"> 868</span></a>            <span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">latmax</span><span class="p">)</span>
</span><span id="Grib2Message-869"><a href="#Grib2Message-869"><span class="linenos"> 869</span></a>            <span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">lonmax</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
</span><span id="Grib2Message-870"><a href="#Grib2Message-870"><span class="linenos"> 870</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span>
</span><span id="Grib2Message-871"><a href="#Grib2Message-871"><span class="linenos"> 871</span></a>            <span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y1</span>
</span><span id="Grib2Message-872"><a href="#Grib2Message-872"><span class="linenos"> 872</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="n">width</span><span class="o">/</span><span class="n">dx</span>
</span><span id="Grib2Message-873"><a href="#Grib2Message-873"><span class="linenos"> 873</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="n">dy</span>
</span><span id="Grib2Message-874"><a href="#Grib2Message-874"><span class="linenos"> 874</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-875"><a href="#Grib2Message-875"><span class="linenos"> 875</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">110</span><span class="p">:</span>
</span><span id="Grib2Message-876"><a href="#Grib2Message-876"><span class="linenos"> 876</span></a>            <span class="c1"># Azimuthal Equidistant</span>
</span><span id="Grib2Message-877"><a href="#Grib2Message-877"><span class="linenos"> 877</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-878"><a href="#Grib2Message-878"><span class="linenos"> 878</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message-879"><a href="#Grib2Message-879"><span class="linenos"> 879</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-880"><a href="#Grib2Message-880"><span class="linenos"> 880</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message-881"><a href="#Grib2Message-881"><span class="linenos"> 881</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;aeqd&#39;</span>
</span><span id="Grib2Message-882"><a href="#Grib2Message-882"><span class="linenos"> 882</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-883"><a href="#Grib2Message-883"><span class="linenos"> 883</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
</span><span id="Grib2Message-884"><a href="#Grib2Message-884"><span class="linenos"> 884</span></a>            <span class="c1"># Curvilinear Orthogonal</span>
</span><span id="Grib2Message-885"><a href="#Grib2Message-885"><span class="linenos"> 885</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-886"><a href="#Grib2Message-886"><span class="linenos"> 886</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-887"><a href="#Grib2Message-887"><span class="linenos"> 887</span></a>            <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unsupported Grid Definition Template Number - 3.</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message-888"><a href="#Grib2Message-888"><span class="linenos"> 888</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span><span id="Grib2Message-889"><a href="#Grib2Message-889"><span class="linenos"> 889</span></a>
</span><span id="Grib2Message-890"><a href="#Grib2Message-890"><span class="linenos"> 890</span></a>        <span class="c1"># -------------------------------</span>
</span><span id="Grib2Message-891"><a href="#Grib2Message-891"><span class="linenos"> 891</span></a>        <span class="c1"># Section 4 -- Product Definition</span>
</span><span id="Grib2Message-892"><a href="#Grib2Message-892"><span class="linenos"> 892</span></a>        <span class="c1"># -------------------------------</span>
</span><span id="Grib2Message-893"><a href="#Grib2Message-893"><span class="linenos"> 893</span></a>      
</span><span id="Grib2Message-894"><a href="#Grib2Message-894"><span class="linenos"> 894</span></a>        <span class="c1"># Template 4.0 - NOTE: That is these attributes apply to other templates.</span>
</span><span id="Grib2Message-895"><a href="#Grib2Message-895"><span class="linenos"> 895</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameterCategory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message-896"><a href="#Grib2Message-896"><span class="linenos"> 896</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameterNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-897"><a href="#Grib2Message-897"><span class="linenos"> 897</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fullName</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">shortName</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_varinfo_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discipline</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="Grib2Message-898"><a href="#Grib2Message-898"><span class="linenos"> 898</span></a>                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">parameterCategory</span><span class="p">,</span>
</span><span id="Grib2Message-899"><a href="#Grib2Message-899"><span class="linenos"> 899</span></a>                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">parameterNumber</span><span class="p">)</span>
</span><span id="Grib2Message-900"><a href="#Grib2Message-900"><span class="linenos"> 900</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">typeOfGeneratingProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.3&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-901"><a href="#Grib2Message-901"><span class="linenos"> 901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backgroundGeneratingProcessIdentifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message-902"><a href="#Grib2Message-902"><span class="linenos"> 902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generatingProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;generating_process&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-903"><a href="#Grib2Message-903"><span class="linenos"> 903</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRange</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-904"><a href="#Grib2Message-904"><span class="linenos"> 904</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">leadTime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message-905"><a href="#Grib2Message-905"><span class="linenos"> 905</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">typeOfFirstFixedSurface</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-906"><a href="#Grib2Message-906"><span class="linenos"> 906</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message-907"><a href="#Grib2Message-907"><span class="linenos"> 907</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unitOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeOfFirstFixedSurface</span><span class="o">.</span><span class="n">definition</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-908"><a href="#Grib2Message-908"><span class="linenos"> 908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
</span><span id="Grib2Message-909"><a href="#Grib2Message-909"><span class="linenos"> 909</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">valueOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfFirstFixedSurface</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfFirstFixedSurface</span><span class="p">)</span>
</span><span id="Grib2Message-910"><a href="#Grib2Message-910"><span class="linenos"> 910</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_value_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="s1">&#39;4.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-911"><a href="#Grib2Message-911"><span class="linenos"> 911</span></a>        <span class="k">if</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Missing&#39;</span> <span class="ow">and</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">:</span>
</span><span id="Grib2Message-912"><a href="#Grib2Message-912"><span class="linenos"> 912</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-913"><a href="#Grib2Message-913"><span class="linenos"> 913</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-914"><a href="#Grib2Message-914"><span class="linenos"> 914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-915"><a href="#Grib2Message-915"><span class="linenos"> 915</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">valueOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-916"><a href="#Grib2Message-916"><span class="linenos"> 916</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-917"><a href="#Grib2Message-917"><span class="linenos"> 917</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSecondFixedSurface</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-918"><a href="#Grib2Message-918"><span class="linenos"> 918</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message-919"><a href="#Grib2Message-919"><span class="linenos"> 919</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSecondFixedSurface</span><span class="o">.</span><span class="n">definition</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-920"><a href="#Grib2Message-920"><span class="linenos"> 920</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
</span><span id="Grib2Message-921"><a href="#Grib2Message-921"><span class="linenos"> 921</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">valueOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfSecondFixedSurface</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfSecondFixedSurface</span><span class="p">)</span>
</span><span id="Grib2Message-922"><a href="#Grib2Message-922"><span class="linenos"> 922</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_wgrib2_level_string</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">15</span><span class="p">])</span>
</span><span id="Grib2Message-923"><a href="#Grib2Message-923"><span class="linenos"> 923</span></a>
</span><span id="Grib2Message-924"><a href="#Grib2Message-924"><span class="linenos"> 924</span></a>        <span class="c1"># Template 4.1 -</span>
</span><span id="Grib2Message-925"><a href="#Grib2Message-925"><span class="linenos"> 925</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Grib2Message-926"><a href="#Grib2Message-926"><span class="linenos"> 926</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfEnsembleForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.6&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-927"><a href="#Grib2Message-927"><span class="linenos"> 927</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">perturbationNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-928"><a href="#Grib2Message-928"><span class="linenos"> 928</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-929"><a href="#Grib2Message-929"><span class="linenos"> 929</span></a>
</span><span id="Grib2Message-930"><a href="#Grib2Message-930"><span class="linenos"> 930</span></a>        <span class="c1"># Template 4.2 -</span>
</span><span id="Grib2Message-931"><a href="#Grib2Message-931"><span class="linenos"> 931</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Grib2Message-932"><a href="#Grib2Message-932"><span class="linenos"> 932</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfDerivedForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.7&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-933"><a href="#Grib2Message-933"><span class="linenos"> 933</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-934"><a href="#Grib2Message-934"><span class="linenos"> 934</span></a>
</span><span id="Grib2Message-935"><a href="#Grib2Message-935"><span class="linenos"> 935</span></a>        <span class="c1"># Template 4.5 -</span>
</span><span id="Grib2Message-936"><a href="#Grib2Message-936"><span class="linenos"> 936</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Grib2Message-937"><a href="#Grib2Message-937"><span class="linenos"> 937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">forecastProbabilityNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message-938"><a href="#Grib2Message-938"><span class="linenos"> 938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">totalNumberOfForecastProbabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-939"><a href="#Grib2Message-939"><span class="linenos"> 939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfProbability</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.9&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-940"><a href="#Grib2Message-940"><span class="linenos"> 940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message-941"><a href="#Grib2Message-941"><span class="linenos"> 941</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message-942"><a href="#Grib2Message-942"><span class="linenos"> 942</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message-943"><a href="#Grib2Message-943"><span class="linenos"> 943</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-944"><a href="#Grib2Message-944"><span class="linenos"> 944</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdLowerLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message-945"><a href="#Grib2Message-945"><span class="linenos"> 945</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
</span><span id="Grib2Message-946"><a href="#Grib2Message-946"><span class="linenos"> 946</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdUpperLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message-947"><a href="#Grib2Message-947"><span class="linenos"> 947</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
</span><span id="Grib2Message-948"><a href="#Grib2Message-948"><span class="linenos"> 948</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_wgrib2_prob_string</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
</span><span id="Grib2Message-949"><a href="#Grib2Message-949"><span class="linenos"> 949</span></a>
</span><span id="Grib2Message-950"><a href="#Grib2Message-950"><span class="linenos"> 950</span></a>        <span class="c1"># Template 4.6 -</span>
</span><span id="Grib2Message-951"><a href="#Grib2Message-951"><span class="linenos"> 951</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="Grib2Message-952"><a href="#Grib2Message-952"><span class="linenos"> 952</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">percentileValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message-953"><a href="#Grib2Message-953"><span class="linenos"> 953</span></a>
</span><span id="Grib2Message-954"><a href="#Grib2Message-954"><span class="linenos"> 954</span></a>        <span class="c1"># Template 4.8 -</span>
</span><span id="Grib2Message-955"><a href="#Grib2Message-955"><span class="linenos"> 955</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="Grib2Message-956"><a href="#Grib2Message-956"><span class="linenos"> 956</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message-957"><a href="#Grib2Message-957"><span class="linenos"> 957</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-958"><a href="#Grib2Message-958"><span class="linenos"> 958</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-959"><a href="#Grib2Message-959"><span class="linenos"> 959</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message-960"><a href="#Grib2Message-960"><span class="linenos"> 960</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message-961"><a href="#Grib2Message-961"><span class="linenos"> 961</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message-962"><a href="#Grib2Message-962"><span class="linenos"> 962</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-963"><a href="#Grib2Message-963"><span class="linenos"> 963</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message-964"><a href="#Grib2Message-964"><span class="linenos"> 964</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-965"><a href="#Grib2Message-965"><span class="linenos"> 965</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-966"><a href="#Grib2Message-966"><span class="linenos"> 966</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-967"><a href="#Grib2Message-967"><span class="linenos"> 967</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
</span><span id="Grib2Message-968"><a href="#Grib2Message-968"><span class="linenos"> 968</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-969"><a href="#Grib2Message-969"><span class="linenos"> 969</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
</span><span id="Grib2Message-970"><a href="#Grib2Message-970"><span class="linenos"> 970</span></a>
</span><span id="Grib2Message-971"><a href="#Grib2Message-971"><span class="linenos"> 971</span></a>        <span class="c1"># Template 4.9 -</span>
</span><span id="Grib2Message-972"><a href="#Grib2Message-972"><span class="linenos"> 972</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
</span><span id="Grib2Message-973"><a href="#Grib2Message-973"><span class="linenos"> 973</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">forecastProbabilityNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message-974"><a href="#Grib2Message-974"><span class="linenos"> 974</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">totalNumberOfForecastProbabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-975"><a href="#Grib2Message-975"><span class="linenos"> 975</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfProbability</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.9&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-976"><a href="#Grib2Message-976"><span class="linenos"> 976</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message-977"><a href="#Grib2Message-977"><span class="linenos"> 977</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message-978"><a href="#Grib2Message-978"><span class="linenos"> 978</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message-979"><a href="#Grib2Message-979"><span class="linenos"> 979</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-980"><a href="#Grib2Message-980"><span class="linenos"> 980</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdLowerLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message-981"><a href="#Grib2Message-981"><span class="linenos"> 981</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
</span><span id="Grib2Message-982"><a href="#Grib2Message-982"><span class="linenos"> 982</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdUpperLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message-983"><a href="#Grib2Message-983"><span class="linenos"> 983</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
</span><span id="Grib2Message-984"><a href="#Grib2Message-984"><span class="linenos"> 984</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_wgrib2_prob_string</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
</span><span id="Grib2Message-985"><a href="#Grib2Message-985"><span class="linenos"> 985</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message-986"><a href="#Grib2Message-986"><span class="linenos"> 986</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message-987"><a href="#Grib2Message-987"><span class="linenos"> 987</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
</span><span id="Grib2Message-988"><a href="#Grib2Message-988"><span class="linenos"> 988</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
</span><span id="Grib2Message-989"><a href="#Grib2Message-989"><span class="linenos"> 989</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
</span><span id="Grib2Message-990"><a href="#Grib2Message-990"><span class="linenos"> 990</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span>
</span><span id="Grib2Message-991"><a href="#Grib2Message-991"><span class="linenos"> 991</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
</span><span id="Grib2Message-992"><a href="#Grib2Message-992"><span class="linenos"> 992</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span>
</span><span id="Grib2Message-993"><a href="#Grib2Message-993"><span class="linenos"> 993</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-994"><a href="#Grib2Message-994"><span class="linenos"> 994</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">31</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-995"><a href="#Grib2Message-995"><span class="linenos"> 995</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-996"><a href="#Grib2Message-996"><span class="linenos"> 996</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span>
</span><span id="Grib2Message-997"><a href="#Grib2Message-997"><span class="linenos"> 997</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">34</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-998"><a href="#Grib2Message-998"><span class="linenos"> 998</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span>
</span><span id="Grib2Message-999"><a href="#Grib2Message-999"><span class="linenos"> 999</span></a>
</span><span id="Grib2Message-1000"><a href="#Grib2Message-1000"><span class="linenos">1000</span></a>        <span class="c1"># Template 4.10 -</span>
</span><span id="Grib2Message-1001"><a href="#Grib2Message-1001"><span class="linenos">1001</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="Grib2Message-1002"><a href="#Grib2Message-1002"><span class="linenos">1002</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">percentileValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message-1003"><a href="#Grib2Message-1003"><span class="linenos">1003</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-1004"><a href="#Grib2Message-1004"><span class="linenos">1004</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-1005"><a href="#Grib2Message-1005"><span class="linenos">1005</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message-1006"><a href="#Grib2Message-1006"><span class="linenos">1006</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message-1007"><a href="#Grib2Message-1007"><span class="linenos">1007</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message-1008"><a href="#Grib2Message-1008"><span class="linenos">1008</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-1009"><a href="#Grib2Message-1009"><span class="linenos">1009</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message-1010"><a href="#Grib2Message-1010"><span class="linenos">1010</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message-1011"><a href="#Grib2Message-1011"><span class="linenos">1011</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1012"><a href="#Grib2Message-1012"><span class="linenos">1012</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1013"><a href="#Grib2Message-1013"><span class="linenos">1013</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1014"><a href="#Grib2Message-1014"><span class="linenos">1014</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span>
</span><span id="Grib2Message-1015"><a href="#Grib2Message-1015"><span class="linenos">1015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1016"><a href="#Grib2Message-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span>
</span><span id="Grib2Message-1017"><a href="#Grib2Message-1017"><span class="linenos">1017</span></a>
</span><span id="Grib2Message-1018"><a href="#Grib2Message-1018"><span class="linenos">1018</span></a>        <span class="c1"># Template 4.11 -</span>
</span><span id="Grib2Message-1019"><a href="#Grib2Message-1019"><span class="linenos">1019</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
</span><span id="Grib2Message-1020"><a href="#Grib2Message-1020"><span class="linenos">1020</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfEnsembleForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.6&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1021"><a href="#Grib2Message-1021"><span class="linenos">1021</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">perturbationNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-1022"><a href="#Grib2Message-1022"><span class="linenos">1022</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-1023"><a href="#Grib2Message-1023"><span class="linenos">1023</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message-1024"><a href="#Grib2Message-1024"><span class="linenos">1024</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message-1025"><a href="#Grib2Message-1025"><span class="linenos">1025</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message-1026"><a href="#Grib2Message-1026"><span class="linenos">1026</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-1027"><a href="#Grib2Message-1027"><span class="linenos">1027</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message-1028"><a href="#Grib2Message-1028"><span class="linenos">1028</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message-1029"><a href="#Grib2Message-1029"><span class="linenos">1029</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
</span><span id="Grib2Message-1030"><a href="#Grib2Message-1030"><span class="linenos">1030</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
</span><span id="Grib2Message-1031"><a href="#Grib2Message-1031"><span class="linenos">1031</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1032"><a href="#Grib2Message-1032"><span class="linenos">1032</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1033"><a href="#Grib2Message-1033"><span class="linenos">1033</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1034"><a href="#Grib2Message-1034"><span class="linenos">1034</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span>
</span><span id="Grib2Message-1035"><a href="#Grib2Message-1035"><span class="linenos">1035</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_value_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1036"><a href="#Grib2Message-1036"><span class="linenos">1036</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span>
</span><span id="Grib2Message-1037"><a href="#Grib2Message-1037"><span class="linenos">1037</span></a>
</span><span id="Grib2Message-1038"><a href="#Grib2Message-1038"><span class="linenos">1038</span></a>        <span class="c1"># Template 4.12 -</span>
</span><span id="Grib2Message-1039"><a href="#Grib2Message-1039"><span class="linenos">1039</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
</span><span id="Grib2Message-1040"><a href="#Grib2Message-1040"><span class="linenos">1040</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfDerivedForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.7&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1041"><a href="#Grib2Message-1041"><span class="linenos">1041</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message-1042"><a href="#Grib2Message-1042"><span class="linenos">1042</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-1043"><a href="#Grib2Message-1043"><span class="linenos">1043</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message-1044"><a href="#Grib2Message-1044"><span class="linenos">1044</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message-1045"><a href="#Grib2Message-1045"><span class="linenos">1045</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message-1046"><a href="#Grib2Message-1046"><span class="linenos">1046</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message-1047"><a href="#Grib2Message-1047"><span class="linenos">1047</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message-1048"><a href="#Grib2Message-1048"><span class="linenos">1048</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message-1049"><a href="#Grib2Message-1049"><span class="linenos">1049</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
</span><span id="Grib2Message-1050"><a href="#Grib2Message-1050"><span class="linenos">1050</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1051"><a href="#Grib2Message-1051"><span class="linenos">1051</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1052"><a href="#Grib2Message-1052"><span class="linenos">1052</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1053"><a href="#Grib2Message-1053"><span class="linenos">1053</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
</span><span id="Grib2Message-1054"><a href="#Grib2Message-1054"><span class="linenos">1054</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1055"><a href="#Grib2Message-1055"><span class="linenos">1055</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span>
</span><span id="Grib2Message-1056"><a href="#Grib2Message-1056"><span class="linenos">1056</span></a>
</span><span id="Grib2Message-1057"><a href="#Grib2Message-1057"><span class="linenos">1057</span></a>        <span class="c1"># Template 4.15 -</span>
</span><span id="Grib2Message-1058"><a href="#Grib2Message-1058"><span class="linenos">1058</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="Grib2Message-1059"><a href="#Grib2Message-1059"><span class="linenos">1059</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1060"><a href="#Grib2Message-1060"><span class="linenos">1060</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSpatialProcessing</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.15&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1061"><a href="#Grib2Message-1061"><span class="linenos">1061</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfDataPointsForSpatialProcessing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-1062"><a href="#Grib2Message-1062"><span class="linenos">1062</span></a>
</span><span id="Grib2Message-1063"><a href="#Grib2Message-1063"><span class="linenos">1063</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1064"><a href="#Grib2Message-1064"><span class="linenos">1064</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-1065"><a href="#Grib2Message-1065"><span class="linenos">1065</span></a>                <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unsupported Product Definition Template Number - 4.</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message-1066"><a href="#Grib2Message-1066"><span class="linenos">1066</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span><span id="Grib2Message-1067"><a href="#Grib2Message-1067"><span class="linenos">1067</span></a>
</span><span id="Grib2Message-1068"><a href="#Grib2Message-1068"><span class="linenos">1068</span></a>
</span><span id="Grib2Message-1069"><a href="#Grib2Message-1069"><span class="linenos">1069</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">leadTime</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">getleadtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">,</span>
</span><span id="Grib2Message-1070"><a href="#Grib2Message-1070"><span class="linenos">1070</span></a>                                          <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="Grib2Message-1071"><a href="#Grib2Message-1071"><span class="linenos">1071</span></a>                                          <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">)</span>
</span><span id="Grib2Message-1072"><a href="#Grib2Message-1072"><span class="linenos">1072</span></a>
</span><span id="Grib2Message-1073"><a href="#Grib2Message-1073"><span class="linenos">1073</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]:</span>
</span><span id="Grib2Message-1074"><a href="#Grib2Message-1074"><span class="linenos">1074</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dtEndOfTimePeriod</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span><span class="p">,</span>
</span><span id="Grib2Message-1075"><a href="#Grib2Message-1075"><span class="linenos">1075</span></a>                                     <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span><span class="p">,</span><span class="n">hour</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span><span class="p">,</span>
</span><span id="Grib2Message-1076"><a href="#Grib2Message-1076"><span class="linenos">1076</span></a>                                     <span class="n">minute</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span><span class="p">,</span>
</span><span id="Grib2Message-1077"><a href="#Grib2Message-1077"><span class="linenos">1077</span></a>                                     <span class="n">second</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span><span class="p">)</span>
</span><span id="Grib2Message-1078"><a href="#Grib2Message-1078"><span class="linenos">1078</span></a>
</span><span id="Grib2Message-1079"><a href="#Grib2Message-1079"><span class="linenos">1079</span></a>        <span class="c1"># --------------------------------</span>
</span><span id="Grib2Message-1080"><a href="#Grib2Message-1080"><span class="linenos">1080</span></a>        <span class="c1"># Section 5 -- Data Representation</span>
</span><span id="Grib2Message-1081"><a href="#Grib2Message-1081"><span class="linenos">1081</span></a>        <span class="c1"># --------------------------------</span>
</span><span id="Grib2Message-1082"><a href="#Grib2Message-1082"><span class="linenos">1082</span></a>
</span><span id="Grib2Message-1083"><a href="#Grib2Message-1083"><span class="linenos">1083</span></a>        <span class="c1"># Template 5.0 - Simple Packing</span>
</span><span id="Grib2Message-1084"><a href="#Grib2Message-1084"><span class="linenos">1084</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-1085"><a href="#Grib2Message-1085"><span class="linenos">1085</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-1086"><a href="#Grib2Message-1086"><span class="linenos">1086</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1087"><a href="#Grib2Message-1087"><span class="linenos">1087</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message-1088"><a href="#Grib2Message-1088"><span class="linenos">1088</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message-1089"><a href="#Grib2Message-1089"><span class="linenos">1089</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1090"><a href="#Grib2Message-1090"><span class="linenos">1090</span></a>
</span><span id="Grib2Message-1091"><a href="#Grib2Message-1091"><span class="linenos">1091</span></a>        <span class="c1"># Template 5.2 - Complex Packing</span>
</span><span id="Grib2Message-1092"><a href="#Grib2Message-1092"><span class="linenos">1092</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Grib2Message-1093"><a href="#Grib2Message-1093"><span class="linenos">1093</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-1094"><a href="#Grib2Message-1094"><span class="linenos">1094</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1095"><a href="#Grib2Message-1095"><span class="linenos">1095</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message-1096"><a href="#Grib2Message-1096"><span class="linenos">1096</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message-1097"><a href="#Grib2Message-1097"><span class="linenos">1097</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1098"><a href="#Grib2Message-1098"><span class="linenos">1098</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupSplitMethod</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1099"><a href="#Grib2Message-1099"><span class="linenos">1099</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfMissingValue</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1100"><a href="#Grib2Message-1100"><span class="linenos">1100</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message-1101"><a href="#Grib2Message-1101"><span class="linenos">1101</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message-1102"><a href="#Grib2Message-1102"><span class="linenos">1102</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nGroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
</span><span id="Grib2Message-1103"><a href="#Grib2Message-1103"><span class="linenos">1103</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message-1104"><a href="#Grib2Message-1104"><span class="linenos">1104</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
</span><span id="Grib2Message-1105"><a href="#Grib2Message-1105"><span class="linenos">1105</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
</span><span id="Grib2Message-1106"><a href="#Grib2Message-1106"><span class="linenos">1106</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupLengthIncrement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message-1107"><a href="#Grib2Message-1107"><span class="linenos">1107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lengthOfLastGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
</span><span id="Grib2Message-1108"><a href="#Grib2Message-1108"><span class="linenos">1108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsScaledGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message-1109"><a href="#Grib2Message-1109"><span class="linenos">1109</span></a>
</span><span id="Grib2Message-1110"><a href="#Grib2Message-1110"><span class="linenos">1110</span></a>        <span class="c1"># Template 5.3 - Complex Packing and Spatial Differencing</span>
</span><span id="Grib2Message-1111"><a href="#Grib2Message-1111"><span class="linenos">1111</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Grib2Message-1112"><a href="#Grib2Message-1112"><span class="linenos">1112</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-1113"><a href="#Grib2Message-1113"><span class="linenos">1113</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1114"><a href="#Grib2Message-1114"><span class="linenos">1114</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message-1115"><a href="#Grib2Message-1115"><span class="linenos">1115</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message-1116"><a href="#Grib2Message-1116"><span class="linenos">1116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1117"><a href="#Grib2Message-1117"><span class="linenos">1117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupSplitMethod</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1118"><a href="#Grib2Message-1118"><span class="linenos">1118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfMissingValue</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1119"><a href="#Grib2Message-1119"><span class="linenos">1119</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message-1120"><a href="#Grib2Message-1120"><span class="linenos">1120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message-1121"><a href="#Grib2Message-1121"><span class="linenos">1121</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nGroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
</span><span id="Grib2Message-1122"><a href="#Grib2Message-1122"><span class="linenos">1122</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message-1123"><a href="#Grib2Message-1123"><span class="linenos">1123</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
</span><span id="Grib2Message-1124"><a href="#Grib2Message-1124"><span class="linenos">1124</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
</span><span id="Grib2Message-1125"><a href="#Grib2Message-1125"><span class="linenos">1125</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupLengthIncrement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message-1126"><a href="#Grib2Message-1126"><span class="linenos">1126</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lengthOfLastGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
</span><span id="Grib2Message-1127"><a href="#Grib2Message-1127"><span class="linenos">1127</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsScaledGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message-1128"><a href="#Grib2Message-1128"><span class="linenos">1128</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spatialDifferenceOrder</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.6&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1129"><a href="#Grib2Message-1129"><span class="linenos">1129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBytesSpatialDifference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message-1130"><a href="#Grib2Message-1130"><span class="linenos">1130</span></a>
</span><span id="Grib2Message-1131"><a href="#Grib2Message-1131"><span class="linenos">1131</span></a>        <span class="c1"># Template 5.4 - IEEE Floating Point Data</span>
</span><span id="Grib2Message-1132"><a href="#Grib2Message-1132"><span class="linenos">1132</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="Grib2Message-1133"><a href="#Grib2Message-1133"><span class="linenos">1133</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.7&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1134"><a href="#Grib2Message-1134"><span class="linenos">1134</span></a>
</span><span id="Grib2Message-1135"><a href="#Grib2Message-1135"><span class="linenos">1135</span></a>        <span class="c1"># Template 5.40 - JPEG2000 Compression</span>
</span><span id="Grib2Message-1136"><a href="#Grib2Message-1136"><span class="linenos">1136</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span>
</span><span id="Grib2Message-1137"><a href="#Grib2Message-1137"><span class="linenos">1137</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-1138"><a href="#Grib2Message-1138"><span class="linenos">1138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1139"><a href="#Grib2Message-1139"><span class="linenos">1139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message-1140"><a href="#Grib2Message-1140"><span class="linenos">1140</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message-1141"><a href="#Grib2Message-1141"><span class="linenos">1141</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1142"><a href="#Grib2Message-1142"><span class="linenos">1142</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfCompression</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.40&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1143"><a href="#Grib2Message-1143"><span class="linenos">1143</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">targetCompressionRatio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</span><span id="Grib2Message-1144"><a href="#Grib2Message-1144"><span class="linenos">1144</span></a>
</span><span id="Grib2Message-1145"><a href="#Grib2Message-1145"><span class="linenos">1145</span></a>        <span class="c1"># Template 5.41 - PNG Compression</span>
</span><span id="Grib2Message-1146"><a href="#Grib2Message-1146"><span class="linenos">1146</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">41</span><span class="p">:</span>
</span><span id="Grib2Message-1147"><a href="#Grib2Message-1147"><span class="linenos">1147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message-1148"><a href="#Grib2Message-1148"><span class="linenos">1148</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1149"><a href="#Grib2Message-1149"><span class="linenos">1149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message-1150"><a href="#Grib2Message-1150"><span class="linenos">1150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message-1151"><a href="#Grib2Message-1151"><span class="linenos">1151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1152"><a href="#Grib2Message-1152"><span class="linenos">1152</span></a>
</span><span id="Grib2Message-1153"><a href="#Grib2Message-1153"><span class="linenos">1153</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1154"><a href="#Grib2Message-1154"><span class="linenos">1154</span></a>            <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unsupported Data Representation Definition Template Number - 5.</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message-1155"><a href="#Grib2Message-1155"><span class="linenos">1155</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span><span id="Grib2Message-1156"><a href="#Grib2Message-1156"><span class="linenos">1156</span></a>
</span><span id="Grib2Message-1157"><a href="#Grib2Message-1157"><span class="linenos">1157</span></a>
</span><span id="Grib2Message-1158"><a href="#Grib2Message-1158"><span class="linenos">1158</span></a>    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">DEFAULT_FILL_VALUE</span><span class="p">,</span> <span class="n">masked_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Grib2Message-1159"><a href="#Grib2Message-1159"><span class="linenos">1159</span></a>             <span class="n">map_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Grib2Message-1160"><a href="#Grib2Message-1160"><span class="linenos">1160</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1161"><a href="#Grib2Message-1161"><span class="linenos">1161</span></a><span class="sd">        Returns an unpacked data grid.</span>
</span><span id="Grib2Message-1162"><a href="#Grib2Message-1162"><span class="linenos">1162</span></a>
</span><span id="Grib2Message-1163"><a href="#Grib2Message-1163"><span class="linenos">1163</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message-1164"><a href="#Grib2Message-1164"><span class="linenos">1164</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message-1165"><a href="#Grib2Message-1165"><span class="linenos">1165</span></a>
</span><span id="Grib2Message-1166"><a href="#Grib2Message-1166"><span class="linenos">1166</span></a><span class="sd">        **`fill_value`**: Missing or masked data is filled with this value or default value given by</span>
</span><span id="Grib2Message-1167"><a href="#Grib2Message-1167"><span class="linenos">1167</span></a><span class="sd">        `DEFAULT_FILL_VALUE`</span>
</span><span id="Grib2Message-1168"><a href="#Grib2Message-1168"><span class="linenos">1168</span></a>
</span><span id="Grib2Message-1169"><a href="#Grib2Message-1169"><span class="linenos">1169</span></a><span class="sd">        **`masked_array`**: If `True` [DEFAULT], return masked array if there is bitmap for missing </span>
</span><span id="Grib2Message-1170"><a href="#Grib2Message-1170"><span class="linenos">1170</span></a><span class="sd">        or masked data.</span>
</span><span id="Grib2Message-1171"><a href="#Grib2Message-1171"><span class="linenos">1171</span></a>
</span><span id="Grib2Message-1172"><a href="#Grib2Message-1172"><span class="linenos">1172</span></a><span class="sd">        **`expand`**: If `True` [DEFAULT], Reduced Gaussian grids are expanded to regular Gaussian grids.</span>
</span><span id="Grib2Message-1173"><a href="#Grib2Message-1173"><span class="linenos">1173</span></a>
</span><span id="Grib2Message-1174"><a href="#Grib2Message-1174"><span class="linenos">1174</span></a><span class="sd">        **`order`**: If 0 [DEFAULT], nearest neighbor interpolation is used if grid has missing </span>
</span><span id="Grib2Message-1175"><a href="#Grib2Message-1175"><span class="linenos">1175</span></a><span class="sd">        or bitmapped values. If 1, linear interpolation is used for expanding reduced Gaussian grids.</span>
</span><span id="Grib2Message-1176"><a href="#Grib2Message-1176"><span class="linenos">1176</span></a>
</span><span id="Grib2Message-1177"><a href="#Grib2Message-1177"><span class="linenos">1177</span></a><span class="sd">        **`map_keys`**: If `True`, data values will be mapped to the string-based keys that are stored</span>
</span><span id="Grib2Message-1178"><a href="#Grib2Message-1178"><span class="linenos">1178</span></a><span class="sd">        in the Local Use Section (section 2) of the GRIB2 Message or in a code table as specified in the</span>
</span><span id="Grib2Message-1179"><a href="#Grib2Message-1179"><span class="linenos">1179</span></a><span class="sd">        units (i.e. &quot;See Table 4.xxx&quot;).</span>
</span><span id="Grib2Message-1180"><a href="#Grib2Message-1180"><span class="linenos">1180</span></a>
</span><span id="Grib2Message-1181"><a href="#Grib2Message-1181"><span class="linenos">1181</span></a><span class="sd">        Returns</span>
</span><span id="Grib2Message-1182"><a href="#Grib2Message-1182"><span class="linenos">1182</span></a><span class="sd">        -------</span>
</span><span id="Grib2Message-1183"><a href="#Grib2Message-1183"><span class="linenos">1183</span></a>
</span><span id="Grib2Message-1184"><a href="#Grib2Message-1184"><span class="linenos">1184</span></a><span class="sd">        **`numpy.ndarray`**: A numpy.ndarray with shape (ny,nx). By default the array dtype=np.float32, </span>
</span><span id="Grib2Message-1185"><a href="#Grib2Message-1185"><span class="linenos">1185</span></a><span class="sd">        but could be np.int32 if Grib2Message.typeOfValues is integer.  The array dtype will be </span>
</span><span id="Grib2Message-1186"><a href="#Grib2Message-1186"><span class="linenos">1186</span></a><span class="sd">        string-based if map_keys=True.</span>
</span><span id="Grib2Message-1187"><a href="#Grib2Message-1187"><span class="linenos">1187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-1188"><a href="#Grib2Message-1188"><span class="linenos">1188</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;scanModeFlags&#39;</span><span class="p">):</span>
</span><span id="Grib2Message-1189"><a href="#Grib2Message-1189"><span class="linenos">1189</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unsupported grid definition template number </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="p">)</span>
</span><span id="Grib2Message-1190"><a href="#Grib2Message-1190"><span class="linenos">1190</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1191"><a href="#Grib2Message-1191"><span class="linenos">1191</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
</span><span id="Grib2Message-1192"><a href="#Grib2Message-1192"><span class="linenos">1192</span></a>                <span class="n">storageorder</span><span class="o">=</span><span class="s1">&#39;F&#39;</span>
</span><span id="Grib2Message-1193"><a href="#Grib2Message-1193"><span class="linenos">1193</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1194"><a href="#Grib2Message-1194"><span class="linenos">1194</span></a>                <span class="n">storageorder</span><span class="o">=</span><span class="s1">&#39;C&#39;</span>
</span><span id="Grib2Message-1195"><a href="#Grib2Message-1195"><span class="linenos">1195</span></a>        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-1196"><a href="#Grib2Message-1196"><span class="linenos">1196</span></a>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span>
</span><span id="Grib2Message-1197"><a href="#Grib2Message-1197"><span class="linenos">1197</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-1198"><a href="#Grib2Message-1198"><span class="linenos">1198</span></a>                <span class="n">order</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message-1199"><a href="#Grib2Message-1199"><span class="linenos">1199</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1200"><a href="#Grib2Message-1200"><span class="linenos">1200</span></a>                <span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Grib2Message-1201"><a href="#Grib2Message-1201"><span class="linenos">1201</span></a>        <span class="n">drtnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message-1202"><a href="#Grib2Message-1202"><span class="linenos">1202</span></a>        <span class="n">drtmpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message-1203"><a href="#Grib2Message-1203"><span class="linenos">1203</span></a>        <span class="n">gdtnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message-1204"><a href="#Grib2Message-1204"><span class="linenos">1204</span></a>        <span class="n">gdtmpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message-1205"><a href="#Grib2Message-1205"><span class="linenos">1205</span></a>        <span class="n">ndpts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfDataPoints</span>
</span><span id="Grib2Message-1206"><a href="#Grib2Message-1206"><span class="linenos">1206</span></a>        <span class="n">gds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span>
</span><span id="Grib2Message-1207"><a href="#Grib2Message-1207"><span class="linenos">1207</span></a>        <span class="n">ngrdpts</span> <span class="o">=</span> <span class="n">gds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1208"><a href="#Grib2Message-1208"><span class="linenos">1208</span></a>        <span class="n">ipos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datapos</span>
</span><span id="Grib2Message-1209"><a href="#Grib2Message-1209"><span class="linenos">1209</span></a>        <span class="n">fld1</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack7</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="n">gdtnum</span><span class="p">,</span><span class="n">gdtmpl</span><span class="p">,</span><span class="n">drtnum</span><span class="p">,</span><span class="n">drtmpl</span><span class="p">,</span><span class="n">ndpts</span><span class="p">,</span><span class="n">ipos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span><span class="n">storageorder</span><span class="o">=</span><span class="n">storageorder</span><span class="p">)</span>
</span><span id="Grib2Message-1210"><a href="#Grib2Message-1210"><span class="linenos">1210</span></a>        <span class="c1"># Apply bitmap.</span>
</span><span id="Grib2Message-1211"><a href="#Grib2Message-1211"><span class="linenos">1211</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-1212"><a href="#Grib2Message-1212"><span class="linenos">1212</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">fill_value</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ngrdpts</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1213"><a href="#Grib2Message-1213"><span class="linenos">1213</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bitMap</span><span class="p">),</span><span class="n">fld1</span><span class="p">)</span>
</span><span id="Grib2Message-1214"><a href="#Grib2Message-1214"><span class="linenos">1214</span></a>            <span class="k">if</span> <span class="n">masked_array</span><span class="p">:</span>
</span><span id="Grib2Message-1215"><a href="#Grib2Message-1215"><span class="linenos">1215</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_values</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message-1216"><a href="#Grib2Message-1216"><span class="linenos">1216</span></a>        <span class="c1"># Missing values instead of bitmap</span>
</span><span id="Grib2Message-1217"><a href="#Grib2Message-1217"><span class="linenos">1217</span></a>        <span class="k">elif</span> <span class="n">masked_array</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;priMissingValue&#39;</span><span class="p">):</span>
</span><span id="Grib2Message-1218"><a href="#Grib2Message-1218"><span class="linenos">1218</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;secMissingValue&#39;</span><span class="p">):</span>
</span><span id="Grib2Message-1219"><a href="#Grib2Message-1219"><span class="linenos">1219</span></a>                <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">fld1</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span><span class="p">,</span><span class="n">fld1</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">secMissingValue</span><span class="p">)</span>
</span><span id="Grib2Message-1220"><a href="#Grib2Message-1220"><span class="linenos">1220</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1221"><a href="#Grib2Message-1221"><span class="linenos">1221</span></a>                <span class="n">mask</span> <span class="o">=</span> <span class="n">fld1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span>
</span><span id="Grib2Message-1222"><a href="#Grib2Message-1222"><span class="linenos">1222</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fld1</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span><span id="Grib2Message-1223"><a href="#Grib2Message-1223"><span class="linenos">1223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1224"><a href="#Grib2Message-1224"><span class="linenos">1224</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">fld1</span>
</span><span id="Grib2Message-1225"><a href="#Grib2Message-1225"><span class="linenos">1225</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Rectangular grid.</span>
</span><span id="Grib2Message-1226"><a href="#Grib2Message-1226"><span class="linenos">1226</span></a>            <span class="k">if</span> <span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">fld</span><span class="p">):</span>
</span><span id="Grib2Message-1227"><a href="#Grib2Message-1227"><span class="linenos">1227</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fld</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>
</span><span id="Grib2Message-1228"><a href="#Grib2Message-1228"><span class="linenos">1228</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1229"><a href="#Grib2Message-1229"><span class="linenos">1229</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fld</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>
</span><span id="Grib2Message-1230"><a href="#Grib2Message-1230"><span class="linenos">1230</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1231"><a href="#Grib2Message-1231"><span class="linenos">1231</span></a>            <span class="k">if</span> <span class="n">gds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span> <span class="c1"># Reduced global Gaussian grid.</span>
</span><span id="Grib2Message-1232"><a href="#Grib2Message-1232"><span class="linenos">1232</span></a>                <span class="k">if</span> <span class="n">expand</span><span class="p">:</span>
</span><span id="Grib2Message-1233"><a href="#Grib2Message-1233"><span class="linenos">1233</span></a>                    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">redtoreg</span>
</span><span id="Grib2Message-1234"><a href="#Grib2Message-1234"><span class="linenos">1234</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Grib2Message-1235"><a href="#Grib2Message-1235"><span class="linenos">1235</span></a>                    <span class="n">lonsperlat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defList</span>
</span><span id="Grib2Message-1236"><a href="#Grib2Message-1236"><span class="linenos">1236</span></a>                    <span class="k">if</span> <span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">fld</span><span class="p">):</span>
</span><span id="Grib2Message-1237"><a href="#Grib2Message-1237"><span class="linenos">1237</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message-1238"><a href="#Grib2Message-1238"><span class="linenos">1238</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">redtoreg</span><span class="o">.</span><span class="n">_redtoreg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span><span class="n">lonsperlat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">long</span><span class="p">),</span>
</span><span id="Grib2Message-1239"><a href="#Grib2Message-1239"><span class="linenos">1239</span></a>                                                 <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message-1240"><a href="#Grib2Message-1240"><span class="linenos">1240</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_values</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message-1241"><a href="#Grib2Message-1241"><span class="linenos">1241</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1242"><a href="#Grib2Message-1242"><span class="linenos">1242</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">redtoreg</span><span class="o">.</span><span class="n">_redtoreg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span><span class="n">lonsperlat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">long</span><span class="p">),</span>
</span><span id="Grib2Message-1243"><a href="#Grib2Message-1243"><span class="linenos">1243</span></a>                                                 <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message-1244"><a href="#Grib2Message-1244"><span class="linenos">1244</span></a>        <span class="c1"># Check scan modes for rect grids.</span>
</span><span id="Grib2Message-1245"><a href="#Grib2Message-1245"><span class="linenos">1245</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-1246"><a href="#Grib2Message-1246"><span class="linenos">1246</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
</span><span id="Grib2Message-1247"><a href="#Grib2Message-1247"><span class="linenos">1247</span></a>                <span class="n">fldsave</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="c1"># casting makes a copy</span>
</span><span id="Grib2Message-1248"><a href="#Grib2Message-1248"><span class="linenos">1248</span></a>                <span class="n">fld</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">fldsave</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1249"><a href="#Grib2Message-1249"><span class="linenos">1249</span></a>
</span><span id="Grib2Message-1250"><a href="#Grib2Message-1250"><span class="linenos">1250</span></a>        <span class="c1"># Set data to integer according to GRIB metadata</span>
</span><span id="Grib2Message-1251"><a href="#Grib2Message-1251"><span class="linenos">1251</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">fld</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="Grib2Message-1252"><a href="#Grib2Message-1252"><span class="linenos">1252</span></a>
</span><span id="Grib2Message-1253"><a href="#Grib2Message-1253"><span class="linenos">1253</span></a>        <span class="c1"># Map the data values to their respective definitions.</span>
</span><span id="Grib2Message-1254"><a href="#Grib2Message-1254"><span class="linenos">1254</span></a>        <span class="k">if</span> <span class="n">map_keys</span><span class="p">:</span>
</span><span id="Grib2Message-1255"><a href="#Grib2Message-1255"><span class="linenos">1255</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Grib2Message-1256"><a href="#Grib2Message-1256"><span class="linenos">1256</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span> <span class="ow">and</span> \
</span><span id="Grib2Message-1257"><a href="#Grib2Message-1257"><span class="linenos">1257</span></a>               <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">and</span> \
</span><span id="Grib2Message-1258"><a href="#Grib2Message-1258"><span class="linenos">1258</span></a>               <span class="bp">self</span><span class="o">.</span><span class="n">shortName</span> <span class="o">==</span> <span class="s1">&#39;PWTHER&#39;</span><span class="p">:</span>
</span><span id="Grib2Message-1259"><a href="#Grib2Message-1259"><span class="linenos">1259</span></a>                <span class="c1"># MDL Predominant Weather Grid</span>
</span><span id="Grib2Message-1260"><a href="#Grib2Message-1260"><span class="linenos">1260</span></a>                <span class="n">keys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">decode_ndfd_wx_strings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lus</span><span class="p">)</span>
</span><span id="Grib2Message-1261"><a href="#Grib2Message-1261"><span class="linenos">1261</span></a>                <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
</span><span id="Grib2Message-1262"><a href="#Grib2Message-1262"><span class="linenos">1262</span></a>                    <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fld</span><span class="o">==</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message-1263"><a href="#Grib2Message-1263"><span class="linenos">1263</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">and</span> \
</span><span id="Grib2Message-1264"><a href="#Grib2Message-1264"><span class="linenos">1264</span></a>                 <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">65535</span> <span class="ow">and</span> \
</span><span id="Grib2Message-1265"><a href="#Grib2Message-1265"><span class="linenos">1265</span></a>                 <span class="bp">self</span><span class="o">.</span><span class="n">shortName</span> <span class="o">==</span> <span class="s1">&#39;CRAIN&#39;</span><span class="p">:</span>
</span><span id="Grib2Message-1266"><a href="#Grib2Message-1266"><span class="linenos">1266</span></a>                <span class="c1"># NDFD Predominant Weather Grid</span>
</span><span id="Grib2Message-1267"><a href="#Grib2Message-1267"><span class="linenos">1267</span></a>                <span class="n">keys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">decode_ndfd_wx_strings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lus</span><span class="p">)</span>
</span><span id="Grib2Message-1268"><a href="#Grib2Message-1268"><span class="linenos">1268</span></a>                <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
</span><span id="Grib2Message-1269"><a href="#Grib2Message-1269"><span class="linenos">1269</span></a>                    <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fld</span><span class="o">==</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message-1270"><a href="#Grib2Message-1270"><span class="linenos">1270</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1271"><a href="#Grib2Message-1271"><span class="linenos">1271</span></a>                <span class="c1"># For data whose units are defined in a code table</span>
</span><span id="Grib2Message-1272"><a href="#Grib2Message-1272"><span class="linenos">1272</span></a>                <span class="n">tbl</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d\.\d+&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message-1273"><a href="#Grib2Message-1273"><span class="linenos">1273</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Grib2Message-1274"><a href="#Grib2Message-1274"><span class="linenos">1274</span></a>                    <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fld</span><span class="o">==</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message-1275"><a href="#Grib2Message-1275"><span class="linenos">1275</span></a>        <span class="k">return</span> <span class="n">fld</span>
</span><span id="Grib2Message-1276"><a href="#Grib2Message-1276"><span class="linenos">1276</span></a>
</span><span id="Grib2Message-1277"><a href="#Grib2Message-1277"><span class="linenos">1277</span></a>
</span><span id="Grib2Message-1278"><a href="#Grib2Message-1278"><span class="linenos">1278</span></a>    <span class="k">def</span> <span class="nf">latlons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message-1279"><a href="#Grib2Message-1279"><span class="linenos">1279</span></a>        <span class="sd">&quot;&quot;&quot;Alias for `grib2io.Grib2Message.grid` method&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1280"><a href="#Grib2Message-1280"><span class="linenos">1280</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="Grib2Message-1281"><a href="#Grib2Message-1281"><span class="linenos">1281</span></a>
</span><span id="Grib2Message-1282"><a href="#Grib2Message-1282"><span class="linenos">1282</span></a>
</span><span id="Grib2Message-1283"><a href="#Grib2Message-1283"><span class="linenos">1283</span></a>    <span class="k">def</span> <span class="nf">grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message-1284"><a href="#Grib2Message-1284"><span class="linenos">1284</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1285"><a href="#Grib2Message-1285"><span class="linenos">1285</span></a><span class="sd">        Return lats,lons (in degrees) of grid. Currently can handle reg. lat/lon, </span>
</span><span id="Grib2Message-1286"><a href="#Grib2Message-1286"><span class="linenos">1286</span></a><span class="sd">        global Gaussian, mercator, stereographic, lambert conformal, albers equal-area, </span>
</span><span id="Grib2Message-1287"><a href="#Grib2Message-1287"><span class="linenos">1287</span></a><span class="sd">        space-view and azimuthal equidistant grids.</span>
</span><span id="Grib2Message-1288"><a href="#Grib2Message-1288"><span class="linenos">1288</span></a>
</span><span id="Grib2Message-1289"><a href="#Grib2Message-1289"><span class="linenos">1289</span></a><span class="sd">        Returns</span>
</span><span id="Grib2Message-1290"><a href="#Grib2Message-1290"><span class="linenos">1290</span></a><span class="sd">        -------</span>
</span><span id="Grib2Message-1291"><a href="#Grib2Message-1291"><span class="linenos">1291</span></a>
</span><span id="Grib2Message-1292"><a href="#Grib2Message-1292"><span class="linenos">1292</span></a><span class="sd">        **`lats, lons : numpy.ndarray`**</span>
</span><span id="Grib2Message-1293"><a href="#Grib2Message-1293"><span class="linenos">1293</span></a>
</span><span id="Grib2Message-1294"><a href="#Grib2Message-1294"><span class="linenos">1294</span></a><span class="sd">        Returns two numpy.ndarrays with dtype=numpy.float32 of grid latitudes and</span>
</span><span id="Grib2Message-1295"><a href="#Grib2Message-1295"><span class="linenos">1295</span></a><span class="sd">        longitudes in units of degrees.</span>
</span><span id="Grib2Message-1296"><a href="#Grib2Message-1296"><span class="linenos">1296</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-1297"><a href="#Grib2Message-1297"><span class="linenos">1297</span></a>        <span class="n">gdtnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span>
</span><span id="Grib2Message-1298"><a href="#Grib2Message-1298"><span class="linenos">1298</span></a>        <span class="n">gdtmpl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span>
</span><span id="Grib2Message-1299"><a href="#Grib2Message-1299"><span class="linenos">1299</span></a>        <span class="n">reggrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1"># This means regular 2-d grid</span>
</span><span id="Grib2Message-1300"><a href="#Grib2Message-1300"><span class="linenos">1300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Grib2Message-1301"><a href="#Grib2Message-1301"><span class="linenos">1301</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span>
</span><span id="Grib2Message-1302"><a href="#Grib2Message-1302"><span class="linenos">1302</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span>
</span><span id="Grib2Message-1303"><a href="#Grib2Message-1303"><span class="linenos">1303</span></a>        <span class="k">if</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-1304"><a href="#Grib2Message-1304"><span class="linenos">1304</span></a>            <span class="c1"># Regular lat/lon grid</span>
</span><span id="Grib2Message-1305"><a href="#Grib2Message-1305"><span class="linenos">1305</span></a>            <span class="n">lon1</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span>
</span><span id="Grib2Message-1306"><a href="#Grib2Message-1306"><span class="linenos">1306</span></a>            <span class="n">lon2</span><span class="p">,</span> <span class="n">lat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span>
</span><span id="Grib2Message-1307"><a href="#Grib2Message-1307"><span class="linenos">1307</span></a>            <span class="n">dlon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message-1308"><a href="#Grib2Message-1308"><span class="linenos">1308</span></a>            <span class="n">dlat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message-1309"><a href="#Grib2Message-1309"><span class="linenos">1309</span></a>            <span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span><span class="n">lat2</span><span class="o">+</span><span class="n">dlat</span><span class="p">,</span><span class="n">dlat</span><span class="p">)</span>
</span><span id="Grib2Message-1310"><a href="#Grib2Message-1310"><span class="linenos">1310</span></a>            <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="o">+</span><span class="n">dlon</span><span class="p">,</span><span class="n">dlon</span><span class="p">)</span>
</span><span id="Grib2Message-1311"><a href="#Grib2Message-1311"><span class="linenos">1311</span></a>            <span class="c1"># flip if scan mode says to.</span>
</span><span id="Grib2Message-1312"><a href="#Grib2Message-1312"><span class="linenos">1312</span></a>            <span class="c1">#if self.scanModeFlags[0]:</span>
</span><span id="Grib2Message-1313"><a href="#Grib2Message-1313"><span class="linenos">1313</span></a>            <span class="c1">#    lons = lons[::-1]</span>
</span><span id="Grib2Message-1314"><a href="#Grib2Message-1314"><span class="linenos">1314</span></a>            <span class="c1">#if not self.scanModeFlags[1]:</span>
</span><span id="Grib2Message-1315"><a href="#Grib2Message-1315"><span class="linenos">1315</span></a>            <span class="c1">#    lats = lats[::-1]</span>
</span><span id="Grib2Message-1316"><a href="#Grib2Message-1316"><span class="linenos">1316</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cyl&#39;</span>
</span><span id="Grib2Message-1317"><a href="#Grib2Message-1317"><span class="linenos">1317</span></a>            <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">)</span> <span class="c1"># make 2-d arrays.</span>
</span><span id="Grib2Message-1318"><a href="#Grib2Message-1318"><span class="linenos">1318</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span> <span class="c1"># Gaussian grid (only works for global!)</span>
</span><span id="Grib2Message-1319"><a href="#Grib2Message-1319"><span class="linenos">1319</span></a>            <span class="kn">from</span> <span class="nn">utils.gauss_grids</span> <span class="kn">import</span> <span class="n">gaussian_latitudes</span>
</span><span id="Grib2Message-1320"><a href="#Grib2Message-1320"><span class="linenos">1320</span></a>            <span class="n">lon1</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span>
</span><span id="Grib2Message-1321"><a href="#Grib2Message-1321"><span class="linenos">1321</span></a>            <span class="n">lon2</span><span class="p">,</span> <span class="n">lat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span>
</span><span id="Grib2Message-1322"><a href="#Grib2Message-1322"><span class="linenos">1322</span></a>            <span class="n">nlats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Grib2Message-1323"><a href="#Grib2Message-1323"><span class="linenos">1323</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">reggrid</span><span class="p">:</span> <span class="c1"># Reduced Gaussian grid.</span>
</span><span id="Grib2Message-1324"><a href="#Grib2Message-1324"><span class="linenos">1324</span></a>                <span class="n">nlons</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nlats</span>
</span><span id="Grib2Message-1325"><a href="#Grib2Message-1325"><span class="linenos">1325</span></a>                <span class="n">dlon</span> <span class="o">=</span> <span class="mf">360.</span><span class="o">/</span><span class="n">nlons</span>
</span><span id="Grib2Message-1326"><a href="#Grib2Message-1326"><span class="linenos">1326</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1327"><a href="#Grib2Message-1327"><span class="linenos">1327</span></a>                <span class="n">nlons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Grib2Message-1328"><a href="#Grib2Message-1328"><span class="linenos">1328</span></a>                <span class="n">dlon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message-1329"><a href="#Grib2Message-1329"><span class="linenos">1329</span></a>            <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="o">+</span><span class="n">dlon</span><span class="p">,</span><span class="n">dlon</span><span class="p">)</span>
</span><span id="Grib2Message-1330"><a href="#Grib2Message-1330"><span class="linenos">1330</span></a>            <span class="c1"># Compute Gaussian lats (north to south)</span>
</span><span id="Grib2Message-1331"><a href="#Grib2Message-1331"><span class="linenos">1331</span></a>            <span class="n">lats</span> <span class="o">=</span> <span class="n">gaussian_latitudes</span><span class="p">(</span><span class="n">nlats</span><span class="p">)</span>
</span><span id="Grib2Message-1332"><a href="#Grib2Message-1332"><span class="linenos">1332</span></a>            <span class="k">if</span> <span class="n">lat1</span> <span class="o">&lt;</span> <span class="n">lat2</span><span class="p">:</span>  <span class="c1"># reverse them if necessary</span>
</span><span id="Grib2Message-1333"><a href="#Grib2Message-1333"><span class="linenos">1333</span></a>                <span class="n">lats</span> <span class="o">=</span> <span class="n">lats</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1334"><a href="#Grib2Message-1334"><span class="linenos">1334</span></a>            <span class="c1"># flip if scan mode says to.</span>
</span><span id="Grib2Message-1335"><a href="#Grib2Message-1335"><span class="linenos">1335</span></a>            <span class="c1">#if self.scanModeFlags[0]:</span>
</span><span id="Grib2Message-1336"><a href="#Grib2Message-1336"><span class="linenos">1336</span></a>            <span class="c1">#    lons = lons[::-1]</span>
</span><span id="Grib2Message-1337"><a href="#Grib2Message-1337"><span class="linenos">1337</span></a>            <span class="c1">#if not self.scanModeFlags[1]:</span>
</span><span id="Grib2Message-1338"><a href="#Grib2Message-1338"><span class="linenos">1338</span></a>            <span class="c1">#    lats = lats[::-1]</span>
</span><span id="Grib2Message-1339"><a href="#Grib2Message-1339"><span class="linenos">1339</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cyl&#39;</span>
</span><span id="Grib2Message-1340"><a href="#Grib2Message-1340"><span class="linenos">1340</span></a>            <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">)</span> <span class="c1"># make 2-d arrays</span>
</span><span id="Grib2Message-1341"><a href="#Grib2Message-1341"><span class="linenos">1341</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">110</span><span class="p">]:</span>
</span><span id="Grib2Message-1342"><a href="#Grib2Message-1342"><span class="linenos">1342</span></a>            <span class="c1"># Mercator, Lambert Conformal, Stereographic, Albers Equal Area, Azimuthal Equidistant</span>
</span><span id="Grib2Message-1343"><a href="#Grib2Message-1343"><span class="linenos">1343</span></a>            <span class="n">dx</span><span class="p">,</span><span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message-1344"><a href="#Grib2Message-1344"><span class="linenos">1344</span></a>            <span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span>
</span><span id="Grib2Message-1345"><a href="#Grib2Message-1345"><span class="linenos">1345</span></a>            <span class="k">if</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="c1"># Mercator.</span>
</span><span id="Grib2Message-1346"><a href="#Grib2Message-1346"><span class="linenos">1346</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_ts&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span>
</span><span id="Grib2Message-1347"><a href="#Grib2Message-1347"><span class="linenos">1347</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message-1348"><a href="#Grib2Message-1348"><span class="linenos">1348</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message-1349"><a href="#Grib2Message-1349"><span class="linenos">1349</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message-1350"><a href="#Grib2Message-1350"><span class="linenos">1350</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message-1351"><a href="#Grib2Message-1351"><span class="linenos">1351</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message-1352"><a href="#Grib2Message-1352"><span class="linenos">1352</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message-1353"><a href="#Grib2Message-1353"><span class="linenos">1353</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message-1354"><a href="#Grib2Message-1354"><span class="linenos">1354</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message-1355"><a href="#Grib2Message-1355"><span class="linenos">1355</span></a>            <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>  <span class="c1"># Stereographic</span>
</span><span id="Grib2Message-1356"><a href="#Grib2Message-1356"><span class="linenos">1356</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_ts&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span>
</span><span id="Grib2Message-1357"><a href="#Grib2Message-1357"><span class="linenos">1357</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message-1358"><a href="#Grib2Message-1358"><span class="linenos">1358</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span>
</span><span id="Grib2Message-1359"><a href="#Grib2Message-1359"><span class="linenos">1359</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message-1360"><a href="#Grib2Message-1360"><span class="linenos">1360</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message-1361"><a href="#Grib2Message-1361"><span class="linenos">1361</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message-1362"><a href="#Grib2Message-1362"><span class="linenos">1362</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message-1363"><a href="#Grib2Message-1363"><span class="linenos">1363</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message-1364"><a href="#Grib2Message-1364"><span class="linenos">1364</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message-1365"><a href="#Grib2Message-1365"><span class="linenos">1365</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message-1366"><a href="#Grib2Message-1366"><span class="linenos">1366</span></a>            <span class="k">elif</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">]:</span> <span class="c1"># Lambert, Albers</span>
</span><span id="Grib2Message-1367"><a href="#Grib2Message-1367"><span class="linenos">1367</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_1&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_1</span>
</span><span id="Grib2Message-1368"><a href="#Grib2Message-1368"><span class="linenos">1368</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_2&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_2</span>
</span><span id="Grib2Message-1369"><a href="#Grib2Message-1369"><span class="linenos">1369</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message-1370"><a href="#Grib2Message-1370"><span class="linenos">1370</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message-1371"><a href="#Grib2Message-1371"><span class="linenos">1371</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message-1372"><a href="#Grib2Message-1372"><span class="linenos">1372</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message-1373"><a href="#Grib2Message-1373"><span class="linenos">1373</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message-1374"><a href="#Grib2Message-1374"><span class="linenos">1374</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message-1375"><a href="#Grib2Message-1375"><span class="linenos">1375</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message-1376"><a href="#Grib2Message-1376"><span class="linenos">1376</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message-1377"><a href="#Grib2Message-1377"><span class="linenos">1377</span></a>            <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">110</span><span class="p">:</span> <span class="c1"># Azimuthal Equidistant</span>
</span><span id="Grib2Message-1378"><a href="#Grib2Message-1378"><span class="linenos">1378</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message-1379"><a href="#Grib2Message-1379"><span class="linenos">1379</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span>
</span><span id="Grib2Message-1380"><a href="#Grib2Message-1380"><span class="linenos">1380</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message-1381"><a href="#Grib2Message-1381"><span class="linenos">1381</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message-1382"><a href="#Grib2Message-1382"><span class="linenos">1382</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message-1383"><a href="#Grib2Message-1383"><span class="linenos">1383</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message-1384"><a href="#Grib2Message-1384"><span class="linenos">1384</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message-1385"><a href="#Grib2Message-1385"><span class="linenos">1385</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message-1386"><a href="#Grib2Message-1386"><span class="linenos">1386</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message-1387"><a href="#Grib2Message-1387"><span class="linenos">1387</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="Grib2Message-1388"><a href="#Grib2Message-1388"><span class="linenos">1388</span></a>            <span class="c1"># Satellite Projection</span>
</span><span id="Grib2Message-1389"><a href="#Grib2Message-1389"><span class="linenos">1389</span></a>            <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message-1390"><a href="#Grib2Message-1390"><span class="linenos">1390</span></a>            <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message-1391"><a href="#Grib2Message-1391"><span class="linenos">1391</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message-1392"><a href="#Grib2Message-1392"><span class="linenos">1392</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message-1393"><a href="#Grib2Message-1393"><span class="linenos">1393</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span>
</span><span id="Grib2Message-1394"><a href="#Grib2Message-1394"><span class="linenos">1394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span>
</span><span id="Grib2Message-1395"><a href="#Grib2Message-1395"><span class="linenos">1395</span></a>            <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message-1396"><a href="#Grib2Message-1396"><span class="linenos">1396</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">),</span><span class="s1">&#39;f&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">,:,:]</span>
</span><span id="Grib2Message-1397"><a href="#Grib2Message-1397"><span class="linenos">1397</span></a>            <span class="n">x</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Grib2Message-1398"><a href="#Grib2Message-1398"><span class="linenos">1398</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">),</span><span class="s1">&#39;f&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:,:]</span>
</span><span id="Grib2Message-1399"><a href="#Grib2Message-1399"><span class="linenos">1399</span></a>            <span class="n">y</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Grib2Message-1400"><a href="#Grib2Message-1400"><span class="linenos">1400</span></a>            <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message-1401"><a href="#Grib2Message-1401"><span class="linenos">1401</span></a>            <span class="c1"># Set lons,lats to 1.e30 where undefined</span>
</span><span id="Grib2Message-1402"><a href="#Grib2Message-1402"><span class="linenos">1402</span></a>            <span class="n">abslons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
</span><span id="Grib2Message-1403"><a href="#Grib2Message-1403"><span class="linenos">1403</span></a>            <span class="n">abslats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span>
</span><span id="Grib2Message-1404"><a href="#Grib2Message-1404"><span class="linenos">1404</span></a>            <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">abslons</span> <span class="o">&lt;</span> <span class="mf">1.e20</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="mf">1.e30</span><span class="p">)</span>
</span><span id="Grib2Message-1405"><a href="#Grib2Message-1405"><span class="linenos">1405</span></a>            <span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">abslats</span> <span class="o">&lt;</span> <span class="mf">1.e20</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="mf">1.e30</span><span class="p">)</span>
</span><span id="Grib2Message-1406"><a href="#Grib2Message-1406"><span class="linenos">1406</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1407"><a href="#Grib2Message-1407"><span class="linenos">1407</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unsupported grid&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1408"><a href="#Grib2Message-1408"><span class="linenos">1408</span></a>
</span><span id="Grib2Message-1409"><a href="#Grib2Message-1409"><span class="linenos">1409</span></a>        <span class="k">return</span> <span class="n">lats</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">),</span> <span class="n">lons</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1410"><a href="#Grib2Message-1410"><span class="linenos">1410</span></a>
</span><span id="Grib2Message-1411"><a href="#Grib2Message-1411"><span class="linenos">1411</span></a>
</span><span id="Grib2Message-1412"><a href="#Grib2Message-1412"><span class="linenos">1412</span></a>    <span class="k">def</span> <span class="nf">addlocal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ludata</span><span class="p">):</span>
</span><span id="Grib2Message-1413"><a href="#Grib2Message-1413"><span class="linenos">1413</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1414"><a href="#Grib2Message-1414"><span class="linenos">1414</span></a><span class="sd">        Add a Local Use Section [(Section 2)](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_sect2.shtml)</span>
</span><span id="Grib2Message-1415"><a href="#Grib2Message-1415"><span class="linenos">1415</span></a><span class="sd">        to the GRIB2 message.</span>
</span><span id="Grib2Message-1416"><a href="#Grib2Message-1416"><span class="linenos">1416</span></a>
</span><span id="Grib2Message-1417"><a href="#Grib2Message-1417"><span class="linenos">1417</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message-1418"><a href="#Grib2Message-1418"><span class="linenos">1418</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message-1419"><a href="#Grib2Message-1419"><span class="linenos">1419</span></a>
</span><span id="Grib2Message-1420"><a href="#Grib2Message-1420"><span class="linenos">1420</span></a><span class="sd">        **`ludata : bytes`**: Local Use data.</span>
</span><span id="Grib2Message-1421"><a href="#Grib2Message-1421"><span class="linenos">1421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-1422"><a href="#Grib2Message-1422"><span class="linenos">1422</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ludata</span><span class="p">,</span><span class="nb">bytes</span><span class="p">)</span>
</span><span id="Grib2Message-1423"><a href="#Grib2Message-1423"><span class="linenos">1423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_addlocal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="n">ludata</span><span class="p">)</span>
</span><span id="Grib2Message-1424"><a href="#Grib2Message-1424"><span class="linenos">1424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hasLocalUseSection</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Grib2Message-1425"><a href="#Grib2Message-1425"><span class="linenos">1425</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Grib2Message-1426"><a href="#Grib2Message-1426"><span class="linenos">1426</span></a>
</span><span id="Grib2Message-1427"><a href="#Grib2Message-1427"><span class="linenos">1427</span></a>
</span><span id="Grib2Message-1428"><a href="#Grib2Message-1428"><span class="linenos">1428</span></a>    <span class="k">def</span> <span class="nf">addgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdsinfo</span><span class="p">,</span> <span class="n">gdtmpl</span><span class="p">,</span> <span class="n">deflist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Grib2Message-1429"><a href="#Grib2Message-1429"><span class="linenos">1429</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1430"><a href="#Grib2Message-1430"><span class="linenos">1430</span></a><span class="sd">        Add a Grid Definition Section [(Section 3)](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_doc/grib2_sect3.shtml) </span>
</span><span id="Grib2Message-1431"><a href="#Grib2Message-1431"><span class="linenos">1431</span></a><span class="sd">        to the GRIB2 message.</span>
</span><span id="Grib2Message-1432"><a href="#Grib2Message-1432"><span class="linenos">1432</span></a>
</span><span id="Grib2Message-1433"><a href="#Grib2Message-1433"><span class="linenos">1433</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message-1434"><a href="#Grib2Message-1434"><span class="linenos">1434</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message-1435"><a href="#Grib2Message-1435"><span class="linenos">1435</span></a>
</span><span id="Grib2Message-1436"><a href="#Grib2Message-1436"><span class="linenos">1436</span></a><span class="sd">        **`gdsinfo`**: Sequence containing information needed for the grid definition section.</span>
</span><span id="Grib2Message-1437"><a href="#Grib2Message-1437"><span class="linenos">1437</span></a>
</span><span id="Grib2Message-1438"><a href="#Grib2Message-1438"><span class="linenos">1438</span></a><span class="sd">        | Index | Description |</span>
</span><span id="Grib2Message-1439"><a href="#Grib2Message-1439"><span class="linenos">1439</span></a><span class="sd">        | :---: | :---        |</span>
</span><span id="Grib2Message-1440"><a href="#Grib2Message-1440"><span class="linenos">1440</span></a><span class="sd">        | gdsinfo[0] | Source of grid definition - [Code Table 3.0](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-0.shtml)|</span>
</span><span id="Grib2Message-1441"><a href="#Grib2Message-1441"><span class="linenos">1441</span></a><span class="sd">        | gdsinfo[1] | Number of data points|</span>
</span><span id="Grib2Message-1442"><a href="#Grib2Message-1442"><span class="linenos">1442</span></a><span class="sd">        | gdsinfo[2] | Number of octets for optional list of numbers defining number of points|</span>
</span><span id="Grib2Message-1443"><a href="#Grib2Message-1443"><span class="linenos">1443</span></a><span class="sd">        | gdsinfo[3] | Interpetation of list of numbers defining number of points - [Code Table 3.11](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-11.shtml)|</span>
</span><span id="Grib2Message-1444"><a href="#Grib2Message-1444"><span class="linenos">1444</span></a><span class="sd">        | gdsinfo[4] | Grid Definition Template Number - [Code Table 3.1](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-1.shtml)|</span>
</span><span id="Grib2Message-1445"><a href="#Grib2Message-1445"><span class="linenos">1445</span></a>
</span><span id="Grib2Message-1446"><a href="#Grib2Message-1446"><span class="linenos">1446</span></a><span class="sd">        **`gdtmpl`**: Sequence of values for the specified Grid Definition Template. Each </span>
</span><span id="Grib2Message-1447"><a href="#Grib2Message-1447"><span class="linenos">1447</span></a><span class="sd">        element of this integer array contains an entry (in the order specified) of Grid</span>
</span><span id="Grib2Message-1448"><a href="#Grib2Message-1448"><span class="linenos">1448</span></a><span class="sd">        Definition Template 3.NN</span>
</span><span id="Grib2Message-1449"><a href="#Grib2Message-1449"><span class="linenos">1449</span></a>
</span><span id="Grib2Message-1450"><a href="#Grib2Message-1450"><span class="linenos">1450</span></a><span class="sd">        **`deflist`**: Sequence containing the number of grid points contained in each </span>
</span><span id="Grib2Message-1451"><a href="#Grib2Message-1451"><span class="linenos">1451</span></a><span class="sd">        row (or column) of a non-regular grid.  Used if gdsinfo[2] != 0.</span>
</span><span id="Grib2Message-1452"><a href="#Grib2Message-1452"><span class="linenos">1452</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-1453"><a href="#Grib2Message-1453"><span class="linenos">1453</span></a>        <span class="k">if</span> <span class="mi">3</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="p">:</span>
</span><span id="Grib2Message-1454"><a href="#Grib2Message-1454"><span class="linenos">1454</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;GRIB2 Message already contains Grid Definition Section.&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1455"><a href="#Grib2Message-1455"><span class="linenos">1455</span></a>        <span class="k">if</span> <span class="n">deflist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-1456"><a href="#Grib2Message-1456"><span class="linenos">1456</span></a>            <span class="n">_deflist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">deflist</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message-1457"><a href="#Grib2Message-1457"><span class="linenos">1457</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1458"><a href="#Grib2Message-1458"><span class="linenos">1458</span></a>            <span class="n">_deflist</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-1459"><a href="#Grib2Message-1459"><span class="linenos">1459</span></a>        <span class="n">gdtnum</span> <span class="o">=</span> <span class="n">gdsinfo</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1460"><a href="#Grib2Message-1460"><span class="linenos">1460</span></a>        <span class="k">if</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">32768</span><span class="p">,</span><span class="mi">32769</span><span class="p">]:</span>
</span><span id="Grib2Message-1461"><a href="#Grib2Message-1461"><span class="linenos">1461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1462"><a href="#Grib2Message-1462"><span class="linenos">1462</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="c1"># mercator</span>
</span><span id="Grib2Message-1463"><a href="#Grib2Message-1463"><span class="linenos">1463</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1464"><a href="#Grib2Message-1464"><span class="linenos">1464</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span> <span class="c1"># stereographic</span>
</span><span id="Grib2Message-1465"><a href="#Grib2Message-1465"><span class="linenos">1465</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1466"><a href="#Grib2Message-1466"><span class="linenos">1466</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span> <span class="c1"># lambert conformal</span>
</span><span id="Grib2Message-1467"><a href="#Grib2Message-1467"><span class="linenos">1467</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1468"><a href="#Grib2Message-1468"><span class="linenos">1468</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span> <span class="c1"># albers equal area.</span>
</span><span id="Grib2Message-1469"><a href="#Grib2Message-1469"><span class="linenos">1469</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1470"><a href="#Grib2Message-1470"><span class="linenos">1470</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span> <span class="c1"># near-sided vertical perspective satellite projection</span>
</span><span id="Grib2Message-1471"><a href="#Grib2Message-1471"><span class="linenos">1471</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1472"><a href="#Grib2Message-1472"><span class="linenos">1472</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">110</span><span class="p">:</span> <span class="c1"># azimuthal equidistant.</span>
</span><span id="Grib2Message-1473"><a href="#Grib2Message-1473"><span class="linenos">1473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1474"><a href="#Grib2Message-1474"><span class="linenos">1474</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">120</span><span class="p">:</span>
</span><span id="Grib2Message-1475"><a href="#Grib2Message-1475"><span class="linenos">1475</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1476"><a href="#Grib2Message-1476"><span class="linenos">1476</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span> <span class="c1"># curvilinear orthogonal</span>
</span><span id="Grib2Message-1477"><a href="#Grib2Message-1477"><span class="linenos">1477</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1478"><a href="#Grib2Message-1478"><span class="linenos">1478</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1100</span><span class="p">]:</span>
</span><span id="Grib2Message-1479"><a href="#Grib2Message-1479"><span class="linenos">1479</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message-1480"><a href="#Grib2Message-1480"><span class="linenos">1480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_addgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span>
</span><span id="Grib2Message-1481"><a href="#Grib2Message-1481"><span class="linenos">1481</span></a>                                                   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gdsinfo</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message-1482"><a href="#Grib2Message-1482"><span class="linenos">1482</span></a>                                                   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message-1483"><a href="#Grib2Message-1483"><span class="linenos">1483</span></a>                                                   <span class="n">_deflist</span><span class="p">)</span>
</span><span id="Grib2Message-1484"><a href="#Grib2Message-1484"><span class="linenos">1484</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Grib2Message-1485"><a href="#Grib2Message-1485"><span class="linenos">1485</span></a>
</span><span id="Grib2Message-1486"><a href="#Grib2Message-1486"><span class="linenos">1486</span></a>
</span><span id="Grib2Message-1487"><a href="#Grib2Message-1487"><span class="linenos">1487</span></a>    <span class="k">def</span> <span class="nf">addfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">pdtnum</span><span class="p">,</span> <span class="n">pdtmpl</span><span class="p">,</span> <span class="n">coordlist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">packing</span><span class="o">=</span><span class="s2">&quot;complex-spdiff&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">packing_opts</span><span class="p">):</span> 
</span><span id="Grib2Message-1488"><a href="#Grib2Message-1488"><span class="linenos">1488</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1489"><a href="#Grib2Message-1489"><span class="linenos">1489</span></a><span class="sd">        Add a Product Definition, Data Representation, Bitmap, and Data Sections </span>
</span><span id="Grib2Message-1490"><a href="#Grib2Message-1490"><span class="linenos">1490</span></a><span class="sd">        to `Grib2Message` instance (i.e. Sections 4-7).  Must be called after the grid </span>
</span><span id="Grib2Message-1491"><a href="#Grib2Message-1491"><span class="linenos">1491</span></a><span class="sd">        definition section has been added (`addfield`).</span>
</span><span id="Grib2Message-1492"><a href="#Grib2Message-1492"><span class="linenos">1492</span></a>
</span><span id="Grib2Message-1493"><a href="#Grib2Message-1493"><span class="linenos">1493</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message-1494"><a href="#Grib2Message-1494"><span class="linenos">1494</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message-1495"><a href="#Grib2Message-1495"><span class="linenos">1495</span></a>
</span><span id="Grib2Message-1496"><a href="#Grib2Message-1496"><span class="linenos">1496</span></a><span class="sd">        **`field`**: Numpy array of data values to pack.  If field is a masked array, then </span>
</span><span id="Grib2Message-1497"><a href="#Grib2Message-1497"><span class="linenos">1497</span></a><span class="sd">        a bitmap is created from the mask.</span>
</span><span id="Grib2Message-1498"><a href="#Grib2Message-1498"><span class="linenos">1498</span></a>
</span><span id="Grib2Message-1499"><a href="#Grib2Message-1499"><span class="linenos">1499</span></a><span class="sd">        **`pdtnum`**: integer Product Definition Template Number - [Code Table 4.0](http://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table4-0.shtml)</span>
</span><span id="Grib2Message-1500"><a href="#Grib2Message-1500"><span class="linenos">1500</span></a>
</span><span id="Grib2Message-1501"><a href="#Grib2Message-1501"><span class="linenos">1501</span></a><span class="sd">        **`pdtmpl`**: Sequence with the data values for the specified Product Definition </span>
</span><span id="Grib2Message-1502"><a href="#Grib2Message-1502"><span class="linenos">1502</span></a><span class="sd">        Template (N=pdtnum).  Each element of this integer array contains an entry (in </span>
</span><span id="Grib2Message-1503"><a href="#Grib2Message-1503"><span class="linenos">1503</span></a><span class="sd">        the order specified) of Product Definition Template 4.N.</span>
</span><span id="Grib2Message-1504"><a href="#Grib2Message-1504"><span class="linenos">1504</span></a>
</span><span id="Grib2Message-1505"><a href="#Grib2Message-1505"><span class="linenos">1505</span></a><span class="sd">        **`coordlist`**: Sequence containing floating point values intended to document the </span>
</span><span id="Grib2Message-1506"><a href="#Grib2Message-1506"><span class="linenos">1506</span></a><span class="sd">        vertical discretization with model data on hybrid coordinate vertical levels. Default is `None`.</span>
</span><span id="Grib2Message-1507"><a href="#Grib2Message-1507"><span class="linenos">1507</span></a>
</span><span id="Grib2Message-1508"><a href="#Grib2Message-1508"><span class="linenos">1508</span></a><span class="sd">        **`packing`**: String to specify the type of packing. Valid options are the following:</span>
</span><span id="Grib2Message-1509"><a href="#Grib2Message-1509"><span class="linenos">1509</span></a>
</span><span id="Grib2Message-1510"><a href="#Grib2Message-1510"><span class="linenos">1510</span></a><span class="sd">        | Packing Scheme | Description |</span>
</span><span id="Grib2Message-1511"><a href="#Grib2Message-1511"><span class="linenos">1511</span></a><span class="sd">        | :---:          | :---:       |</span>
</span><span id="Grib2Message-1512"><a href="#Grib2Message-1512"><span class="linenos">1512</span></a><span class="sd">        | &#39;simple&#39;         | [Simple packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-0.shtml) | </span>
</span><span id="Grib2Message-1513"><a href="#Grib2Message-1513"><span class="linenos">1513</span></a><span class="sd">        | &#39;complex&#39;        | [Complex packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-2.shtml) | </span>
</span><span id="Grib2Message-1514"><a href="#Grib2Message-1514"><span class="linenos">1514</span></a><span class="sd">        | &#39;complex-spdiff&#39; | [Complex packing with Spatial Differencing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-3.shtml) | </span>
</span><span id="Grib2Message-1515"><a href="#Grib2Message-1515"><span class="linenos">1515</span></a><span class="sd">        | &#39;jpeg&#39;           | [JPEG compression](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-40.shtml) | </span>
</span><span id="Grib2Message-1516"><a href="#Grib2Message-1516"><span class="linenos">1516</span></a><span class="sd">        | &#39;png&#39;            | [PNG compression](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-41.shtml) | </span>
</span><span id="Grib2Message-1517"><a href="#Grib2Message-1517"><span class="linenos">1517</span></a><span class="sd">        | &#39;spectral-simple&#39;| [Spectral Data - Simple packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-50.shtml) | </span>
</span><span id="Grib2Message-1518"><a href="#Grib2Message-1518"><span class="linenos">1518</span></a><span class="sd">        | &#39;spectral-complex&#39;| [Spectral Data - Complex packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-51.shtml) | </span>
</span><span id="Grib2Message-1519"><a href="#Grib2Message-1519"><span class="linenos">1519</span></a>
</span><span id="Grib2Message-1520"><a href="#Grib2Message-1520"><span class="linenos">1520</span></a><span class="sd">        **`**packing_opts`**: Packing keyword arguments. The keywords are the same as Grib2Message attribute names for</span>
</span><span id="Grib2Message-1521"><a href="#Grib2Message-1521"><span class="linenos">1521</span></a><span class="sd">        the Data Representation Template (Section 5) metadata. Valid keywords per packing scheme are the following:</span>
</span><span id="Grib2Message-1522"><a href="#Grib2Message-1522"><span class="linenos">1522</span></a>
</span><span id="Grib2Message-1523"><a href="#Grib2Message-1523"><span class="linenos">1523</span></a><span class="sd">        | Packing Scheme | Keyword Arguments |</span>
</span><span id="Grib2Message-1524"><a href="#Grib2Message-1524"><span class="linenos">1524</span></a><span class="sd">        | :---:          | :---:                      |</span>
</span><span id="Grib2Message-1525"><a href="#Grib2Message-1525"><span class="linenos">1525</span></a><span class="sd">        | &#39;simple&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message-1526"><a href="#Grib2Message-1526"><span class="linenos">1526</span></a><span class="sd">        | &#39;complex&#39;     | `binScaleFactor`, `decScaleFactor`, `priMissingValue`, [`secMissingValue`] |</span>
</span><span id="Grib2Message-1527"><a href="#Grib2Message-1527"><span class="linenos">1527</span></a><span class="sd">        | &#39;complex-spdiff&#39;     | `binScaleFactor`, `decScaleFactor`, `spatialDifferenceOrder`, `priMissingValue`, [`secMissingValue`] |</span>
</span><span id="Grib2Message-1528"><a href="#Grib2Message-1528"><span class="linenos">1528</span></a><span class="sd">        | &#39;jpeg&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message-1529"><a href="#Grib2Message-1529"><span class="linenos">1529</span></a><span class="sd">        | &#39;png&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message-1530"><a href="#Grib2Message-1530"><span class="linenos">1530</span></a><span class="sd">        | &#39;spectral-simple&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message-1531"><a href="#Grib2Message-1531"><span class="linenos">1531</span></a><span class="sd">        | &#39;spectral-complex&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message-1532"><a href="#Grib2Message-1532"><span class="linenos">1532</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-1533"><a href="#Grib2Message-1533"><span class="linenos">1533</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Grib2Message-1534"><a href="#Grib2Message-1534"><span class="linenos">1534</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;addgrid() must be called before addfield()&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1535"><a href="#Grib2Message-1535"><span class="linenos">1535</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-1536"><a href="#Grib2Message-1536"><span class="linenos">1536</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
</span><span id="Grib2Message-1537"><a href="#Grib2Message-1537"><span class="linenos">1537</span></a>                <span class="n">fieldsave</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="c1"># Casting makes a copy</span>
</span><span id="Grib2Message-1538"><a href="#Grib2Message-1538"><span class="linenos">1538</span></a>                <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">fieldsave</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message-1539"><a href="#Grib2Message-1539"><span class="linenos">1539</span></a>        <span class="n">fld</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1540"><a href="#Grib2Message-1540"><span class="linenos">1540</span></a>        <span class="k">if</span> <span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ma</span><span class="o">.</span><span class="n">count_masked</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message-1541"><a href="#Grib2Message-1541"><span class="linenos">1541</span></a>            <span class="n">bitmapflag</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message-1542"><a href="#Grib2Message-1542"><span class="linenos">1542</span></a>            <span class="n">bmap</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">))</span>
</span><span id="Grib2Message-1543"><a href="#Grib2Message-1543"><span class="linenos">1543</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1544"><a href="#Grib2Message-1544"><span class="linenos">1544</span></a>            <span class="n">bitmapflag</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="Grib2Message-1545"><a href="#Grib2Message-1545"><span class="linenos">1545</span></a>            <span class="n">bmap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-1546"><a href="#Grib2Message-1546"><span class="linenos">1546</span></a>        <span class="k">if</span> <span class="n">coordlist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message-1547"><a href="#Grib2Message-1547"><span class="linenos">1547</span></a>            <span class="n">crdlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordlist</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span><span id="Grib2Message-1548"><a href="#Grib2Message-1548"><span class="linenos">1548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1549"><a href="#Grib2Message-1549"><span class="linenos">1549</span></a>            <span class="n">crdlist</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message-1550"><a href="#Grib2Message-1550"><span class="linenos">1550</span></a>
</span><span id="Grib2Message-1551"><a href="#Grib2Message-1551"><span class="linenos">1551</span></a>        <span class="c1"># Set data representation template number and template values</span>
</span><span id="Grib2Message-1552"><a href="#Grib2Message-1552"><span class="linenos">1552</span></a>        <span class="n">drtnum</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Grib2Message-1553"><a href="#Grib2Message-1553"><span class="linenos">1553</span></a>        <span class="n">drtmpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">DEFAULT_DRT_LEN</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message-1554"><a href="#Grib2Message-1554"><span class="linenos">1554</span></a>        <span class="k">if</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1555"><a href="#Grib2Message-1555"><span class="linenos">1555</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message-1556"><a href="#Grib2Message-1556"><span class="linenos">1556</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1557"><a href="#Grib2Message-1557"><span class="linenos">1557</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1558"><a href="#Grib2Message-1558"><span class="linenos">1558</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex&quot;</span> <span class="ow">or</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex-spdiff&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1559"><a href="#Grib2Message-1559"><span class="linenos">1559</span></a>            <span class="k">if</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1560"><a href="#Grib2Message-1560"><span class="linenos">1560</span></a>                <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Grib2Message-1561"><a href="#Grib2Message-1561"><span class="linenos">1561</span></a>            <span class="k">if</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex-spdiff&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1562"><a href="#Grib2Message-1562"><span class="linenos">1562</span></a>                <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="Grib2Message-1563"><a href="#Grib2Message-1563"><span class="linenos">1563</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s1">&#39;spatialDifferenceOrder&#39;</span><span class="p">]</span>
</span><span id="Grib2Message-1564"><a href="#Grib2Message-1564"><span class="linenos">1564</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1565"><a href="#Grib2Message-1565"><span class="linenos">1565</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1566"><a href="#Grib2Message-1566"><span class="linenos">1566</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">((</span><span class="s2">&quot;priMissingValue&quot;</span><span class="p">,</span><span class="s2">&quot;secMissingValue&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">):</span>
</span><span id="Grib2Message-1567"><a href="#Grib2Message-1567"><span class="linenos">1567</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Grib2Message-1568"><a href="#Grib2Message-1568"><span class="linenos">1568</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_float_to_int</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;priMissingValue&quot;</span><span class="p">])</span>
</span><span id="Grib2Message-1569"><a href="#Grib2Message-1569"><span class="linenos">1569</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_float_to_int</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;secMissingValue&quot;</span><span class="p">])</span>
</span><span id="Grib2Message-1570"><a href="#Grib2Message-1570"><span class="linenos">1570</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1571"><a href="#Grib2Message-1571"><span class="linenos">1571</span></a>                <span class="k">if</span> <span class="s2">&quot;priMissingValue&quot;</span> <span class="ow">in</span> <span class="n">packing_opts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Grib2Message-1572"><a href="#Grib2Message-1572"><span class="linenos">1572</span></a>                    <span class="n">drtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Grib2Message-1573"><a href="#Grib2Message-1573"><span class="linenos">1573</span></a>                    <span class="n">drtmpl</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_float_to_int</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;priMissingValue&quot;</span><span class="p">])</span>
</span><span id="Grib2Message-1574"><a href="#Grib2Message-1574"><span class="linenos">1574</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1575"><a href="#Grib2Message-1575"><span class="linenos">1575</span></a>                    <span class="n">drtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message-1576"><a href="#Grib2Message-1576"><span class="linenos">1576</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;jpeg&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1577"><a href="#Grib2Message-1577"><span class="linenos">1577</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">40</span>
</span><span id="Grib2Message-1578"><a href="#Grib2Message-1578"><span class="linenos">1578</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1579"><a href="#Grib2Message-1579"><span class="linenos">1579</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1580"><a href="#Grib2Message-1580"><span class="linenos">1580</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;png&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1581"><a href="#Grib2Message-1581"><span class="linenos">1581</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">41</span>
</span><span id="Grib2Message-1582"><a href="#Grib2Message-1582"><span class="linenos">1582</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1583"><a href="#Grib2Message-1583"><span class="linenos">1583</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1584"><a href="#Grib2Message-1584"><span class="linenos">1584</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;spectral-simple&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1585"><a href="#Grib2Message-1585"><span class="linenos">1585</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">50</span>
</span><span id="Grib2Message-1586"><a href="#Grib2Message-1586"><span class="linenos">1586</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1587"><a href="#Grib2Message-1587"><span class="linenos">1587</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1588"><a href="#Grib2Message-1588"><span class="linenos">1588</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;spectral-complex&quot;</span><span class="p">:</span>
</span><span id="Grib2Message-1589"><a href="#Grib2Message-1589"><span class="linenos">1589</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">51</span>
</span><span id="Grib2Message-1590"><a href="#Grib2Message-1590"><span class="linenos">1590</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1591"><a href="#Grib2Message-1591"><span class="linenos">1591</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message-1592"><a href="#Grib2Message-1592"><span class="linenos">1592</span></a>
</span><span id="Grib2Message-1593"><a href="#Grib2Message-1593"><span class="linenos">1593</span></a>        <span class="n">pdtnum</span> <span class="o">=</span> <span class="n">pdtnum</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pdtnum</span><span class="p">,</span><span class="n">Grib2Metadata</span><span class="p">)</span> <span class="k">else</span> <span class="n">pdtnum</span>
</span><span id="Grib2Message-1594"><a href="#Grib2Message-1594"><span class="linenos">1594</span></a>
</span><span id="Grib2Message-1595"><a href="#Grib2Message-1595"><span class="linenos">1595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_addfield</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span>
</span><span id="Grib2Message-1596"><a href="#Grib2Message-1596"><span class="linenos">1596</span></a>                                                    <span class="n">pdtnum</span><span class="p">,</span>
</span><span id="Grib2Message-1597"><a href="#Grib2Message-1597"><span class="linenos">1597</span></a>                                                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pdtmpl</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message-1598"><a href="#Grib2Message-1598"><span class="linenos">1598</span></a>                                                    <span class="n">crdlist</span><span class="p">,</span>
</span><span id="Grib2Message-1599"><a href="#Grib2Message-1599"><span class="linenos">1599</span></a>                                                    <span class="n">drtnum</span><span class="p">,</span>
</span><span id="Grib2Message-1600"><a href="#Grib2Message-1600"><span class="linenos">1600</span></a>                                                    <span class="n">drtmpl</span><span class="p">,</span>
</span><span id="Grib2Message-1601"><a href="#Grib2Message-1601"><span class="linenos">1601</span></a>                                                    <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">fld</span><span class="p">),</span>
</span><span id="Grib2Message-1602"><a href="#Grib2Message-1602"><span class="linenos">1602</span></a>                                                    <span class="n">bitmapflag</span><span class="p">,</span>
</span><span id="Grib2Message-1603"><a href="#Grib2Message-1603"><span class="linenos">1603</span></a>                                                    <span class="n">bmap</span><span class="p">)</span>
</span><span id="Grib2Message-1604"><a href="#Grib2Message-1604"><span class="linenos">1604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Grib2Message-1605"><a href="#Grib2Message-1605"><span class="linenos">1605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="Grib2Message-1606"><a href="#Grib2Message-1606"><span class="linenos">1606</span></a>        <span class="k">if</span> <span class="n">bmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Grib2Message-1607"><a href="#Grib2Message-1607"><span class="linenos">1607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Grib2Message-1608"><a href="#Grib2Message-1608"><span class="linenos">1608</span></a>
</span><span id="Grib2Message-1609"><a href="#Grib2Message-1609"><span class="linenos">1609</span></a>
</span><span id="Grib2Message-1610"><a href="#Grib2Message-1610"><span class="linenos">1610</span></a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message-1611"><a href="#Grib2Message-1611"><span class="linenos">1611</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1612"><a href="#Grib2Message-1612"><span class="linenos">1612</span></a><span class="sd">        Add End Section (Section 8) to the GRIB2 message. A GRIB2 message </span>
</span><span id="Grib2Message-1613"><a href="#Grib2Message-1613"><span class="linenos">1613</span></a><span class="sd">        is not complete without an end section.  Once an end section is added, </span>
</span><span id="Grib2Message-1614"><a href="#Grib2Message-1614"><span class="linenos">1614</span></a><span class="sd">        the GRIB2 message can be written to file.</span>
</span><span id="Grib2Message-1615"><a href="#Grib2Message-1615"><span class="linenos">1615</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-1616"><a href="#Grib2Message-1616"><span class="linenos">1616</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_end</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">)</span>
</span><span id="Grib2Message-1617"><a href="#Grib2Message-1617"><span class="linenos">1617</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="Grib2Message-1618"><a href="#Grib2Message-1618"><span class="linenos">1618</span></a>
</span><span id="Grib2Message-1619"><a href="#Grib2Message-1619"><span class="linenos">1619</span></a>    <span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Grib2Message-1620"><a href="#Grib2Message-1620"><span class="linenos">1620</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message-1621"><a href="#Grib2Message-1621"><span class="linenos">1621</span></a><span class="sd">        Return grib data in byte format. Useful for exporting data in non-file formats.</span>
</span><span id="Grib2Message-1622"><a href="#Grib2Message-1622"><span class="linenos">1622</span></a><span class="sd">        For example, can be used to output grib data directly to S3 using the boto3 client</span>
</span><span id="Grib2Message-1623"><a href="#Grib2Message-1623"><span class="linenos">1623</span></a><span class="sd">        without the need to write a temporary file to upload first.</span>
</span><span id="Grib2Message-1624"><a href="#Grib2Message-1624"><span class="linenos">1624</span></a>
</span><span id="Grib2Message-1625"><a href="#Grib2Message-1625"><span class="linenos">1625</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message-1626"><a href="#Grib2Message-1626"><span class="linenos">1626</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message-1627"><a href="#Grib2Message-1627"><span class="linenos">1627</span></a><span class="sd">        **`validate`**: bool (Default: True) If true, validates first/last four bytes for proper formatting, else</span>
</span><span id="Grib2Message-1628"><a href="#Grib2Message-1628"><span class="linenos">1628</span></a><span class="sd">        returns None. If False, message is output as is.</span>
</span><span id="Grib2Message-1629"><a href="#Grib2Message-1629"><span class="linenos">1629</span></a>
</span><span id="Grib2Message-1630"><a href="#Grib2Message-1630"><span class="linenos">1630</span></a><span class="sd">        Returns</span>
</span><span id="Grib2Message-1631"><a href="#Grib2Message-1631"><span class="linenos">1631</span></a><span class="sd">        -------</span>
</span><span id="Grib2Message-1632"><a href="#Grib2Message-1632"><span class="linenos">1632</span></a><span class="sd">        Returns GRIB2 formatted message as bytes.</span>
</span><span id="Grib2Message-1633"><a href="#Grib2Message-1633"><span class="linenos">1633</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message-1634"><a href="#Grib2Message-1634"><span class="linenos">1634</span></a>        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
</span><span id="Grib2Message-1635"><a href="#Grib2Message-1635"><span class="linenos">1635</span></a>            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;GRIB7777&#39;</span><span class="p">:</span>
</span><span id="Grib2Message-1636"><a href="#Grib2Message-1636"><span class="linenos">1636</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span>
</span><span id="Grib2Message-1637"><a href="#Grib2Message-1637"><span class="linenos">1637</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1638"><a href="#Grib2Message-1638"><span class="linenos">1638</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Grib2Message-1639"><a href="#Grib2Message-1639"><span class="linenos">1639</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message-1640"><a href="#Grib2Message-1640"><span class="linenos">1640</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span>
</span></pre></div>


    

                            <div id="Grib2Message.__init__" class="classattr">
                                        <input id="Grib2Message.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Grib2Message</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">msg</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">source</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">num</span><span class="o">=-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">decode</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">discipline</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">idsect</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.__init__-488"><a href="#Grib2Message.__init__-488"><span class="linenos">488</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">discipline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idsect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Grib2Message.__init__-489"><a href="#Grib2Message.__init__-489"><span class="linenos">489</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.__init__-490"><a href="#Grib2Message.__init__-490"><span class="linenos">490</span></a><span class="sd">        Class Constructor. Instantiation of this class can handle a GRIB2 message from an existing </span>
</span><span id="Grib2Message.__init__-491"><a href="#Grib2Message.__init__-491"><span class="linenos">491</span></a><span class="sd">        file or the creation of new GRIB2 message.  To create a new GRIB2 message, provide the </span>
</span><span id="Grib2Message.__init__-492"><a href="#Grib2Message.__init__-492"><span class="linenos">492</span></a><span class="sd">        appropriate values to the arguments `discipline` and `idsect`.  When these 2 arguments </span>
</span><span id="Grib2Message.__init__-493"><a href="#Grib2Message.__init__-493"><span class="linenos">493</span></a><span class="sd">        are not `None`, then a new GRIB2 message is created. NOTE: All other keyword arguments </span>
</span><span id="Grib2Message.__init__-494"><a href="#Grib2Message.__init__-494"><span class="linenos">494</span></a><span class="sd">        are ignored when a new message is created.</span>
</span><span id="Grib2Message.__init__-495"><a href="#Grib2Message.__init__-495"><span class="linenos">495</span></a>
</span><span id="Grib2Message.__init__-496"><a href="#Grib2Message.__init__-496"><span class="linenos">496</span></a><span class="sd">        ...</span>
</span><span id="Grib2Message.__init__-497"><a href="#Grib2Message.__init__-497"><span class="linenos">497</span></a>
</span><span id="Grib2Message.__init__-498"><a href="#Grib2Message.__init__-498"><span class="linenos">498</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message.__init__-499"><a href="#Grib2Message.__init__-499"><span class="linenos">499</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message.__init__-500"><a href="#Grib2Message.__init__-500"><span class="linenos">500</span></a>
</span><span id="Grib2Message.__init__-501"><a href="#Grib2Message.__init__-501"><span class="linenos">501</span></a><span class="sd">        **`msg`**: Binary string representing the GRIB2 Message read from file.</span>
</span><span id="Grib2Message.__init__-502"><a href="#Grib2Message.__init__-502"><span class="linenos">502</span></a>
</span><span id="Grib2Message.__init__-503"><a href="#Grib2Message.__init__-503"><span class="linenos">503</span></a><span class="sd">        **`source`**: Source of where where this GRIB2 message originated </span>
</span><span id="Grib2Message.__init__-504"><a href="#Grib2Message.__init__-504"><span class="linenos">504</span></a><span class="sd">        from (i.e. the input file). This allow for interaction with the </span>
</span><span id="Grib2Message.__init__-505"><a href="#Grib2Message.__init__-505"><span class="linenos">505</span></a><span class="sd">        instance of `grib2io.open`. Default is None.</span>
</span><span id="Grib2Message.__init__-506"><a href="#Grib2Message.__init__-506"><span class="linenos">506</span></a>
</span><span id="Grib2Message.__init__-507"><a href="#Grib2Message.__init__-507"><span class="linenos">507</span></a><span class="sd">        **`num`**: integer GRIB2 Message number from `grib2io.open`. Default value is -1.</span>
</span><span id="Grib2Message.__init__-508"><a href="#Grib2Message.__init__-508"><span class="linenos">508</span></a>
</span><span id="Grib2Message.__init__-509"><a href="#Grib2Message.__init__-509"><span class="linenos">509</span></a><span class="sd">        **`decode`**: If True [DEFAULT], decode GRIB2 section lists into metadata </span>
</span><span id="Grib2Message.__init__-510"><a href="#Grib2Message.__init__-510"><span class="linenos">510</span></a><span class="sd">        instance variables.</span>
</span><span id="Grib2Message.__init__-511"><a href="#Grib2Message.__init__-511"><span class="linenos">511</span></a>
</span><span id="Grib2Message.__init__-512"><a href="#Grib2Message.__init__-512"><span class="linenos">512</span></a><span class="sd">        **`discipline`**: integer GRIB2 Discipline [GRIB2 Table 0.0](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table0-0.shtml)</span>
</span><span id="Grib2Message.__init__-513"><a href="#Grib2Message.__init__-513"><span class="linenos">513</span></a>
</span><span id="Grib2Message.__init__-514"><a href="#Grib2Message.__init__-514"><span class="linenos">514</span></a><span class="sd">        **`idsect`**: Sequence containing GRIB1 Identification Section values (Section 1).</span>
</span><span id="Grib2Message.__init__-515"><a href="#Grib2Message.__init__-515"><span class="linenos">515</span></a>
</span><span id="Grib2Message.__init__-516"><a href="#Grib2Message.__init__-516"><span class="linenos">516</span></a><span class="sd">        | Index | Description |</span>
</span><span id="Grib2Message.__init__-517"><a href="#Grib2Message.__init__-517"><span class="linenos">517</span></a><span class="sd">        | :---: | :---        |</span>
</span><span id="Grib2Message.__init__-518"><a href="#Grib2Message.__init__-518"><span class="linenos">518</span></a><span class="sd">        | idsect[0] | Id of orginating centre - [ON388 - Table 0](https://www.nco.ncep.noaa.gov/pmb/docs/on388/table0.html)|</span>
</span><span id="Grib2Message.__init__-519"><a href="#Grib2Message.__init__-519"><span class="linenos">519</span></a><span class="sd">        | idsect[1] | Id of orginating sub-centre - [ON388 - Table C](https://www.nco.ncep.noaa.gov/pmb/docs/on388/tablec.html)|</span>
</span><span id="Grib2Message.__init__-520"><a href="#Grib2Message.__init__-520"><span class="linenos">520</span></a><span class="sd">        | idsect[2] | GRIB Master Tables Version Number - [Code Table 1.0](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-0.shtml)|</span>
</span><span id="Grib2Message.__init__-521"><a href="#Grib2Message.__init__-521"><span class="linenos">521</span></a><span class="sd">        | idsect[3] | GRIB Local Tables Version Number - [Code Table 1.1](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-1.shtml)|</span>
</span><span id="Grib2Message.__init__-522"><a href="#Grib2Message.__init__-522"><span class="linenos">522</span></a><span class="sd">        | idsect[4] | Significance of Reference Time - [Code Table 1.2](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-2.shtml)|</span>
</span><span id="Grib2Message.__init__-523"><a href="#Grib2Message.__init__-523"><span class="linenos">523</span></a><span class="sd">        | idsect[5] | Reference Time - Year (4 digits)|</span>
</span><span id="Grib2Message.__init__-524"><a href="#Grib2Message.__init__-524"><span class="linenos">524</span></a><span class="sd">        | idsect[6] | Reference Time - Month|</span>
</span><span id="Grib2Message.__init__-525"><a href="#Grib2Message.__init__-525"><span class="linenos">525</span></a><span class="sd">        | idsect[7] | Reference Time - Day|</span>
</span><span id="Grib2Message.__init__-526"><a href="#Grib2Message.__init__-526"><span class="linenos">526</span></a><span class="sd">        | idsect[8] | Reference Time - Hour|</span>
</span><span id="Grib2Message.__init__-527"><a href="#Grib2Message.__init__-527"><span class="linenos">527</span></a><span class="sd">        | idsect[9] | Reference Time - Minute|</span>
</span><span id="Grib2Message.__init__-528"><a href="#Grib2Message.__init__-528"><span class="linenos">528</span></a><span class="sd">        | idsect[10] | Reference Time - Second|</span>
</span><span id="Grib2Message.__init__-529"><a href="#Grib2Message.__init__-529"><span class="linenos">529</span></a><span class="sd">        | idsect[11] | Production status of data - [Code Table 1.3](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-3.shtml)|</span>
</span><span id="Grib2Message.__init__-530"><a href="#Grib2Message.__init__-530"><span class="linenos">530</span></a><span class="sd">        | idsect[12] | Type of processed data - [Code Table 1.4](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-4.shtml)|</span>
</span><span id="Grib2Message.__init__-531"><a href="#Grib2Message.__init__-531"><span class="linenos">531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.__init__-532"><a href="#Grib2Message.__init__-532"><span class="linenos">532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
</span><span id="Grib2Message.__init__-533"><a href="#Grib2Message.__init__-533"><span class="linenos">533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span> <span class="o">=</span> <span class="n">num</span>
</span><span id="Grib2Message.__init__-534"><a href="#Grib2Message.__init__-534"><span class="linenos">534</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span> <span class="o">=</span> <span class="n">decode</span>
</span><span id="Grib2Message.__init__-535"><a href="#Grib2Message.__init__-535"><span class="linenos">535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message.__init__-536"><a href="#Grib2Message.__init__-536"><span class="linenos">536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_datapos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message.__init__-537"><a href="#Grib2Message.__init__-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Grib2Message.__init__-538"><a href="#Grib2Message.__init__-538"><span class="linenos">538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hasLocalUseSection</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Grib2Message.__init__-539"><a href="#Grib2Message.__init__-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">isNDFD</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Grib2Message.__init__-540"><a href="#Grib2Message.__init__-540"><span class="linenos">540</span></a>        <span class="k">if</span> <span class="n">discipline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">idsect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.__init__-541"><a href="#Grib2Message.__init__-541"><span class="linenos">541</span></a>            <span class="c1"># New message</span>
</span><span id="Grib2Message.__init__-542"><a href="#Grib2Message.__init__-542"><span class="linenos">542</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_create</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">discipline</span><span class="p">,</span><span class="n">GRIB2_EDITION_NUMBER</span><span class="p">],</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message.__init__-543"><a href="#Grib2Message.__init__-543"><span class="linenos">543</span></a>                                                      <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idsect</span><span class="p">,</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">))</span>
</span><span id="Grib2Message.__init__-544"><a href="#Grib2Message.__init__-544"><span class="linenos">544</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.__init__-545"><a href="#Grib2Message.__init__-545"><span class="linenos">545</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.__init__-546"><a href="#Grib2Message.__init__-546"><span class="linenos">546</span></a>            <span class="c1"># Existing message</span>
</span><span id="Grib2Message.__init__-547"><a href="#Grib2Message.__init__-547"><span class="linenos">547</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="o">=</span> <span class="n">msg</span>
</span><span id="Grib2Message.__init__-548"><a href="#Grib2Message.__init__-548"><span class="linenos">548</span></a>        <span class="c1">#self.md5 = {}</span>
</span><span id="Grib2Message.__init__-549"><a href="#Grib2Message.__init__-549"><span class="linenos">549</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Class Constructor. Instantiation of this class can handle a GRIB2 message from an existing 
file or the creation of new GRIB2 message.  To create a new GRIB2 message, provide the 
appropriate values to the arguments <code>discipline</code> and <code>idsect</code>.  When these 2 arguments 
are not <code>None</code>, then a new GRIB2 message is created. NOTE: All other keyword arguments 
are ignored when a new message is created.</p>

<p>...</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>msg</code></strong>: Binary string representing the GRIB2 Message read from file.</p>

<p><strong><code>source</code></strong>: Source of where where this GRIB2 message originated 
from (i.e. the input file). This allow for interaction with the 
instance of <code><a href="#open">grib2io.open</a></code>. Default is None.</p>

<p><strong><code>num</code></strong>: integer GRIB2 Message number from <code><a href="#open">grib2io.open</a></code>. Default value is -1.</p>

<p><strong><code><a href="#Grib2Message.decode">decode</a></code></strong>: If True [DEFAULT], decode GRIB2 section lists into metadata 
instance variables.</p>

<p><strong><code>discipline</code></strong>: integer GRIB2 Discipline <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table0-0.shtml">GRIB2 Table 0.0</a></p>

<p><strong><code>idsect</code></strong>: Sequence containing GRIB1 Identification Section values (Section 1).</p>

<table>
<thead>
<tr>
  <th style="text-align:center;">Index</th>
  <th style="text-align:left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">idsect[0]</td>
  <td style="text-align:left;">Id of orginating centre - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/on388/table0.html">ON388 - Table 0</a></td>
</tr>
<tr>
  <td style="text-align:center;">idsect[1]</td>
  <td style="text-align:left;">Id of orginating sub-centre - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/on388/tablec.html">ON388 - Table C</a></td>
</tr>
<tr>
  <td style="text-align:center;">idsect[2]</td>
  <td style="text-align:left;">GRIB Master Tables Version Number - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-0.shtml">Code Table 1.0</a></td>
</tr>
<tr>
  <td style="text-align:center;">idsect[3]</td>
  <td style="text-align:left;">GRIB Local Tables Version Number - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-1.shtml">Code Table 1.1</a></td>
</tr>
<tr>
  <td style="text-align:center;">idsect[4]</td>
  <td style="text-align:left;">Significance of Reference Time - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-2.shtml">Code Table 1.2</a></td>
</tr>
<tr>
  <td style="text-align:center;">idsect[5]</td>
  <td style="text-align:left;">Reference Time - Year (4 digits)</td>
</tr>
<tr>
  <td style="text-align:center;">idsect[6]</td>
  <td style="text-align:left;">Reference Time - Month</td>
</tr>
<tr>
  <td style="text-align:center;">idsect[7]</td>
  <td style="text-align:left;">Reference Time - Day</td>
</tr>
<tr>
  <td style="text-align:center;">idsect[8]</td>
  <td style="text-align:left;">Reference Time - Hour</td>
</tr>
<tr>
  <td style="text-align:center;">idsect[9]</td>
  <td style="text-align:left;">Reference Time - Minute</td>
</tr>
<tr>
  <td style="text-align:center;">idsect[10]</td>
  <td style="text-align:left;">Reference Time - Second</td>
</tr>
<tr>
  <td style="text-align:center;">idsect[11]</td>
  <td style="text-align:left;">Production status of data - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-3.shtml">Code Table 1.3</a></td>
</tr>
<tr>
  <td style="text-align:center;">idsect[12]</td>
  <td style="text-align:left;">Type of processed data - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table1-4.shtml">Code Table 1.4</a></td>
</tr>
</tbody>
</table>
</div>


                            </div>
                            <div id="Grib2Message.unpack" class="classattr">
                                        <input id="Grib2Message.unpack-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unpack</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.unpack-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.unpack"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.unpack-568"><a href="#Grib2Message.unpack-568"><span class="linenos">568</span></a>    <span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message.unpack-569"><a href="#Grib2Message.unpack-569"><span class="linenos">569</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.unpack-570"><a href="#Grib2Message.unpack-570"><span class="linenos">570</span></a><span class="sd">        Unpacks GRIB2 section data from the packed, binary message.</span>
</span><span id="Grib2Message.unpack-571"><a href="#Grib2Message.unpack-571"><span class="linenos">571</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.unpack-572"><a href="#Grib2Message.unpack-572"><span class="linenos">572</span></a>        <span class="c1"># Section 0 - Indicator Section</span>
</span><span id="Grib2Message.unpack-573"><a href="#Grib2Message.unpack-573"><span class="linenos">573</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Grib2Message.unpack-574"><a href="#Grib2Message.unpack-574"><span class="linenos">574</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;4s&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.unpack-575"><a href="#Grib2Message.unpack-575"><span class="linenos">575</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;H&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.unpack-576"><a href="#Grib2Message.unpack-576"><span class="linenos">576</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span><span id="Grib2Message.unpack-577"><a href="#Grib2Message.unpack-577"><span class="linenos">577</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
</span><span id="Grib2Message.unpack-578"><a href="#Grib2Message.unpack-578"><span class="linenos">578</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;Q&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.unpack-579"><a href="#Grib2Message.unpack-579"><span class="linenos">579</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="mi">16</span>
</span><span id="Grib2Message.unpack-580"><a href="#Grib2Message.unpack-580"><span class="linenos">580</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-581"><a href="#Grib2Message.unpack-581"><span class="linenos">581</span></a>        <span class="c1">#self.md5[0] = _getmd5str(self.indicatorSection)</span>
</span><span id="Grib2Message.unpack-582"><a href="#Grib2Message.unpack-582"><span class="linenos">582</span></a>
</span><span id="Grib2Message.unpack-583"><a href="#Grib2Message.unpack-583"><span class="linenos">583</span></a>        <span class="c1"># Section 1 - Identification Section via g2clib.unpack1()</span>
</span><span id="Grib2Message.unpack-584"><a href="#Grib2Message.unpack-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-585"><a href="#Grib2Message.unpack-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message.unpack-586"><a href="#Grib2Message.unpack-586"><span class="linenos">586</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-587"><a href="#Grib2Message.unpack-587"><span class="linenos">587</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">65535</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">isNDFD</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Grib2Message.unpack-588"><a href="#Grib2Message.unpack-588"><span class="linenos">588</span></a>
</span><span id="Grib2Message.unpack-589"><a href="#Grib2Message.unpack-589"><span class="linenos">589</span></a>        <span class="c1"># After Section 1, perform rest of GRIB2 Decoding inside while loop</span>
</span><span id="Grib2Message.unpack-590"><a href="#Grib2Message.unpack-590"><span class="linenos">590</span></a>        <span class="c1"># to account for sub-messages.</span>
</span><span id="Grib2Message.unpack-591"><a href="#Grib2Message.unpack-591"><span class="linenos">591</span></a>        <span class="n">sectnum</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Grib2Message.unpack-592"><a href="#Grib2Message.unpack-592"><span class="linenos">592</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-593"><a href="#Grib2Message.unpack-593"><span class="linenos">593</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;7777&#39;</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-594"><a href="#Grib2Message.unpack-594"><span class="linenos">594</span></a>                <span class="k">break</span>
</span><span id="Grib2Message.unpack-595"><a href="#Grib2Message.unpack-595"><span class="linenos">595</span></a>
</span><span id="Grib2Message.unpack-596"><a href="#Grib2Message.unpack-596"><span class="linenos">596</span></a>            <span class="c1"># Read the length and section number.</span>
</span><span id="Grib2Message.unpack-597"><a href="#Grib2Message.unpack-597"><span class="linenos">597</span></a>            <span class="n">sectlen</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;i&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message.unpack-598"><a href="#Grib2Message.unpack-598"><span class="linenos">598</span></a>            <span class="n">prevsectnum</span> <span class="o">=</span> <span class="n">sectnum</span>
</span><span id="Grib2Message.unpack-599"><a href="#Grib2Message.unpack-599"><span class="linenos">599</span></a>            <span class="n">sectnum</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&gt;B&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">4</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message.unpack-600"><a href="#Grib2Message.unpack-600"><span class="linenos">600</span></a>
</span><span id="Grib2Message.unpack-601"><a href="#Grib2Message.unpack-601"><span class="linenos">601</span></a>            <span class="c1"># If the previous section number is &gt; current section number, then</span>
</span><span id="Grib2Message.unpack-602"><a href="#Grib2Message.unpack-602"><span class="linenos">602</span></a>            <span class="c1"># we have encountered a submessage.</span>
</span><span id="Grib2Message.unpack-603"><a href="#Grib2Message.unpack-603"><span class="linenos">603</span></a>            <span class="k">if</span> <span class="n">prevsectnum</span> <span class="o">&gt;</span> <span class="n">sectnum</span><span class="p">:</span> <span class="k">break</span>
</span><span id="Grib2Message.unpack-604"><a href="#Grib2Message.unpack-604"><span class="linenos">604</span></a>
</span><span id="Grib2Message.unpack-605"><a href="#Grib2Message.unpack-605"><span class="linenos">605</span></a>            <span class="c1"># Handle submessage accordingly.</span>
</span><span id="Grib2Message.unpack-606"><a href="#Grib2Message.unpack-606"><span class="linenos">606</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span><span class="nb">open</span><span class="p">):</span>
</span><span id="Grib2Message.unpack-607"><a href="#Grib2Message.unpack-607"><span class="linenos">607</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;isSubmessage&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]:</span>
</span><span id="Grib2Message.unpack-608"><a href="#Grib2Message.unpack-608"><span class="linenos">608</span></a>                    <span class="k">if</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageBeginSection&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]:</span>
</span><span id="Grib2Message.unpack-609"><a href="#Grib2Message.unpack-609"><span class="linenos">609</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;submessageOffset&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]</span>
</span><span id="Grib2Message.unpack-610"><a href="#Grib2Message.unpack-610"><span class="linenos">610</span></a>
</span><span id="Grib2Message.unpack-611"><a href="#Grib2Message.unpack-611"><span class="linenos">611</span></a>            <span class="c1"># Section 2 - Local Use Section.</span>
</span><span id="Grib2Message.unpack-612"><a href="#Grib2Message.unpack-612"><span class="linenos">612</span></a>            <span class="k">if</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-613"><a href="#Grib2Message.unpack-613"><span class="linenos">613</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_lus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="mi">5</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="o">+</span><span class="n">sectlen</span><span class="p">]</span>
</span><span id="Grib2Message.unpack-614"><a href="#Grib2Message.unpack-614"><span class="linenos">614</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">+=</span> <span class="n">sectlen</span>
</span><span id="Grib2Message.unpack-615"><a href="#Grib2Message.unpack-615"><span class="linenos">615</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">hasLocalUseSection</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Grib2Message.unpack-616"><a href="#Grib2Message.unpack-616"><span class="linenos">616</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-617"><a href="#Grib2Message.unpack-617"><span class="linenos">617</span></a>                <span class="c1">#self.md5[2] = _getmd5str(self.identificationSection)</span>
</span><span id="Grib2Message.unpack-618"><a href="#Grib2Message.unpack-618"><span class="linenos">618</span></a>
</span><span id="Grib2Message.unpack-619"><a href="#Grib2Message.unpack-619"><span class="linenos">619</span></a>            <span class="c1"># Section 3 - Grid Definition Section.</span>
</span><span id="Grib2Message.unpack-620"><a href="#Grib2Message.unpack-620"><span class="linenos">620</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-621"><a href="#Grib2Message.unpack-621"><span class="linenos">621</span></a>                <span class="n">_gds</span><span class="p">,</span><span class="n">_gdt</span><span class="p">,</span><span class="n">_deflist</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-622"><a href="#Grib2Message.unpack-622"><span class="linenos">622</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span> <span class="o">=</span> <span class="n">_gds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message.unpack-623"><a href="#Grib2Message.unpack-623"><span class="linenos">623</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">_gds</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;3.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-624"><a href="#Grib2Message.unpack-624"><span class="linenos">624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span> <span class="o">=</span> <span class="n">_gdt</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message.unpack-625"><a href="#Grib2Message.unpack-625"><span class="linenos">625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">defList</span> <span class="o">=</span> <span class="n">_deflist</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message.unpack-626"><a href="#Grib2Message.unpack-626"><span class="linenos">626</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-627"><a href="#Grib2Message.unpack-627"><span class="linenos">627</span></a>                <span class="c1">#self.md5[3] = _getmd5str([self.gridDefinitionTemplateNumber]+self.gridDefinitionTemplate)</span>
</span><span id="Grib2Message.unpack-628"><a href="#Grib2Message.unpack-628"><span class="linenos">628</span></a>
</span><span id="Grib2Message.unpack-629"><a href="#Grib2Message.unpack-629"><span class="linenos">629</span></a>            <span class="c1"># Section 4 - Product Definition Section.</span>
</span><span id="Grib2Message.unpack-630"><a href="#Grib2Message.unpack-630"><span class="linenos">630</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-631"><a href="#Grib2Message.unpack-631"><span class="linenos">631</span></a>                <span class="n">_pdt</span><span class="p">,</span><span class="n">_pdtn</span><span class="p">,</span><span class="n">_coordlst</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-632"><a href="#Grib2Message.unpack-632"><span class="linenos">632</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span> <span class="o">=</span> <span class="n">_pdt</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message.unpack-633"><a href="#Grib2Message.unpack-633"><span class="linenos">633</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">_pdtn</span><span class="p">),</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-634"><a href="#Grib2Message.unpack-634"><span class="linenos">634</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">coordinateList</span> <span class="o">=</span> <span class="n">_coordlst</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message.unpack-635"><a href="#Grib2Message.unpack-635"><span class="linenos">635</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-636"><a href="#Grib2Message.unpack-636"><span class="linenos">636</span></a>                <span class="c1">#self.md5[4] = _getmd5str([self.productDefinitionTemplateNumber]+self.productDefinitionTemplate)</span>
</span><span id="Grib2Message.unpack-637"><a href="#Grib2Message.unpack-637"><span class="linenos">637</span></a>
</span><span id="Grib2Message.unpack-638"><a href="#Grib2Message.unpack-638"><span class="linenos">638</span></a>            <span class="c1"># Section 5 - Data Representation Section.</span>
</span><span id="Grib2Message.unpack-639"><a href="#Grib2Message.unpack-639"><span class="linenos">639</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-640"><a href="#Grib2Message.unpack-640"><span class="linenos">640</span></a>                <span class="n">_drt</span><span class="p">,</span><span class="n">_drtn</span><span class="p">,</span><span class="n">_npts</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack5</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-641"><a href="#Grib2Message.unpack-641"><span class="linenos">641</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span> <span class="o">=</span> <span class="n">_drt</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="Grib2Message.unpack-642"><a href="#Grib2Message.unpack-642"><span class="linenos">642</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">_drtn</span><span class="p">),</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-643"><a href="#Grib2Message.unpack-643"><span class="linenos">643</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">numberOfDataPoints</span> <span class="o">=</span> <span class="n">_npts</span>
</span><span id="Grib2Message.unpack-644"><a href="#Grib2Message.unpack-644"><span class="linenos">644</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-645"><a href="#Grib2Message.unpack-645"><span class="linenos">645</span></a>                <span class="c1">#self.md5[5] = _getmd5str([self.dataRepresentationTemplateNumber]+self.dataRepresentationTemplate)</span>
</span><span id="Grib2Message.unpack-646"><a href="#Grib2Message.unpack-646"><span class="linenos">646</span></a>
</span><span id="Grib2Message.unpack-647"><a href="#Grib2Message.unpack-647"><span class="linenos">647</span></a>            <span class="c1"># Section 6 - Bitmap Section.</span>
</span><span id="Grib2Message.unpack-648"><a href="#Grib2Message.unpack-648"><span class="linenos">648</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-649"><a href="#Grib2Message.unpack-649"><span class="linenos">649</span></a>                <span class="n">_bmap</span><span class="p">,</span><span class="n">_bmapflag</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack6</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-650"><a href="#Grib2Message.unpack-650"><span class="linenos">650</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">=</span> <span class="n">_bmapflag</span>
</span><span id="Grib2Message.unpack-651"><a href="#Grib2Message.unpack-651"><span class="linenos">651</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-652"><a href="#Grib2Message.unpack-652"><span class="linenos">652</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">bitMap</span> <span class="o">=</span> <span class="n">_bmap</span>
</span><span id="Grib2Message.unpack-653"><a href="#Grib2Message.unpack-653"><span class="linenos">653</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">254</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-654"><a href="#Grib2Message.unpack-654"><span class="linenos">654</span></a>                    <span class="c1"># Value of 254 says to use a previous bitmap in the file.</span>
</span><span id="Grib2Message.unpack-655"><a href="#Grib2Message.unpack-655"><span class="linenos">655</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message.unpack-656"><a href="#Grib2Message.unpack-656"><span class="linenos">656</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span><span class="nb">open</span><span class="p">):</span>
</span><span id="Grib2Message.unpack-657"><a href="#Grib2Message.unpack-657"><span class="linenos">657</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">bitMap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">_index</span><span class="p">[</span><span class="s1">&#39;bitMap&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_msgnum</span><span class="p">]</span>
</span><span id="Grib2Message.unpack-658"><a href="#Grib2Message.unpack-658"><span class="linenos">658</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">+=</span> <span class="n">sectlen</span> <span class="c1"># IMPORTANT: This is here because g2clib.unpack6() does not return updated position.</span>
</span><span id="Grib2Message.unpack-659"><a href="#Grib2Message.unpack-659"><span class="linenos">659</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-660"><a href="#Grib2Message.unpack-660"><span class="linenos">660</span></a>                <span class="c1">#self.md5[6] = None</span>
</span><span id="Grib2Message.unpack-661"><a href="#Grib2Message.unpack-661"><span class="linenos">661</span></a>
</span><span id="Grib2Message.unpack-662"><a href="#Grib2Message.unpack-662"><span class="linenos">662</span></a>            <span class="c1"># Section 7 - Data Section (data unpacked when data() method is invoked).</span>
</span><span id="Grib2Message.unpack-663"><a href="#Grib2Message.unpack-663"><span class="linenos">663</span></a>            <span class="k">elif</span> <span class="n">sectnum</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-664"><a href="#Grib2Message.unpack-664"><span class="linenos">664</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_datapos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span>
</span><span id="Grib2Message.unpack-665"><a href="#Grib2Message.unpack-665"><span class="linenos">665</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">+=</span> <span class="n">sectlen</span> <span class="c1"># REMOVE THIS WHEN UNPACKING DATA IS IMPLEMENTED</span>
</span><span id="Grib2Message.unpack-666"><a href="#Grib2Message.unpack-666"><span class="linenos">666</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-667"><a href="#Grib2Message.unpack-667"><span class="linenos">667</span></a>                <span class="c1">#self.md5[7] = _getmd5str(self._msg[self._datapos:sectlen+1])</span>
</span><span id="Grib2Message.unpack-668"><a href="#Grib2Message.unpack-668"><span class="linenos">668</span></a>
</span><span id="Grib2Message.unpack-669"><a href="#Grib2Message.unpack-669"><span class="linenos">669</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.unpack-670"><a href="#Grib2Message.unpack-670"><span class="linenos">670</span></a>                <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unknown section number = </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sectnum</span>
</span><span id="Grib2Message.unpack-671"><a href="#Grib2Message.unpack-671"><span class="linenos">671</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span><span id="Grib2Message.unpack-672"><a href="#Grib2Message.unpack-672"><span class="linenos">672</span></a>
</span><span id="Grib2Message.unpack-673"><a href="#Grib2Message.unpack-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Unpacks GRIB2 section data from the packed, binary message.</p>
</div>


                            </div>
                            <div id="Grib2Message.decode" class="classattr">
                                        <input id="Grib2Message.decode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.decode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.decode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.decode-675"><a href="#Grib2Message.decode-675"><span class="linenos"> 675</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message.decode-676"><a href="#Grib2Message.decode-676"><span class="linenos"> 676</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.decode-677"><a href="#Grib2Message.decode-677"><span class="linenos"> 677</span></a><span class="sd">        Decode the unpacked GRIB2 integer-coded metadata in human-readable form and linked to GRIB2 tables.</span>
</span><span id="Grib2Message.decode-678"><a href="#Grib2Message.decode-678"><span class="linenos"> 678</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.decode-679"><a href="#Grib2Message.decode-679"><span class="linenos"> 679</span></a>
</span><span id="Grib2Message.decode-680"><a href="#Grib2Message.decode-680"><span class="linenos"> 680</span></a>        <span class="c1"># Section 0 - Indictator Section</span>
</span><span id="Grib2Message.decode-681"><a href="#Grib2Message.decode-681"><span class="linenos"> 681</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">discipline</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indicatorSection</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-682"><a href="#Grib2Message.decode-682"><span class="linenos"> 682</span></a>
</span><span id="Grib2Message.decode-683"><a href="#Grib2Message.decode-683"><span class="linenos"> 683</span></a>        <span class="c1"># Section 1 - Indentification Section.</span>
</span><span id="Grib2Message.decode-684"><a href="#Grib2Message.decode-684"><span class="linenos"> 684</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">originatingCenter</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;originating_centers&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-685"><a href="#Grib2Message.decode-685"><span class="linenos"> 685</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">originatingSubCenter</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;originating_subcenters&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-686"><a href="#Grib2Message.decode-686"><span class="linenos"> 686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">masterTableInfo</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-687"><a href="#Grib2Message.decode-687"><span class="linenos"> 687</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">localTableInfo</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-688"><a href="#Grib2Message.decode-688"><span class="linenos"> 688</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">significanceOfReferenceTime</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.2&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-689"><a href="#Grib2Message.decode-689"><span class="linenos"> 689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="Grib2Message.decode-690"><a href="#Grib2Message.decode-690"><span class="linenos"> 690</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</span><span id="Grib2Message.decode-691"><a href="#Grib2Message.decode-691"><span class="linenos"> 691</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
</span><span id="Grib2Message.decode-692"><a href="#Grib2Message.decode-692"><span class="linenos"> 692</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message.decode-693"><a href="#Grib2Message.decode-693"><span class="linenos"> 693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">minute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
</span><span id="Grib2Message.decode-694"><a href="#Grib2Message.decode-694"><span class="linenos"> 694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message.decode-695"><a href="#Grib2Message.decode-695"><span class="linenos"> 695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refDate</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="o">*</span><span class="mi">1000000</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="o">*</span><span class="mi">10000</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span>
</span><span id="Grib2Message.decode-696"><a href="#Grib2Message.decode-696"><span class="linenos"> 696</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dtReferenceDate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
</span><span id="Grib2Message.decode-697"><a href="#Grib2Message.decode-697"><span class="linenos"> 697</span></a>                                                 <span class="n">hour</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span><span class="n">minute</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span>
</span><span id="Grib2Message.decode-698"><a href="#Grib2Message.decode-698"><span class="linenos"> 698</span></a>                                                 <span class="n">second</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>
</span><span id="Grib2Message.decode-699"><a href="#Grib2Message.decode-699"><span class="linenos"> 699</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">productionStatus</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.3&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-700"><a href="#Grib2Message.decode-700"><span class="linenos"> 700</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">typeOfData</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;1.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-701"><a href="#Grib2Message.decode-701"><span class="linenos"> 701</span></a>
</span><span id="Grib2Message.decode-702"><a href="#Grib2Message.decode-702"><span class="linenos"> 702</span></a>        <span class="c1"># ----------------------------</span>
</span><span id="Grib2Message.decode-703"><a href="#Grib2Message.decode-703"><span class="linenos"> 703</span></a>        <span class="c1"># Section 3 -- Grid Definition</span>
</span><span id="Grib2Message.decode-704"><a href="#Grib2Message.decode-704"><span class="linenos"> 704</span></a>        <span class="c1"># ----------------------------</span>
</span><span id="Grib2Message.decode-705"><a href="#Grib2Message.decode-705"><span class="linenos"> 705</span></a>
</span><span id="Grib2Message.decode-706"><a href="#Grib2Message.decode-706"><span class="linenos"> 706</span></a>        <span class="c1"># Set shape of the Earth parameters</span>
</span><span id="Grib2Message.decode-707"><a href="#Grib2Message.decode-707"><span class="linenos"> 707</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">1200</span><span class="p">]:</span>
</span><span id="Grib2Message.decode-708"><a href="#Grib2Message.decode-708"><span class="linenos"> 708</span></a>            <span class="n">earthparams</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-709"><a href="#Grib2Message.decode-709"><span class="linenos"> 709</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-710"><a href="#Grib2Message.decode-710"><span class="linenos"> 710</span></a>            <span class="n">earthparams</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">earth_params</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="Grib2Message.decode-711"><a href="#Grib2Message.decode-711"><span class="linenos"> 711</span></a>        <span class="k">if</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;spherical&#39;</span><span class="p">:</span>
</span><span id="Grib2Message.decode-712"><a href="#Grib2Message.decode-712"><span class="linenos"> 712</span></a>            <span class="k">if</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.decode-713"><a href="#Grib2Message.decode-713"><span class="linenos"> 713</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Grib2Message.decode-714"><a href="#Grib2Message.decode-714"><span class="linenos"> 714</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-715"><a href="#Grib2Message.decode-715"><span class="linenos"> 715</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-716"><a href="#Grib2Message.decode-716"><span class="linenos"> 716</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-717"><a href="#Grib2Message.decode-717"><span class="linenos"> 717</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span>
</span><span id="Grib2Message.decode-718"><a href="#Grib2Message.decode-718"><span class="linenos"> 718</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-719"><a href="#Grib2Message.decode-719"><span class="linenos"> 719</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-720"><a href="#Grib2Message.decode-720"><span class="linenos"> 720</span></a>        <span class="k">elif</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;oblateSpheroid&#39;</span><span class="p">:</span>
</span><span id="Grib2Message.decode-721"><a href="#Grib2Message.decode-721"><span class="linenos"> 721</span></a>            <span class="k">if</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;major_axis&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;minor_axis&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.decode-722"><a href="#Grib2Message.decode-722"><span class="linenos"> 722</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Grib2Message.decode-723"><a href="#Grib2Message.decode-723"><span class="linenos"> 723</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Grib2Message.decode-724"><a href="#Grib2Message.decode-724"><span class="linenos"> 724</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span><span id="Grib2Message.decode-725"><a href="#Grib2Message.decode-725"><span class="linenos"> 725</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-726"><a href="#Grib2Message.decode-726"><span class="linenos"> 726</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthRadius</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span>
</span><span id="Grib2Message.decode-727"><a href="#Grib2Message.decode-727"><span class="linenos"> 727</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;major_axis&#39;</span><span class="p">]</span>
</span><span id="Grib2Message.decode-728"><a href="#Grib2Message.decode-728"><span class="linenos"> 728</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span> <span class="o">=</span> <span class="n">earthparams</span><span class="p">[</span><span class="s1">&#39;minor_axis&#39;</span><span class="p">]</span>
</span><span id="Grib2Message.decode-729"><a href="#Grib2Message.decode-729"><span class="linenos"> 729</span></a>
</span><span id="Grib2Message.decode-730"><a href="#Grib2Message.decode-730"><span class="linenos"> 730</span></a>        <span class="n">reggrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1"># self.gridDefinitionSection[2]=0 means regular 2-d grid</span>
</span><span id="Grib2Message.decode-731"><a href="#Grib2Message.decode-731"><span class="linenos"> 731</span></a>        <span class="k">if</span> <span class="n">reggrid</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1200</span><span class="p">]:</span>
</span><span id="Grib2Message.decode-732"><a href="#Grib2Message.decode-732"><span class="linenos"> 732</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
</span><span id="Grib2Message.decode-733"><a href="#Grib2Message.decode-733"><span class="linenos"> 733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message.decode-734"><a href="#Grib2Message.decode-734"><span class="linenos"> 734</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">reggrid</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span>
</span><span id="Grib2Message.decode-735"><a href="#Grib2Message.decode-735"><span class="linenos"> 735</span></a>            <span class="c1"># Reduced Gaussian Grid</span>
</span><span id="Grib2Message.decode-736"><a href="#Grib2Message.decode-736"><span class="linenos"> 736</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message.decode-737"><a href="#Grib2Message.decode-737"><span class="linenos"> 737</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">32768</span><span class="p">,</span><span class="mi">32769</span><span class="p">]:</span>
</span><span id="Grib2Message.decode-738"><a href="#Grib2Message.decode-738"><span class="linenos"> 738</span></a>            <span class="c1"># Regular or Rotated Lat/Lon Grid</span>
</span><span id="Grib2Message.decode-739"><a href="#Grib2Message.decode-739"><span class="linenos"> 739</span></a>            <span class="n">scalefact</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
</span><span id="Grib2Message.decode-740"><a href="#Grib2Message.decode-740"><span class="linenos"> 740</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4294967295</span><span class="p">:</span>
</span><span id="Grib2Message.decode-741"><a href="#Grib2Message.decode-741"><span class="linenos"> 741</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Grib2Message.decode-742"><a href="#Grib2Message.decode-742"><span class="linenos"> 742</span></a>            <span class="n">divisor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
</span><span id="Grib2Message.decode-743"><a href="#Grib2Message.decode-743"><span class="linenos"> 743</span></a>            <span class="k">if</span> <span class="n">scalefact</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">scalefact</span> <span class="o">=</span> <span class="mf">1.</span>
</span><span id="Grib2Message.decode-744"><a href="#Grib2Message.decode-744"><span class="linenos"> 744</span></a>            <span class="k">if</span> <span class="n">divisor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">divisor</span> <span class="o">=</span> <span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-745"><a href="#Grib2Message.decode-745"><span class="linenos"> 745</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-746"><a href="#Grib2Message.decode-746"><span class="linenos"> 746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-747"><a href="#Grib2Message.decode-747"><span class="linenos"> 747</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-748"><a href="#Grib2Message.decode-748"><span class="linenos"> 748</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-749"><a href="#Grib2Message.decode-749"><span class="linenos"> 749</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-750"><a href="#Grib2Message.decode-750"><span class="linenos"> 750</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-751"><a href="#Grib2Message.decode-751"><span class="linenos"> 751</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span><span class="p">:</span>
</span><span id="Grib2Message.decode-752"><a href="#Grib2Message.decode-752"><span class="linenos"> 752</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message.decode-753"><a href="#Grib2Message.decode-753"><span class="linenos"> 753</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">:</span>
</span><span id="Grib2Message.decode-754"><a href="#Grib2Message.decode-754"><span class="linenos"> 754</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message.decode-755"><a href="#Grib2Message.decode-755"><span class="linenos"> 755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-756"><a href="#Grib2Message.decode-756"><span class="linenos"> 756</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Grib2Message.decode-757"><a href="#Grib2Message.decode-757"><span class="linenos"> 757</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">latitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-758"><a href="#Grib2Message.decode-758"><span class="linenos"> 758</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">longitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-759"><a href="#Grib2Message.decode-759"><span class="linenos"> 759</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">anglePoleRotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-760"><a href="#Grib2Message.decode-760"><span class="linenos"> 760</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="Grib2Message.decode-761"><a href="#Grib2Message.decode-761"><span class="linenos"> 761</span></a>            <span class="c1"># Mercator</span>
</span><span id="Grib2Message.decode-762"><a href="#Grib2Message.decode-762"><span class="linenos"> 762</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-763"><a href="#Grib2Message.decode-763"><span class="linenos"> 763</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-764"><a href="#Grib2Message.decode-764"><span class="linenos"> 764</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-765"><a href="#Grib2Message.decode-765"><span class="linenos"> 765</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-766"><a href="#Grib2Message.decode-766"><span class="linenos"> 766</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e3</span>
</span><span id="Grib2Message.decode-767"><a href="#Grib2Message.decode-767"><span class="linenos"> 767</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e3</span>
</span><span id="Grib2Message.decode-768"><a href="#Grib2Message.decode-768"><span class="linenos"> 768</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-769"><a href="#Grib2Message.decode-769"><span class="linenos"> 769</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">)</span>
</span><span id="Grib2Message.decode-770"><a href="#Grib2Message.decode-770"><span class="linenos"> 770</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;merc&#39;</span>
</span><span id="Grib2Message.decode-771"><a href="#Grib2Message.decode-771"><span class="linenos"> 771</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-772"><a href="#Grib2Message.decode-772"><span class="linenos"> 772</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
</span><span id="Grib2Message.decode-773"><a href="#Grib2Message.decode-773"><span class="linenos"> 773</span></a>            <span class="c1"># Stereographic</span>
</span><span id="Grib2Message.decode-774"><a href="#Grib2Message.decode-774"><span class="linenos"> 774</span></a>            <span class="n">projflag</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message.decode-775"><a href="#Grib2Message.decode-775"><span class="linenos"> 775</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-776"><a href="#Grib2Message.decode-776"><span class="linenos"> 776</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-777"><a href="#Grib2Message.decode-777"><span class="linenos"> 777</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-778"><a href="#Grib2Message.decode-778"><span class="linenos"> 778</span></a>            <span class="k">if</span> <span class="n">projflag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.decode-779"><a href="#Grib2Message.decode-779"><span class="linenos"> 779</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="mi">90</span>
</span><span id="Grib2Message.decode-780"><a href="#Grib2Message.decode-780"><span class="linenos"> 780</span></a>            <span class="k">elif</span> <span class="n">projflag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Grib2Message.decode-781"><a href="#Grib2Message.decode-781"><span class="linenos"> 781</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
</span><span id="Grib2Message.decode-782"><a href="#Grib2Message.decode-782"><span class="linenos"> 782</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-783"><a href="#Grib2Message.decode-783"><span class="linenos"> 783</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid projection center flag = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">projflag</span><span class="p">)</span>
</span><span id="Grib2Message.decode-784"><a href="#Grib2Message.decode-784"><span class="linenos"> 784</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-785"><a href="#Grib2Message.decode-785"><span class="linenos"> 785</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-786"><a href="#Grib2Message.decode-786"><span class="linenos"> 786</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-787"><a href="#Grib2Message.decode-787"><span class="linenos"> 787</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;stere&#39;</span>
</span><span id="Grib2Message.decode-788"><a href="#Grib2Message.decode-788"><span class="linenos"> 788</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-789"><a href="#Grib2Message.decode-789"><span class="linenos"> 789</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
</span><span id="Grib2Message.decode-790"><a href="#Grib2Message.decode-790"><span class="linenos"> 790</span></a>            <span class="c1"># Lambert Conformal</span>
</span><span id="Grib2Message.decode-791"><a href="#Grib2Message.decode-791"><span class="linenos"> 791</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-792"><a href="#Grib2Message.decode-792"><span class="linenos"> 792</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-793"><a href="#Grib2Message.decode-793"><span class="linenos"> 793</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-794"><a href="#Grib2Message.decode-794"><span class="linenos"> 794</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-795"><a href="#Grib2Message.decode-795"><span class="linenos"> 795</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-796"><a href="#Grib2Message.decode-796"><span class="linenos"> 796</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-797"><a href="#Grib2Message.decode-797"><span class="linenos"> 797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-798"><a href="#Grib2Message.decode-798"><span class="linenos"> 798</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-799"><a href="#Grib2Message.decode-799"><span class="linenos"> 799</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;lcc&#39;</span>
</span><span id="Grib2Message.decode-800"><a href="#Grib2Message.decode-800"><span class="linenos"> 800</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-801"><a href="#Grib2Message.decode-801"><span class="linenos"> 801</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
</span><span id="Grib2Message.decode-802"><a href="#Grib2Message.decode-802"><span class="linenos"> 802</span></a>            <span class="c1"># Albers Equal Area</span>
</span><span id="Grib2Message.decode-803"><a href="#Grib2Message.decode-803"><span class="linenos"> 803</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-804"><a href="#Grib2Message.decode-804"><span class="linenos"> 804</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-805"><a href="#Grib2Message.decode-805"><span class="linenos"> 805</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-806"><a href="#Grib2Message.decode-806"><span class="linenos"> 806</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-807"><a href="#Grib2Message.decode-807"><span class="linenos"> 807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-808"><a href="#Grib2Message.decode-808"><span class="linenos"> 808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-809"><a href="#Grib2Message.decode-809"><span class="linenos"> 809</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-810"><a href="#Grib2Message.decode-810"><span class="linenos"> 810</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-811"><a href="#Grib2Message.decode-811"><span class="linenos"> 811</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;aea&#39;</span>
</span><span id="Grib2Message.decode-812"><a href="#Grib2Message.decode-812"><span class="linenos"> 812</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-813"><a href="#Grib2Message.decode-813"><span class="linenos"> 813</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">40</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">41</span><span class="p">:</span>
</span><span id="Grib2Message.decode-814"><a href="#Grib2Message.decode-814"><span class="linenos"> 814</span></a>            <span class="c1"># Gaussian Grid</span>
</span><span id="Grib2Message.decode-815"><a href="#Grib2Message.decode-815"><span class="linenos"> 815</span></a>            <span class="n">scalefact</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
</span><span id="Grib2Message.decode-816"><a href="#Grib2Message.decode-816"><span class="linenos"> 816</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4294967295</span><span class="p">:</span>
</span><span id="Grib2Message.decode-817"><a href="#Grib2Message.decode-817"><span class="linenos"> 817</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Grib2Message.decode-818"><a href="#Grib2Message.decode-818"><span class="linenos"> 818</span></a>            <span class="n">divisor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
</span><span id="Grib2Message.decode-819"><a href="#Grib2Message.decode-819"><span class="linenos"> 819</span></a>            <span class="k">if</span> <span class="n">scalefact</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">scalefact</span> <span class="o">=</span> <span class="mf">1.</span>
</span><span id="Grib2Message.decode-820"><a href="#Grib2Message.decode-820"><span class="linenos"> 820</span></a>            <span class="k">if</span> <span class="n">divisor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">divisor</span> <span class="o">=</span> <span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-821"><a href="#Grib2Message.decode-821"><span class="linenos"> 821</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pointsBetweenPoleAndEquator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-822"><a href="#Grib2Message.decode-822"><span class="linenos"> 822</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-823"><a href="#Grib2Message.decode-823"><span class="linenos"> 823</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-824"><a href="#Grib2Message.decode-824"><span class="linenos"> 824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-825"><a href="#Grib2Message.decode-825"><span class="linenos"> 825</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-826"><a href="#Grib2Message.decode-826"><span class="linenos"> 826</span></a>            <span class="k">if</span> <span class="n">reggrid</span><span class="p">:</span>
</span><span id="Grib2Message.decode-827"><a href="#Grib2Message.decode-827"><span class="linenos"> 827</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-828"><a href="#Grib2Message.decode-828"><span class="linenos"> 828</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">:</span>
</span><span id="Grib2Message.decode-829"><a href="#Grib2Message.decode-829"><span class="linenos"> 829</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message.decode-830"><a href="#Grib2Message.decode-830"><span class="linenos"> 830</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-831"><a href="#Grib2Message.decode-831"><span class="linenos"> 831</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">41</span><span class="p">:</span>
</span><span id="Grib2Message.decode-832"><a href="#Grib2Message.decode-832"><span class="linenos"> 832</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">latitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-833"><a href="#Grib2Message.decode-833"><span class="linenos"> 833</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">longitudeSouthernPole</span> <span class="o">=</span> <span class="n">scalefact</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">/</span><span class="n">divisor</span>
</span><span id="Grib2Message.decode-834"><a href="#Grib2Message.decode-834"><span class="linenos"> 834</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">anglePoleRotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-835"><a href="#Grib2Message.decode-835"><span class="linenos"> 835</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="Grib2Message.decode-836"><a href="#Grib2Message.decode-836"><span class="linenos"> 836</span></a>            <span class="c1"># Spectral Coefficients</span>
</span><span id="Grib2Message.decode-837"><a href="#Grib2Message.decode-837"><span class="linenos"> 837</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spectralFunctionParameters</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Grib2Message.decode-838"><a href="#Grib2Message.decode-838"><span class="linenos"> 838</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
</span><span id="Grib2Message.decode-839"><a href="#Grib2Message.decode-839"><span class="linenos"> 839</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="Grib2Message.decode-840"><a href="#Grib2Message.decode-840"><span class="linenos"> 840</span></a>            <span class="c1"># Near-sided Vertical Perspective Satellite Projection</span>
</span><span id="Grib2Message.decode-841"><a href="#Grib2Message.decode-841"><span class="linenos"> 841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-842"><a href="#Grib2Message.decode-842"><span class="linenos"> 842</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-843"><a href="#Grib2Message.decode-843"><span class="linenos"> 843</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span><span class="p">)</span>
</span><span id="Grib2Message.decode-844"><a href="#Grib2Message.decode-844"><span class="linenos"> 844</span></a>            <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
</span><span id="Grib2Message.decode-845"><a href="#Grib2Message.decode-845"><span class="linenos"> 845</span></a>            <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message.decode-846"><a href="#Grib2Message.decode-846"><span class="linenos"> 846</span></a>            <span class="c1"># if lat_0 is equator, it&#39;s a geostationary view.</span>
</span><span id="Grib2Message.decode-847"><a href="#Grib2Message.decode-847"><span class="linenos"> 847</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span> <span class="c1"># if lat_0 is equator, it&#39;s a</span>
</span><span id="Grib2Message.decode-848"><a href="#Grib2Message.decode-848"><span class="linenos"> 848</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;geos&#39;</span>
</span><span id="Grib2Message.decode-849"><a href="#Grib2Message.decode-849"><span class="linenos"> 849</span></a>            <span class="c1"># general case of &#39;near-side perspective projection&#39; (untested)</span>
</span><span id="Grib2Message.decode-850"><a href="#Grib2Message.decode-850"><span class="linenos"> 850</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-851"><a href="#Grib2Message.decode-851"><span class="linenos"> 851</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;nsper&#39;</span>
</span><span id="Grib2Message.decode-852"><a href="#Grib2Message.decode-852"><span class="linenos"> 852</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Only geostationary perspective is supported. Lat/Lon values returned by grid method may be incorrect.&#39;</span>
</span><span id="Grib2Message.decode-853"><a href="#Grib2Message.decode-853"><span class="linenos"> 853</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="Grib2Message.decode-854"><a href="#Grib2Message.decode-854"><span class="linenos"> 854</span></a>            <span class="c1"># latitude of horizon on central meridian</span>
</span><span id="Grib2Message.decode-855"><a href="#Grib2Message.decode-855"><span class="linenos"> 855</span></a>            <span class="n">lonmax</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span><span class="p">)</span>
</span><span id="Grib2Message.decode-856"><a href="#Grib2Message.decode-856"><span class="linenos"> 856</span></a>            <span class="c1"># longitude of horizon on equator</span>
</span><span id="Grib2Message.decode-857"><a href="#Grib2Message.decode-857"><span class="linenos"> 857</span></a>            <span class="n">latmax</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span><span class="p">)</span>
</span><span id="Grib2Message.decode-858"><a href="#Grib2Message.decode-858"><span class="linenos"> 858</span></a>            <span class="c1"># truncate to nearest thousandth of a degree (to make sure</span>
</span><span id="Grib2Message.decode-859"><a href="#Grib2Message.decode-859"><span class="linenos"> 859</span></a>            <span class="c1"># they aren&#39;t slightly over the horizon)</span>
</span><span id="Grib2Message.decode-860"><a href="#Grib2Message.decode-860"><span class="linenos"> 860</span></a>            <span class="n">latmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">latmax</span><span class="p">)</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-861"><a href="#Grib2Message.decode-861"><span class="linenos"> 861</span></a>            <span class="n">lonmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">lonmax</span><span class="p">)</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-862"><a href="#Grib2Message.decode-862"><span class="linenos"> 862</span></a>            <span class="c1"># h is measured from surface of earth at equator.</span>
</span><span id="Grib2Message.decode-863"><a href="#Grib2Message.decode-863"><span class="linenos"> 863</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span>
</span><span id="Grib2Message.decode-864"><a href="#Grib2Message.decode-864"><span class="linenos"> 864</span></a>            <span class="c1"># width and height of visible projection</span>
</span><span id="Grib2Message.decode-865"><a href="#Grib2Message.decode-865"><span class="linenos"> 865</span></a>            <span class="n">P</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span><span class="p">,</span>\
</span><span id="Grib2Message.decode-866"><a href="#Grib2Message.decode-866"><span class="linenos"> 866</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span><span class="p">,</span>\
</span><span id="Grib2Message.decode-867"><a href="#Grib2Message.decode-867"><span class="linenos"> 867</span></a>                            <span class="n">lat_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span><span class="p">)</span>
</span><span id="Grib2Message.decode-868"><a href="#Grib2Message.decode-868"><span class="linenos"> 868</span></a>            <span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">latmax</span><span class="p">)</span>
</span><span id="Grib2Message.decode-869"><a href="#Grib2Message.decode-869"><span class="linenos"> 869</span></a>            <span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">lonmax</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
</span><span id="Grib2Message.decode-870"><a href="#Grib2Message.decode-870"><span class="linenos"> 870</span></a>            <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span>
</span><span id="Grib2Message.decode-871"><a href="#Grib2Message.decode-871"><span class="linenos"> 871</span></a>            <span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y1</span>
</span><span id="Grib2Message.decode-872"><a href="#Grib2Message.decode-872"><span class="linenos"> 872</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="n">width</span><span class="o">/</span><span class="n">dx</span>
</span><span id="Grib2Message.decode-873"><a href="#Grib2Message.decode-873"><span class="linenos"> 873</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="n">dy</span>
</span><span id="Grib2Message.decode-874"><a href="#Grib2Message.decode-874"><span class="linenos"> 874</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-875"><a href="#Grib2Message.decode-875"><span class="linenos"> 875</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">110</span><span class="p">:</span>
</span><span id="Grib2Message.decode-876"><a href="#Grib2Message.decode-876"><span class="linenos"> 876</span></a>            <span class="c1"># Azimuthal Equidistant</span>
</span><span id="Grib2Message.decode-877"><a href="#Grib2Message.decode-877"><span class="linenos"> 877</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-878"><a href="#Grib2Message.decode-878"><span class="linenos"> 878</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="mf">1.e6</span>
</span><span id="Grib2Message.decode-879"><a href="#Grib2Message.decode-879"><span class="linenos"> 879</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-880"><a href="#Grib2Message.decode-880"><span class="linenos"> 880</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span>
</span><span id="Grib2Message.decode-881"><a href="#Grib2Message.decode-881"><span class="linenos"> 881</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span> <span class="o">=</span> <span class="s1">&#39;aeqd&#39;</span>
</span><span id="Grib2Message.decode-882"><a href="#Grib2Message.decode-882"><span class="linenos"> 882</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-883"><a href="#Grib2Message.decode-883"><span class="linenos"> 883</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
</span><span id="Grib2Message.decode-884"><a href="#Grib2Message.decode-884"><span class="linenos"> 884</span></a>            <span class="c1"># Curvilinear Orthogonal</span>
</span><span id="Grib2Message.decode-885"><a href="#Grib2Message.decode-885"><span class="linenos"> 885</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.decode-886"><a href="#Grib2Message.decode-886"><span class="linenos"> 886</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-887"><a href="#Grib2Message.decode-887"><span class="linenos"> 887</span></a>            <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unsupported Grid Definition Template Number - 3.</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message.decode-888"><a href="#Grib2Message.decode-888"><span class="linenos"> 888</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span><span id="Grib2Message.decode-889"><a href="#Grib2Message.decode-889"><span class="linenos"> 889</span></a>
</span><span id="Grib2Message.decode-890"><a href="#Grib2Message.decode-890"><span class="linenos"> 890</span></a>        <span class="c1"># -------------------------------</span>
</span><span id="Grib2Message.decode-891"><a href="#Grib2Message.decode-891"><span class="linenos"> 891</span></a>        <span class="c1"># Section 4 -- Product Definition</span>
</span><span id="Grib2Message.decode-892"><a href="#Grib2Message.decode-892"><span class="linenos"> 892</span></a>        <span class="c1"># -------------------------------</span>
</span><span id="Grib2Message.decode-893"><a href="#Grib2Message.decode-893"><span class="linenos"> 893</span></a>      
</span><span id="Grib2Message.decode-894"><a href="#Grib2Message.decode-894"><span class="linenos"> 894</span></a>        <span class="c1"># Template 4.0 - NOTE: That is these attributes apply to other templates.</span>
</span><span id="Grib2Message.decode-895"><a href="#Grib2Message.decode-895"><span class="linenos"> 895</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameterCategory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message.decode-896"><a href="#Grib2Message.decode-896"><span class="linenos"> 896</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameterNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-897"><a href="#Grib2Message.decode-897"><span class="linenos"> 897</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fullName</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">shortName</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_varinfo_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discipline</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="Grib2Message.decode-898"><a href="#Grib2Message.decode-898"><span class="linenos"> 898</span></a>                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">parameterCategory</span><span class="p">,</span>
</span><span id="Grib2Message.decode-899"><a href="#Grib2Message.decode-899"><span class="linenos"> 899</span></a>                                                                                <span class="bp">self</span><span class="o">.</span><span class="n">parameterNumber</span><span class="p">)</span>
</span><span id="Grib2Message.decode-900"><a href="#Grib2Message.decode-900"><span class="linenos"> 900</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">typeOfGeneratingProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.3&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-901"><a href="#Grib2Message.decode-901"><span class="linenos"> 901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backgroundGeneratingProcessIdentifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message.decode-902"><a href="#Grib2Message.decode-902"><span class="linenos"> 902</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generatingProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;generating_process&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-903"><a href="#Grib2Message.decode-903"><span class="linenos"> 903</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRange</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-904"><a href="#Grib2Message.decode-904"><span class="linenos"> 904</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">leadTime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
</span><span id="Grib2Message.decode-905"><a href="#Grib2Message.decode-905"><span class="linenos"> 905</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">typeOfFirstFixedSurface</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-906"><a href="#Grib2Message.decode-906"><span class="linenos"> 906</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message.decode-907"><a href="#Grib2Message.decode-907"><span class="linenos"> 907</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unitOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeOfFirstFixedSurface</span><span class="o">.</span><span class="n">definition</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-908"><a href="#Grib2Message.decode-908"><span class="linenos"> 908</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
</span><span id="Grib2Message.decode-909"><a href="#Grib2Message.decode-909"><span class="linenos"> 909</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">valueOfFirstFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfFirstFixedSurface</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfFirstFixedSurface</span><span class="p">)</span>
</span><span id="Grib2Message.decode-910"><a href="#Grib2Message.decode-910"><span class="linenos"> 910</span></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_value_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="s1">&#39;4.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-911"><a href="#Grib2Message.decode-911"><span class="linenos"> 911</span></a>        <span class="k">if</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Missing&#39;</span> <span class="ow">and</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">:</span>
</span><span id="Grib2Message.decode-912"><a href="#Grib2Message.decode-912"><span class="linenos"> 912</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-913"><a href="#Grib2Message.decode-913"><span class="linenos"> 913</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-914"><a href="#Grib2Message.decode-914"><span class="linenos"> 914</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-915"><a href="#Grib2Message.decode-915"><span class="linenos"> 915</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">valueOfSecondFixedSurface</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-916"><a href="#Grib2Message.decode-916"><span class="linenos"> 916</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-917"><a href="#Grib2Message.decode-917"><span class="linenos"> 917</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSecondFixedSurface</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-918"><a href="#Grib2Message.decode-918"><span class="linenos"> 918</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message.decode-919"><a href="#Grib2Message.decode-919"><span class="linenos"> 919</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSecondFixedSurface</span><span class="o">.</span><span class="n">definition</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-920"><a href="#Grib2Message.decode-920"><span class="linenos"> 920</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
</span><span id="Grib2Message.decode-921"><a href="#Grib2Message.decode-921"><span class="linenos"> 921</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">valueOfSecondFixedSurface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfSecondFixedSurface</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfSecondFixedSurface</span><span class="p">)</span>
</span><span id="Grib2Message.decode-922"><a href="#Grib2Message.decode-922"><span class="linenos"> 922</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_wgrib2_level_string</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">15</span><span class="p">])</span>
</span><span id="Grib2Message.decode-923"><a href="#Grib2Message.decode-923"><span class="linenos"> 923</span></a>
</span><span id="Grib2Message.decode-924"><a href="#Grib2Message.decode-924"><span class="linenos"> 924</span></a>        <span class="c1"># Template 4.1 -</span>
</span><span id="Grib2Message.decode-925"><a href="#Grib2Message.decode-925"><span class="linenos"> 925</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Grib2Message.decode-926"><a href="#Grib2Message.decode-926"><span class="linenos"> 926</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfEnsembleForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.6&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-927"><a href="#Grib2Message.decode-927"><span class="linenos"> 927</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">perturbationNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-928"><a href="#Grib2Message.decode-928"><span class="linenos"> 928</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-929"><a href="#Grib2Message.decode-929"><span class="linenos"> 929</span></a>
</span><span id="Grib2Message.decode-930"><a href="#Grib2Message.decode-930"><span class="linenos"> 930</span></a>        <span class="c1"># Template 4.2 -</span>
</span><span id="Grib2Message.decode-931"><a href="#Grib2Message.decode-931"><span class="linenos"> 931</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Grib2Message.decode-932"><a href="#Grib2Message.decode-932"><span class="linenos"> 932</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfDerivedForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.7&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-933"><a href="#Grib2Message.decode-933"><span class="linenos"> 933</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-934"><a href="#Grib2Message.decode-934"><span class="linenos"> 934</span></a>
</span><span id="Grib2Message.decode-935"><a href="#Grib2Message.decode-935"><span class="linenos"> 935</span></a>        <span class="c1"># Template 4.5 -</span>
</span><span id="Grib2Message.decode-936"><a href="#Grib2Message.decode-936"><span class="linenos"> 936</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Grib2Message.decode-937"><a href="#Grib2Message.decode-937"><span class="linenos"> 937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">forecastProbabilityNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message.decode-938"><a href="#Grib2Message.decode-938"><span class="linenos"> 938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">totalNumberOfForecastProbabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-939"><a href="#Grib2Message.decode-939"><span class="linenos"> 939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfProbability</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.9&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-940"><a href="#Grib2Message.decode-940"><span class="linenos"> 940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message.decode-941"><a href="#Grib2Message.decode-941"><span class="linenos"> 941</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message.decode-942"><a href="#Grib2Message.decode-942"><span class="linenos"> 942</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message.decode-943"><a href="#Grib2Message.decode-943"><span class="linenos"> 943</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-944"><a href="#Grib2Message.decode-944"><span class="linenos"> 944</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdLowerLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message.decode-945"><a href="#Grib2Message.decode-945"><span class="linenos"> 945</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
</span><span id="Grib2Message.decode-946"><a href="#Grib2Message.decode-946"><span class="linenos"> 946</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdUpperLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message.decode-947"><a href="#Grib2Message.decode-947"><span class="linenos"> 947</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
</span><span id="Grib2Message.decode-948"><a href="#Grib2Message.decode-948"><span class="linenos"> 948</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_wgrib2_prob_string</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
</span><span id="Grib2Message.decode-949"><a href="#Grib2Message.decode-949"><span class="linenos"> 949</span></a>
</span><span id="Grib2Message.decode-950"><a href="#Grib2Message.decode-950"><span class="linenos"> 950</span></a>        <span class="c1"># Template 4.6 -</span>
</span><span id="Grib2Message.decode-951"><a href="#Grib2Message.decode-951"><span class="linenos"> 951</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="Grib2Message.decode-952"><a href="#Grib2Message.decode-952"><span class="linenos"> 952</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">percentileValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message.decode-953"><a href="#Grib2Message.decode-953"><span class="linenos"> 953</span></a>
</span><span id="Grib2Message.decode-954"><a href="#Grib2Message.decode-954"><span class="linenos"> 954</span></a>        <span class="c1"># Template 4.8 -</span>
</span><span id="Grib2Message.decode-955"><a href="#Grib2Message.decode-955"><span class="linenos"> 955</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="Grib2Message.decode-956"><a href="#Grib2Message.decode-956"><span class="linenos"> 956</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message.decode-957"><a href="#Grib2Message.decode-957"><span class="linenos"> 957</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-958"><a href="#Grib2Message.decode-958"><span class="linenos"> 958</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-959"><a href="#Grib2Message.decode-959"><span class="linenos"> 959</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message.decode-960"><a href="#Grib2Message.decode-960"><span class="linenos"> 960</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message.decode-961"><a href="#Grib2Message.decode-961"><span class="linenos"> 961</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message.decode-962"><a href="#Grib2Message.decode-962"><span class="linenos"> 962</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-963"><a href="#Grib2Message.decode-963"><span class="linenos"> 963</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message.decode-964"><a href="#Grib2Message.decode-964"><span class="linenos"> 964</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-965"><a href="#Grib2Message.decode-965"><span class="linenos"> 965</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-966"><a href="#Grib2Message.decode-966"><span class="linenos"> 966</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-967"><a href="#Grib2Message.decode-967"><span class="linenos"> 967</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
</span><span id="Grib2Message.decode-968"><a href="#Grib2Message.decode-968"><span class="linenos"> 968</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-969"><a href="#Grib2Message.decode-969"><span class="linenos"> 969</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
</span><span id="Grib2Message.decode-970"><a href="#Grib2Message.decode-970"><span class="linenos"> 970</span></a>
</span><span id="Grib2Message.decode-971"><a href="#Grib2Message.decode-971"><span class="linenos"> 971</span></a>        <span class="c1"># Template 4.9 -</span>
</span><span id="Grib2Message.decode-972"><a href="#Grib2Message.decode-972"><span class="linenos"> 972</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
</span><span id="Grib2Message.decode-973"><a href="#Grib2Message.decode-973"><span class="linenos"> 973</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">forecastProbabilityNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message.decode-974"><a href="#Grib2Message.decode-974"><span class="linenos"> 974</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">totalNumberOfForecastProbabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-975"><a href="#Grib2Message.decode-975"><span class="linenos"> 975</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfProbability</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.9&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-976"><a href="#Grib2Message.decode-976"><span class="linenos"> 976</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message.decode-977"><a href="#Grib2Message.decode-977"><span class="linenos"> 977</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdLowerLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message.decode-978"><a href="#Grib2Message.decode-978"><span class="linenos"> 978</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactorOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message.decode-979"><a href="#Grib2Message.decode-979"><span class="linenos"> 979</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaledValueOfThresholdUpperLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-980"><a href="#Grib2Message.decode-980"><span class="linenos"> 980</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdLowerLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message.decode-981"><a href="#Grib2Message.decode-981"><span class="linenos"> 981</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
</span><span id="Grib2Message.decode-982"><a href="#Grib2Message.decode-982"><span class="linenos"> 982</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">thresholdUpperLimit</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">==</span> <span class="mi">255</span> <span class="k">else</span> \
</span><span id="Grib2Message.decode-983"><a href="#Grib2Message.decode-983"><span class="linenos"> 983</span></a>                                       <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">10.</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
</span><span id="Grib2Message.decode-984"><a href="#Grib2Message.decode-984"><span class="linenos"> 984</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_wgrib2_prob_string</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
</span><span id="Grib2Message.decode-985"><a href="#Grib2Message.decode-985"><span class="linenos"> 985</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message.decode-986"><a href="#Grib2Message.decode-986"><span class="linenos"> 986</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message.decode-987"><a href="#Grib2Message.decode-987"><span class="linenos"> 987</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
</span><span id="Grib2Message.decode-988"><a href="#Grib2Message.decode-988"><span class="linenos"> 988</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
</span><span id="Grib2Message.decode-989"><a href="#Grib2Message.decode-989"><span class="linenos"> 989</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
</span><span id="Grib2Message.decode-990"><a href="#Grib2Message.decode-990"><span class="linenos"> 990</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span>
</span><span id="Grib2Message.decode-991"><a href="#Grib2Message.decode-991"><span class="linenos"> 991</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
</span><span id="Grib2Message.decode-992"><a href="#Grib2Message.decode-992"><span class="linenos"> 992</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span>
</span><span id="Grib2Message.decode-993"><a href="#Grib2Message.decode-993"><span class="linenos"> 993</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-994"><a href="#Grib2Message.decode-994"><span class="linenos"> 994</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">31</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-995"><a href="#Grib2Message.decode-995"><span class="linenos"> 995</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-996"><a href="#Grib2Message.decode-996"><span class="linenos"> 996</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span>
</span><span id="Grib2Message.decode-997"><a href="#Grib2Message.decode-997"><span class="linenos"> 997</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">34</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-998"><a href="#Grib2Message.decode-998"><span class="linenos"> 998</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span>
</span><span id="Grib2Message.decode-999"><a href="#Grib2Message.decode-999"><span class="linenos"> 999</span></a>
</span><span id="Grib2Message.decode-1000"><a href="#Grib2Message.decode-1000"><span class="linenos">1000</span></a>        <span class="c1"># Template 4.10 -</span>
</span><span id="Grib2Message.decode-1001"><a href="#Grib2Message.decode-1001"><span class="linenos">1001</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1002"><a href="#Grib2Message.decode-1002"><span class="linenos">1002</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">percentileValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1003"><a href="#Grib2Message.decode-1003"><span class="linenos">1003</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1004"><a href="#Grib2Message.decode-1004"><span class="linenos">1004</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1005"><a href="#Grib2Message.decode-1005"><span class="linenos">1005</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1006"><a href="#Grib2Message.decode-1006"><span class="linenos">1006</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1007"><a href="#Grib2Message.decode-1007"><span class="linenos">1007</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1008"><a href="#Grib2Message.decode-1008"><span class="linenos">1008</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1009"><a href="#Grib2Message.decode-1009"><span class="linenos">1009</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1010"><a href="#Grib2Message.decode-1010"><span class="linenos">1010</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1011"><a href="#Grib2Message.decode-1011"><span class="linenos">1011</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1012"><a href="#Grib2Message.decode-1012"><span class="linenos">1012</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1013"><a href="#Grib2Message.decode-1013"><span class="linenos">1013</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1014"><a href="#Grib2Message.decode-1014"><span class="linenos">1014</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1015"><a href="#Grib2Message.decode-1015"><span class="linenos">1015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1016"><a href="#Grib2Message.decode-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1017"><a href="#Grib2Message.decode-1017"><span class="linenos">1017</span></a>
</span><span id="Grib2Message.decode-1018"><a href="#Grib2Message.decode-1018"><span class="linenos">1018</span></a>        <span class="c1"># Template 4.11 -</span>
</span><span id="Grib2Message.decode-1019"><a href="#Grib2Message.decode-1019"><span class="linenos">1019</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1020"><a href="#Grib2Message.decode-1020"><span class="linenos">1020</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfEnsembleForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.6&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1021"><a href="#Grib2Message.decode-1021"><span class="linenos">1021</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">perturbationNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1022"><a href="#Grib2Message.decode-1022"><span class="linenos">1022</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1023"><a href="#Grib2Message.decode-1023"><span class="linenos">1023</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1024"><a href="#Grib2Message.decode-1024"><span class="linenos">1024</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1025"><a href="#Grib2Message.decode-1025"><span class="linenos">1025</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1026"><a href="#Grib2Message.decode-1026"><span class="linenos">1026</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1027"><a href="#Grib2Message.decode-1027"><span class="linenos">1027</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1028"><a href="#Grib2Message.decode-1028"><span class="linenos">1028</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1029"><a href="#Grib2Message.decode-1029"><span class="linenos">1029</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1030"><a href="#Grib2Message.decode-1030"><span class="linenos">1030</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1031"><a href="#Grib2Message.decode-1031"><span class="linenos">1031</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1032"><a href="#Grib2Message.decode-1032"><span class="linenos">1032</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1033"><a href="#Grib2Message.decode-1033"><span class="linenos">1033</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1034"><a href="#Grib2Message.decode-1034"><span class="linenos">1034</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1035"><a href="#Grib2Message.decode-1035"><span class="linenos">1035</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_value_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1036"><a href="#Grib2Message.decode-1036"><span class="linenos">1036</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1037"><a href="#Grib2Message.decode-1037"><span class="linenos">1037</span></a>
</span><span id="Grib2Message.decode-1038"><a href="#Grib2Message.decode-1038"><span class="linenos">1038</span></a>        <span class="c1"># Template 4.12 -</span>
</span><span id="Grib2Message.decode-1039"><a href="#Grib2Message.decode-1039"><span class="linenos">1039</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1040"><a href="#Grib2Message.decode-1040"><span class="linenos">1040</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfDerivedForecast</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.7&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1041"><a href="#Grib2Message.decode-1041"><span class="linenos">1041</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfEnsembleForecasts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1042"><a href="#Grib2Message.decode-1042"><span class="linenos">1042</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1043"><a href="#Grib2Message.decode-1043"><span class="linenos">1043</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1044"><a href="#Grib2Message.decode-1044"><span class="linenos">1044</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1045"><a href="#Grib2Message.decode-1045"><span class="linenos">1045</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1046"><a href="#Grib2Message.decode-1046"><span class="linenos">1046</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1047"><a href="#Grib2Message.decode-1047"><span class="linenos">1047</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1048"><a href="#Grib2Message.decode-1048"><span class="linenos">1048</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfTimeRanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1049"><a href="#Grib2Message.decode-1049"><span class="linenos">1049</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfMissingValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1050"><a href="#Grib2Message.decode-1050"><span class="linenos">1050</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1051"><a href="#Grib2Message.decode-1051"><span class="linenos">1051</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfTimeIncrementOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.11&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1052"><a href="#Grib2Message.decode-1052"><span class="linenos">1052</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1053"><a href="#Grib2Message.decode-1053"><span class="linenos">1053</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeRangeOfStatisticalProcess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1054"><a href="#Grib2Message.decode-1054"><span class="linenos">1054</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unitOfTimeRangeOfSuccessiveFields</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">29</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1055"><a href="#Grib2Message.decode-1055"><span class="linenos">1055</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeIncrementOfSuccessiveFields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1056"><a href="#Grib2Message.decode-1056"><span class="linenos">1056</span></a>
</span><span id="Grib2Message.decode-1057"><a href="#Grib2Message.decode-1057"><span class="linenos">1057</span></a>        <span class="c1"># Template 4.15 -</span>
</span><span id="Grib2Message.decode-1058"><a href="#Grib2Message.decode-1058"><span class="linenos">1058</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1059"><a href="#Grib2Message.decode-1059"><span class="linenos">1059</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statisticalProcess</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.10&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1060"><a href="#Grib2Message.decode-1060"><span class="linenos">1060</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfSpatialProcessing</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;4.15&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1061"><a href="#Grib2Message.decode-1061"><span class="linenos">1061</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numberOfDataPointsForSpatialProcessing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1062"><a href="#Grib2Message.decode-1062"><span class="linenos">1062</span></a>
</span><span id="Grib2Message.decode-1063"><a href="#Grib2Message.decode-1063"><span class="linenos">1063</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1064"><a href="#Grib2Message.decode-1064"><span class="linenos">1064</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1065"><a href="#Grib2Message.decode-1065"><span class="linenos">1065</span></a>                <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unsupported Product Definition Template Number - 4.</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message.decode-1066"><a href="#Grib2Message.decode-1066"><span class="linenos">1066</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1067"><a href="#Grib2Message.decode-1067"><span class="linenos">1067</span></a>
</span><span id="Grib2Message.decode-1068"><a href="#Grib2Message.decode-1068"><span class="linenos">1068</span></a>
</span><span id="Grib2Message.decode-1069"><a href="#Grib2Message.decode-1069"><span class="linenos">1069</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">leadTime</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">getleadtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">,</span>
</span><span id="Grib2Message.decode-1070"><a href="#Grib2Message.decode-1070"><span class="linenos">1070</span></a>                                          <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="Grib2Message.decode-1071"><a href="#Grib2Message.decode-1071"><span class="linenos">1071</span></a>                                          <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplate</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1072"><a href="#Grib2Message.decode-1072"><span class="linenos">1072</span></a>
</span><span id="Grib2Message.decode-1073"><a href="#Grib2Message.decode-1073"><span class="linenos">1073</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">productDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]:</span>
</span><span id="Grib2Message.decode-1074"><a href="#Grib2Message.decode-1074"><span class="linenos">1074</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dtEndOfTimePeriod</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yearOfEndOfTimePeriod</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">monthOfEndOfTimePeriod</span><span class="p">,</span>
</span><span id="Grib2Message.decode-1075"><a href="#Grib2Message.decode-1075"><span class="linenos">1075</span></a>                                     <span class="bp">self</span><span class="o">.</span><span class="n">dayOfEndOfTimePeriod</span><span class="p">,</span><span class="n">hour</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hourOfEndOfTimePeriod</span><span class="p">,</span>
</span><span id="Grib2Message.decode-1076"><a href="#Grib2Message.decode-1076"><span class="linenos">1076</span></a>                                     <span class="n">minute</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minuteOfEndOfTimePeriod</span><span class="p">,</span>
</span><span id="Grib2Message.decode-1077"><a href="#Grib2Message.decode-1077"><span class="linenos">1077</span></a>                                     <span class="n">second</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">secondOfEndOfTimePeriod</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1078"><a href="#Grib2Message.decode-1078"><span class="linenos">1078</span></a>
</span><span id="Grib2Message.decode-1079"><a href="#Grib2Message.decode-1079"><span class="linenos">1079</span></a>        <span class="c1"># --------------------------------</span>
</span><span id="Grib2Message.decode-1080"><a href="#Grib2Message.decode-1080"><span class="linenos">1080</span></a>        <span class="c1"># Section 5 -- Data Representation</span>
</span><span id="Grib2Message.decode-1081"><a href="#Grib2Message.decode-1081"><span class="linenos">1081</span></a>        <span class="c1"># --------------------------------</span>
</span><span id="Grib2Message.decode-1082"><a href="#Grib2Message.decode-1082"><span class="linenos">1082</span></a>
</span><span id="Grib2Message.decode-1083"><a href="#Grib2Message.decode-1083"><span class="linenos">1083</span></a>        <span class="c1"># Template 5.0 - Simple Packing</span>
</span><span id="Grib2Message.decode-1084"><a href="#Grib2Message.decode-1084"><span class="linenos">1084</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1085"><a href="#Grib2Message.decode-1085"><span class="linenos">1085</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.decode-1086"><a href="#Grib2Message.decode-1086"><span class="linenos">1086</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1087"><a href="#Grib2Message.decode-1087"><span class="linenos">1087</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1088"><a href="#Grib2Message.decode-1088"><span class="linenos">1088</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1089"><a href="#Grib2Message.decode-1089"><span class="linenos">1089</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1090"><a href="#Grib2Message.decode-1090"><span class="linenos">1090</span></a>
</span><span id="Grib2Message.decode-1091"><a href="#Grib2Message.decode-1091"><span class="linenos">1091</span></a>        <span class="c1"># Template 5.2 - Complex Packing</span>
</span><span id="Grib2Message.decode-1092"><a href="#Grib2Message.decode-1092"><span class="linenos">1092</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1093"><a href="#Grib2Message.decode-1093"><span class="linenos">1093</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.decode-1094"><a href="#Grib2Message.decode-1094"><span class="linenos">1094</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1095"><a href="#Grib2Message.decode-1095"><span class="linenos">1095</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1096"><a href="#Grib2Message.decode-1096"><span class="linenos">1096</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1097"><a href="#Grib2Message.decode-1097"><span class="linenos">1097</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1098"><a href="#Grib2Message.decode-1098"><span class="linenos">1098</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupSplitMethod</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1099"><a href="#Grib2Message.decode-1099"><span class="linenos">1099</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfMissingValue</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1100"><a href="#Grib2Message.decode-1100"><span class="linenos">1100</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-1101"><a href="#Grib2Message.decode-1101"><span class="linenos">1101</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-1102"><a href="#Grib2Message.decode-1102"><span class="linenos">1102</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nGroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1103"><a href="#Grib2Message.decode-1103"><span class="linenos">1103</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1104"><a href="#Grib2Message.decode-1104"><span class="linenos">1104</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1105"><a href="#Grib2Message.decode-1105"><span class="linenos">1105</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1106"><a href="#Grib2Message.decode-1106"><span class="linenos">1106</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupLengthIncrement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1107"><a href="#Grib2Message.decode-1107"><span class="linenos">1107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lengthOfLastGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1108"><a href="#Grib2Message.decode-1108"><span class="linenos">1108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsScaledGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1109"><a href="#Grib2Message.decode-1109"><span class="linenos">1109</span></a>
</span><span id="Grib2Message.decode-1110"><a href="#Grib2Message.decode-1110"><span class="linenos">1110</span></a>        <span class="c1"># Template 5.3 - Complex Packing and Spatial Differencing</span>
</span><span id="Grib2Message.decode-1111"><a href="#Grib2Message.decode-1111"><span class="linenos">1111</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1112"><a href="#Grib2Message.decode-1112"><span class="linenos">1112</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.decode-1113"><a href="#Grib2Message.decode-1113"><span class="linenos">1113</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1114"><a href="#Grib2Message.decode-1114"><span class="linenos">1114</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1115"><a href="#Grib2Message.decode-1115"><span class="linenos">1115</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1116"><a href="#Grib2Message.decode-1116"><span class="linenos">1116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1117"><a href="#Grib2Message.decode-1117"><span class="linenos">1117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupSplitMethod</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.4&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1118"><a href="#Grib2Message.decode-1118"><span class="linenos">1118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfMissingValue</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.5&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1119"><a href="#Grib2Message.decode-1119"><span class="linenos">1119</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-1120"><a href="#Grib2Message.decode-1120"><span class="linenos">1120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secMissingValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Grib2Message.decode-1121"><a href="#Grib2Message.decode-1121"><span class="linenos">1121</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nGroups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1122"><a href="#Grib2Message.decode-1122"><span class="linenos">1122</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1123"><a href="#Grib2Message.decode-1123"><span class="linenos">1123</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsGroupWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1124"><a href="#Grib2Message.decode-1124"><span class="linenos">1124</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1125"><a href="#Grib2Message.decode-1125"><span class="linenos">1125</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">groupLengthIncrement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1126"><a href="#Grib2Message.decode-1126"><span class="linenos">1126</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lengthOfLastGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1127"><a href="#Grib2Message.decode-1127"><span class="linenos">1127</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsScaledGroupLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1128"><a href="#Grib2Message.decode-1128"><span class="linenos">1128</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spatialDifferenceOrder</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.6&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1129"><a href="#Grib2Message.decode-1129"><span class="linenos">1129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBytesSpatialDifference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1130"><a href="#Grib2Message.decode-1130"><span class="linenos">1130</span></a>
</span><span id="Grib2Message.decode-1131"><a href="#Grib2Message.decode-1131"><span class="linenos">1131</span></a>        <span class="c1"># Template 5.4 - IEEE Floating Point Data</span>
</span><span id="Grib2Message.decode-1132"><a href="#Grib2Message.decode-1132"><span class="linenos">1132</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1133"><a href="#Grib2Message.decode-1133"><span class="linenos">1133</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.7&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1134"><a href="#Grib2Message.decode-1134"><span class="linenos">1134</span></a>
</span><span id="Grib2Message.decode-1135"><a href="#Grib2Message.decode-1135"><span class="linenos">1135</span></a>        <span class="c1"># Template 5.40 - JPEG2000 Compression</span>
</span><span id="Grib2Message.decode-1136"><a href="#Grib2Message.decode-1136"><span class="linenos">1136</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1137"><a href="#Grib2Message.decode-1137"><span class="linenos">1137</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.decode-1138"><a href="#Grib2Message.decode-1138"><span class="linenos">1138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1139"><a href="#Grib2Message.decode-1139"><span class="linenos">1139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1140"><a href="#Grib2Message.decode-1140"><span class="linenos">1140</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1141"><a href="#Grib2Message.decode-1141"><span class="linenos">1141</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1142"><a href="#Grib2Message.decode-1142"><span class="linenos">1142</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfCompression</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.40&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1143"><a href="#Grib2Message.decode-1143"><span class="linenos">1143</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">targetCompressionRatio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1144"><a href="#Grib2Message.decode-1144"><span class="linenos">1144</span></a>
</span><span id="Grib2Message.decode-1145"><a href="#Grib2Message.decode-1145"><span class="linenos">1145</span></a>        <span class="c1"># Template 5.41 - PNG Compression</span>
</span><span id="Grib2Message.decode-1146"><a href="#Grib2Message.decode-1146"><span class="linenos">1146</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="o">==</span> <span class="mi">41</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1147"><a href="#Grib2Message.decode-1147"><span class="linenos">1147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refValue</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_int_to_float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Grib2Message.decode-1148"><a href="#Grib2Message.decode-1148"><span class="linenos">1148</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1149"><a href="#Grib2Message.decode-1149"><span class="linenos">1149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decScaleFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1150"><a href="#Grib2Message.decode-1150"><span class="linenos">1150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nBitsPacking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="Grib2Message.decode-1151"><a href="#Grib2Message.decode-1151"><span class="linenos">1151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">=</span> <span class="n">Grib2Metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">table</span><span class="o">=</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.decode-1152"><a href="#Grib2Message.decode-1152"><span class="linenos">1152</span></a>
</span><span id="Grib2Message.decode-1153"><a href="#Grib2Message.decode-1153"><span class="linenos">1153</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.decode-1154"><a href="#Grib2Message.decode-1154"><span class="linenos">1154</span></a>            <span class="n">errmsg</span> <span class="o">=</span> <span class="s1">&#39;Unsupported Data Representation Definition Template Number - 5.</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message.decode-1155"><a href="#Grib2Message.decode-1155"><span class="linenos">1155</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Decode the unpacked GRIB2 integer-coded metadata in human-readable form and linked to GRIB2 tables.</p>
</div>


                            </div>
                            <div id="Grib2Message.data" class="classattr">
                                        <input id="Grib2Message.data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">data</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">fill_value</span><span class="o">=</span><span class="mf">9.969209968386869e+36</span>,</span><span class="param">	<span class="n">masked_array</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">expand</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">order</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">map_keys</span><span class="o">=</span><span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.data-1158"><a href="#Grib2Message.data-1158"><span class="linenos">1158</span></a>    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">DEFAULT_FILL_VALUE</span><span class="p">,</span> <span class="n">masked_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Grib2Message.data-1159"><a href="#Grib2Message.data-1159"><span class="linenos">1159</span></a>             <span class="n">map_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Grib2Message.data-1160"><a href="#Grib2Message.data-1160"><span class="linenos">1160</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.data-1161"><a href="#Grib2Message.data-1161"><span class="linenos">1161</span></a><span class="sd">        Returns an unpacked data grid.</span>
</span><span id="Grib2Message.data-1162"><a href="#Grib2Message.data-1162"><span class="linenos">1162</span></a>
</span><span id="Grib2Message.data-1163"><a href="#Grib2Message.data-1163"><span class="linenos">1163</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message.data-1164"><a href="#Grib2Message.data-1164"><span class="linenos">1164</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message.data-1165"><a href="#Grib2Message.data-1165"><span class="linenos">1165</span></a>
</span><span id="Grib2Message.data-1166"><a href="#Grib2Message.data-1166"><span class="linenos">1166</span></a><span class="sd">        **`fill_value`**: Missing or masked data is filled with this value or default value given by</span>
</span><span id="Grib2Message.data-1167"><a href="#Grib2Message.data-1167"><span class="linenos">1167</span></a><span class="sd">        `DEFAULT_FILL_VALUE`</span>
</span><span id="Grib2Message.data-1168"><a href="#Grib2Message.data-1168"><span class="linenos">1168</span></a>
</span><span id="Grib2Message.data-1169"><a href="#Grib2Message.data-1169"><span class="linenos">1169</span></a><span class="sd">        **`masked_array`**: If `True` [DEFAULT], return masked array if there is bitmap for missing </span>
</span><span id="Grib2Message.data-1170"><a href="#Grib2Message.data-1170"><span class="linenos">1170</span></a><span class="sd">        or masked data.</span>
</span><span id="Grib2Message.data-1171"><a href="#Grib2Message.data-1171"><span class="linenos">1171</span></a>
</span><span id="Grib2Message.data-1172"><a href="#Grib2Message.data-1172"><span class="linenos">1172</span></a><span class="sd">        **`expand`**: If `True` [DEFAULT], Reduced Gaussian grids are expanded to regular Gaussian grids.</span>
</span><span id="Grib2Message.data-1173"><a href="#Grib2Message.data-1173"><span class="linenos">1173</span></a>
</span><span id="Grib2Message.data-1174"><a href="#Grib2Message.data-1174"><span class="linenos">1174</span></a><span class="sd">        **`order`**: If 0 [DEFAULT], nearest neighbor interpolation is used if grid has missing </span>
</span><span id="Grib2Message.data-1175"><a href="#Grib2Message.data-1175"><span class="linenos">1175</span></a><span class="sd">        or bitmapped values. If 1, linear interpolation is used for expanding reduced Gaussian grids.</span>
</span><span id="Grib2Message.data-1176"><a href="#Grib2Message.data-1176"><span class="linenos">1176</span></a>
</span><span id="Grib2Message.data-1177"><a href="#Grib2Message.data-1177"><span class="linenos">1177</span></a><span class="sd">        **`map_keys`**: If `True`, data values will be mapped to the string-based keys that are stored</span>
</span><span id="Grib2Message.data-1178"><a href="#Grib2Message.data-1178"><span class="linenos">1178</span></a><span class="sd">        in the Local Use Section (section 2) of the GRIB2 Message or in a code table as specified in the</span>
</span><span id="Grib2Message.data-1179"><a href="#Grib2Message.data-1179"><span class="linenos">1179</span></a><span class="sd">        units (i.e. &quot;See Table 4.xxx&quot;).</span>
</span><span id="Grib2Message.data-1180"><a href="#Grib2Message.data-1180"><span class="linenos">1180</span></a>
</span><span id="Grib2Message.data-1181"><a href="#Grib2Message.data-1181"><span class="linenos">1181</span></a><span class="sd">        Returns</span>
</span><span id="Grib2Message.data-1182"><a href="#Grib2Message.data-1182"><span class="linenos">1182</span></a><span class="sd">        -------</span>
</span><span id="Grib2Message.data-1183"><a href="#Grib2Message.data-1183"><span class="linenos">1183</span></a>
</span><span id="Grib2Message.data-1184"><a href="#Grib2Message.data-1184"><span class="linenos">1184</span></a><span class="sd">        **`numpy.ndarray`**: A numpy.ndarray with shape (ny,nx). By default the array dtype=np.float32, </span>
</span><span id="Grib2Message.data-1185"><a href="#Grib2Message.data-1185"><span class="linenos">1185</span></a><span class="sd">        but could be np.int32 if Grib2Message.typeOfValues is integer.  The array dtype will be </span>
</span><span id="Grib2Message.data-1186"><a href="#Grib2Message.data-1186"><span class="linenos">1186</span></a><span class="sd">        string-based if map_keys=True.</span>
</span><span id="Grib2Message.data-1187"><a href="#Grib2Message.data-1187"><span class="linenos">1187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.data-1188"><a href="#Grib2Message.data-1188"><span class="linenos">1188</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;scanModeFlags&#39;</span><span class="p">):</span>
</span><span id="Grib2Message.data-1189"><a href="#Grib2Message.data-1189"><span class="linenos">1189</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unsupported grid definition template number </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="p">)</span>
</span><span id="Grib2Message.data-1190"><a href="#Grib2Message.data-1190"><span class="linenos">1190</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1191"><a href="#Grib2Message.data-1191"><span class="linenos">1191</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
</span><span id="Grib2Message.data-1192"><a href="#Grib2Message.data-1192"><span class="linenos">1192</span></a>                <span class="n">storageorder</span><span class="o">=</span><span class="s1">&#39;F&#39;</span>
</span><span id="Grib2Message.data-1193"><a href="#Grib2Message.data-1193"><span class="linenos">1193</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1194"><a href="#Grib2Message.data-1194"><span class="linenos">1194</span></a>                <span class="n">storageorder</span><span class="o">=</span><span class="s1">&#39;C&#39;</span>
</span><span id="Grib2Message.data-1195"><a href="#Grib2Message.data-1195"><span class="linenos">1195</span></a>        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.data-1196"><a href="#Grib2Message.data-1196"><span class="linenos">1196</span></a>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span>
</span><span id="Grib2Message.data-1197"><a href="#Grib2Message.data-1197"><span class="linenos">1197</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.data-1198"><a href="#Grib2Message.data-1198"><span class="linenos">1198</span></a>                <span class="n">order</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message.data-1199"><a href="#Grib2Message.data-1199"><span class="linenos">1199</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1200"><a href="#Grib2Message.data-1200"><span class="linenos">1200</span></a>                <span class="n">order</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Grib2Message.data-1201"><a href="#Grib2Message.data-1201"><span class="linenos">1201</span></a>        <span class="n">drtnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message.data-1202"><a href="#Grib2Message.data-1202"><span class="linenos">1202</span></a>        <span class="n">drtmpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRepresentationTemplate</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message.data-1203"><a href="#Grib2Message.data-1203"><span class="linenos">1203</span></a>        <span class="n">gdtnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Message.data-1204"><a href="#Grib2Message.data-1204"><span class="linenos">1204</span></a>        <span class="n">gdtmpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message.data-1205"><a href="#Grib2Message.data-1205"><span class="linenos">1205</span></a>        <span class="n">ndpts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfDataPoints</span>
</span><span id="Grib2Message.data-1206"><a href="#Grib2Message.data-1206"><span class="linenos">1206</span></a>        <span class="n">gds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span>
</span><span id="Grib2Message.data-1207"><a href="#Grib2Message.data-1207"><span class="linenos">1207</span></a>        <span class="n">ngrdpts</span> <span class="o">=</span> <span class="n">gds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.data-1208"><a href="#Grib2Message.data-1208"><span class="linenos">1208</span></a>        <span class="n">ipos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datapos</span>
</span><span id="Grib2Message.data-1209"><a href="#Grib2Message.data-1209"><span class="linenos">1209</span></a>        <span class="n">fld1</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">unpack7</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="n">gdtnum</span><span class="p">,</span><span class="n">gdtmpl</span><span class="p">,</span><span class="n">drtnum</span><span class="p">,</span><span class="n">drtmpl</span><span class="p">,</span><span class="n">ndpts</span><span class="p">,</span><span class="n">ipos</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span><span class="n">storageorder</span><span class="o">=</span><span class="n">storageorder</span><span class="p">)</span>
</span><span id="Grib2Message.data-1210"><a href="#Grib2Message.data-1210"><span class="linenos">1210</span></a>        <span class="c1"># Apply bitmap.</span>
</span><span id="Grib2Message.data-1211"><a href="#Grib2Message.data-1211"><span class="linenos">1211</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bitMapFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.data-1212"><a href="#Grib2Message.data-1212"><span class="linenos">1212</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">fill_value</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ngrdpts</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.data-1213"><a href="#Grib2Message.data-1213"><span class="linenos">1213</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bitMap</span><span class="p">),</span><span class="n">fld1</span><span class="p">)</span>
</span><span id="Grib2Message.data-1214"><a href="#Grib2Message.data-1214"><span class="linenos">1214</span></a>            <span class="k">if</span> <span class="n">masked_array</span><span class="p">:</span>
</span><span id="Grib2Message.data-1215"><a href="#Grib2Message.data-1215"><span class="linenos">1215</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_values</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message.data-1216"><a href="#Grib2Message.data-1216"><span class="linenos">1216</span></a>        <span class="c1"># Missing values instead of bitmap</span>
</span><span id="Grib2Message.data-1217"><a href="#Grib2Message.data-1217"><span class="linenos">1217</span></a>        <span class="k">elif</span> <span class="n">masked_array</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;priMissingValue&#39;</span><span class="p">):</span>
</span><span id="Grib2Message.data-1218"><a href="#Grib2Message.data-1218"><span class="linenos">1218</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;secMissingValue&#39;</span><span class="p">):</span>
</span><span id="Grib2Message.data-1219"><a href="#Grib2Message.data-1219"><span class="linenos">1219</span></a>                <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">fld1</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span><span class="p">,</span><span class="n">fld1</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">secMissingValue</span><span class="p">)</span>
</span><span id="Grib2Message.data-1220"><a href="#Grib2Message.data-1220"><span class="linenos">1220</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1221"><a href="#Grib2Message.data-1221"><span class="linenos">1221</span></a>                <span class="n">mask</span> <span class="o">=</span> <span class="n">fld1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">priMissingValue</span>
</span><span id="Grib2Message.data-1222"><a href="#Grib2Message.data-1222"><span class="linenos">1222</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fld1</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span><span id="Grib2Message.data-1223"><a href="#Grib2Message.data-1223"><span class="linenos">1223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1224"><a href="#Grib2Message.data-1224"><span class="linenos">1224</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">fld1</span>
</span><span id="Grib2Message.data-1225"><a href="#Grib2Message.data-1225"><span class="linenos">1225</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Rectangular grid.</span>
</span><span id="Grib2Message.data-1226"><a href="#Grib2Message.data-1226"><span class="linenos">1226</span></a>            <span class="k">if</span> <span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">fld</span><span class="p">):</span>
</span><span id="Grib2Message.data-1227"><a href="#Grib2Message.data-1227"><span class="linenos">1227</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fld</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>
</span><span id="Grib2Message.data-1228"><a href="#Grib2Message.data-1228"><span class="linenos">1228</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1229"><a href="#Grib2Message.data-1229"><span class="linenos">1229</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fld</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">))</span>
</span><span id="Grib2Message.data-1230"><a href="#Grib2Message.data-1230"><span class="linenos">1230</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1231"><a href="#Grib2Message.data-1231"><span class="linenos">1231</span></a>            <span class="k">if</span> <span class="n">gds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span> <span class="c1"># Reduced global Gaussian grid.</span>
</span><span id="Grib2Message.data-1232"><a href="#Grib2Message.data-1232"><span class="linenos">1232</span></a>                <span class="k">if</span> <span class="n">expand</span><span class="p">:</span>
</span><span id="Grib2Message.data-1233"><a href="#Grib2Message.data-1233"><span class="linenos">1233</span></a>                    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">redtoreg</span>
</span><span id="Grib2Message.data-1234"><a href="#Grib2Message.data-1234"><span class="linenos">1234</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Grib2Message.data-1235"><a href="#Grib2Message.data-1235"><span class="linenos">1235</span></a>                    <span class="n">lonsperlat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defList</span>
</span><span id="Grib2Message.data-1236"><a href="#Grib2Message.data-1236"><span class="linenos">1236</span></a>                    <span class="k">if</span> <span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">fld</span><span class="p">):</span>
</span><span id="Grib2Message.data-1237"><a href="#Grib2Message.data-1237"><span class="linenos">1237</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message.data-1238"><a href="#Grib2Message.data-1238"><span class="linenos">1238</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">redtoreg</span><span class="o">.</span><span class="n">_redtoreg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span><span class="n">lonsperlat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">long</span><span class="p">),</span>
</span><span id="Grib2Message.data-1239"><a href="#Grib2Message.data-1239"><span class="linenos">1239</span></a>                                                 <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message.data-1240"><a href="#Grib2Message.data-1240"><span class="linenos">1240</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_values</span><span class="p">(</span><span class="n">fld</span><span class="p">,</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message.data-1241"><a href="#Grib2Message.data-1241"><span class="linenos">1241</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1242"><a href="#Grib2Message.data-1242"><span class="linenos">1242</span></a>                        <span class="n">fld</span> <span class="o">=</span> <span class="n">redtoreg</span><span class="o">.</span><span class="n">_redtoreg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span><span class="n">lonsperlat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">long</span><span class="p">),</span>
</span><span id="Grib2Message.data-1243"><a href="#Grib2Message.data-1243"><span class="linenos">1243</span></a>                                                 <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span><span class="n">fill_value</span><span class="p">)</span>
</span><span id="Grib2Message.data-1244"><a href="#Grib2Message.data-1244"><span class="linenos">1244</span></a>        <span class="c1"># Check scan modes for rect grids.</span>
</span><span id="Grib2Message.data-1245"><a href="#Grib2Message.data-1245"><span class="linenos">1245</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.data-1246"><a href="#Grib2Message.data-1246"><span class="linenos">1246</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
</span><span id="Grib2Message.data-1247"><a href="#Grib2Message.data-1247"><span class="linenos">1247</span></a>                <span class="n">fldsave</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="c1"># casting makes a copy</span>
</span><span id="Grib2Message.data-1248"><a href="#Grib2Message.data-1248"><span class="linenos">1248</span></a>                <span class="n">fld</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">fldsave</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.data-1249"><a href="#Grib2Message.data-1249"><span class="linenos">1249</span></a>
</span><span id="Grib2Message.data-1250"><a href="#Grib2Message.data-1250"><span class="linenos">1250</span></a>        <span class="c1"># Set data to integer according to GRIB metadata</span>
</span><span id="Grib2Message.data-1251"><a href="#Grib2Message.data-1251"><span class="linenos">1251</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeOfValues</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">fld</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="Grib2Message.data-1252"><a href="#Grib2Message.data-1252"><span class="linenos">1252</span></a>
</span><span id="Grib2Message.data-1253"><a href="#Grib2Message.data-1253"><span class="linenos">1253</span></a>        <span class="c1"># Map the data values to their respective definitions.</span>
</span><span id="Grib2Message.data-1254"><a href="#Grib2Message.data-1254"><span class="linenos">1254</span></a>        <span class="k">if</span> <span class="n">map_keys</span><span class="p">:</span>
</span><span id="Grib2Message.data-1255"><a href="#Grib2Message.data-1255"><span class="linenos">1255</span></a>            <span class="n">fld</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span id="Grib2Message.data-1256"><a href="#Grib2Message.data-1256"><span class="linenos">1256</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span> <span class="ow">and</span> \
</span><span id="Grib2Message.data-1257"><a href="#Grib2Message.data-1257"><span class="linenos">1257</span></a>               <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">and</span> \
</span><span id="Grib2Message.data-1258"><a href="#Grib2Message.data-1258"><span class="linenos">1258</span></a>               <span class="bp">self</span><span class="o">.</span><span class="n">shortName</span> <span class="o">==</span> <span class="s1">&#39;PWTHER&#39;</span><span class="p">:</span>
</span><span id="Grib2Message.data-1259"><a href="#Grib2Message.data-1259"><span class="linenos">1259</span></a>                <span class="c1"># MDL Predominant Weather Grid</span>
</span><span id="Grib2Message.data-1260"><a href="#Grib2Message.data-1260"><span class="linenos">1260</span></a>                <span class="n">keys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">decode_ndfd_wx_strings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lus</span><span class="p">)</span>
</span><span id="Grib2Message.data-1261"><a href="#Grib2Message.data-1261"><span class="linenos">1261</span></a>                <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
</span><span id="Grib2Message.data-1262"><a href="#Grib2Message.data-1262"><span class="linenos">1262</span></a>                    <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fld</span><span class="o">==</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message.data-1263"><a href="#Grib2Message.data-1263"><span class="linenos">1263</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">and</span> \
</span><span id="Grib2Message.data-1264"><a href="#Grib2Message.data-1264"><span class="linenos">1264</span></a>                 <span class="bp">self</span><span class="o">.</span><span class="n">identificationSection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">65535</span> <span class="ow">and</span> \
</span><span id="Grib2Message.data-1265"><a href="#Grib2Message.data-1265"><span class="linenos">1265</span></a>                 <span class="bp">self</span><span class="o">.</span><span class="n">shortName</span> <span class="o">==</span> <span class="s1">&#39;CRAIN&#39;</span><span class="p">:</span>
</span><span id="Grib2Message.data-1266"><a href="#Grib2Message.data-1266"><span class="linenos">1266</span></a>                <span class="c1"># NDFD Predominant Weather Grid</span>
</span><span id="Grib2Message.data-1267"><a href="#Grib2Message.data-1267"><span class="linenos">1267</span></a>                <span class="n">keys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">decode_ndfd_wx_strings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lus</span><span class="p">)</span>
</span><span id="Grib2Message.data-1268"><a href="#Grib2Message.data-1268"><span class="linenos">1268</span></a>                <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
</span><span id="Grib2Message.data-1269"><a href="#Grib2Message.data-1269"><span class="linenos">1269</span></a>                    <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fld</span><span class="o">==</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message.data-1270"><a href="#Grib2Message.data-1270"><span class="linenos">1270</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.data-1271"><a href="#Grib2Message.data-1271"><span class="linenos">1271</span></a>                <span class="c1"># For data whose units are defined in a code table</span>
</span><span id="Grib2Message.data-1272"><a href="#Grib2Message.data-1272"><span class="linenos">1272</span></a>                <span class="n">tbl</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d\.\d+&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Grib2Message.data-1273"><a href="#Grib2Message.data-1273"><span class="linenos">1273</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Grib2Message.data-1274"><a href="#Grib2Message.data-1274"><span class="linenos">1274</span></a>                    <span class="n">fld</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fld</span><span class="o">==</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">fld</span><span class="p">)</span>
</span><span id="Grib2Message.data-1275"><a href="#Grib2Message.data-1275"><span class="linenos">1275</span></a>        <span class="k">return</span> <span class="n">fld</span>
</span></pre></div>


            <div class="docstring"><p>Returns an unpacked data grid.</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>fill_value</code></strong>: Missing or masked data is filled with this value or default value given by
<code>DEFAULT_FILL_VALUE</code></p>

<p><strong><code>masked_array</code></strong>: If <code>True</code> [DEFAULT], return masked array if there is bitmap for missing 
or masked data.</p>

<p><strong><code>expand</code></strong>: If <code>True</code> [DEFAULT], Reduced Gaussian grids are expanded to regular Gaussian grids.</p>

<p><strong><code>order</code></strong>: If 0 [DEFAULT], nearest neighbor interpolation is used if grid has missing 
or bitmapped values. If 1, linear interpolation is used for expanding reduced Gaussian grids.</p>

<p><strong><code>map_keys</code></strong>: If <code>True</code>, data values will be mapped to the string-based keys that are stored
in the Local Use Section (section 2) of the GRIB2 Message or in a code table as specified in the
units (i.e. "See Table 4.xxx").</p>

<h2 id="returns">Returns</h2>

<p><strong><code>numpy.ndarray</code></strong>: A numpy.ndarray with shape (ny,nx). By default the array dtype=np.float32, 
but could be np.int32 if Grib2Message.typeOfValues is integer.  The array dtype will be 
string-based if map_keys=True.</p>
</div>


                            </div>
                            <div id="Grib2Message.latlons" class="classattr">
                                        <input id="Grib2Message.latlons-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">latlons</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.latlons-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.latlons"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.latlons-1278"><a href="#Grib2Message.latlons-1278"><span class="linenos">1278</span></a>    <span class="k">def</span> <span class="nf">latlons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message.latlons-1279"><a href="#Grib2Message.latlons-1279"><span class="linenos">1279</span></a>        <span class="sd">&quot;&quot;&quot;Alias for `grib2io.Grib2Message.grid` method&quot;&quot;&quot;</span>
</span><span id="Grib2Message.latlons-1280"><a href="#Grib2Message.latlons-1280"><span class="linenos">1280</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Alias for <code><a href="#Grib2Message.grid">grib2io.Grib2Message.grid</a></code> method</p>
</div>


                            </div>
                            <div id="Grib2Message.grid" class="classattr">
                                        <input id="Grib2Message.grid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">grid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.grid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.grid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.grid-1283"><a href="#Grib2Message.grid-1283"><span class="linenos">1283</span></a>    <span class="k">def</span> <span class="nf">grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message.grid-1284"><a href="#Grib2Message.grid-1284"><span class="linenos">1284</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.grid-1285"><a href="#Grib2Message.grid-1285"><span class="linenos">1285</span></a><span class="sd">        Return lats,lons (in degrees) of grid. Currently can handle reg. lat/lon, </span>
</span><span id="Grib2Message.grid-1286"><a href="#Grib2Message.grid-1286"><span class="linenos">1286</span></a><span class="sd">        global Gaussian, mercator, stereographic, lambert conformal, albers equal-area, </span>
</span><span id="Grib2Message.grid-1287"><a href="#Grib2Message.grid-1287"><span class="linenos">1287</span></a><span class="sd">        space-view and azimuthal equidistant grids.</span>
</span><span id="Grib2Message.grid-1288"><a href="#Grib2Message.grid-1288"><span class="linenos">1288</span></a>
</span><span id="Grib2Message.grid-1289"><a href="#Grib2Message.grid-1289"><span class="linenos">1289</span></a><span class="sd">        Returns</span>
</span><span id="Grib2Message.grid-1290"><a href="#Grib2Message.grid-1290"><span class="linenos">1290</span></a><span class="sd">        -------</span>
</span><span id="Grib2Message.grid-1291"><a href="#Grib2Message.grid-1291"><span class="linenos">1291</span></a>
</span><span id="Grib2Message.grid-1292"><a href="#Grib2Message.grid-1292"><span class="linenos">1292</span></a><span class="sd">        **`lats, lons : numpy.ndarray`**</span>
</span><span id="Grib2Message.grid-1293"><a href="#Grib2Message.grid-1293"><span class="linenos">1293</span></a>
</span><span id="Grib2Message.grid-1294"><a href="#Grib2Message.grid-1294"><span class="linenos">1294</span></a><span class="sd">        Returns two numpy.ndarrays with dtype=numpy.float32 of grid latitudes and</span>
</span><span id="Grib2Message.grid-1295"><a href="#Grib2Message.grid-1295"><span class="linenos">1295</span></a><span class="sd">        longitudes in units of degrees.</span>
</span><span id="Grib2Message.grid-1296"><a href="#Grib2Message.grid-1296"><span class="linenos">1296</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.grid-1297"><a href="#Grib2Message.grid-1297"><span class="linenos">1297</span></a>        <span class="n">gdtnum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplateNumber</span>
</span><span id="Grib2Message.grid-1298"><a href="#Grib2Message.grid-1298"><span class="linenos">1298</span></a>        <span class="n">gdtmpl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionTemplate</span>
</span><span id="Grib2Message.grid-1299"><a href="#Grib2Message.grid-1299"><span class="linenos">1299</span></a>        <span class="n">reggrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridDefinitionSection</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1"># This means regular 2-d grid</span>
</span><span id="Grib2Message.grid-1300"><a href="#Grib2Message.grid-1300"><span class="linenos">1300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Grib2Message.grid-1301"><a href="#Grib2Message.grid-1301"><span class="linenos">1301</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span>
</span><span id="Grib2Message.grid-1302"><a href="#Grib2Message.grid-1302"><span class="linenos">1302</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">earthMajorAxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">earthMinorAxis</span>
</span><span id="Grib2Message.grid-1303"><a href="#Grib2Message.grid-1303"><span class="linenos">1303</span></a>        <span class="k">if</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.grid-1304"><a href="#Grib2Message.grid-1304"><span class="linenos">1304</span></a>            <span class="c1"># Regular lat/lon grid</span>
</span><span id="Grib2Message.grid-1305"><a href="#Grib2Message.grid-1305"><span class="linenos">1305</span></a>            <span class="n">lon1</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span>
</span><span id="Grib2Message.grid-1306"><a href="#Grib2Message.grid-1306"><span class="linenos">1306</span></a>            <span class="n">lon2</span><span class="p">,</span> <span class="n">lat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span>
</span><span id="Grib2Message.grid-1307"><a href="#Grib2Message.grid-1307"><span class="linenos">1307</span></a>            <span class="n">dlon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message.grid-1308"><a href="#Grib2Message.grid-1308"><span class="linenos">1308</span></a>            <span class="n">dlat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message.grid-1309"><a href="#Grib2Message.grid-1309"><span class="linenos">1309</span></a>            <span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span><span class="n">lat2</span><span class="o">+</span><span class="n">dlat</span><span class="p">,</span><span class="n">dlat</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1310"><a href="#Grib2Message.grid-1310"><span class="linenos">1310</span></a>            <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="o">+</span><span class="n">dlon</span><span class="p">,</span><span class="n">dlon</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1311"><a href="#Grib2Message.grid-1311"><span class="linenos">1311</span></a>            <span class="c1"># flip if scan mode says to.</span>
</span><span id="Grib2Message.grid-1312"><a href="#Grib2Message.grid-1312"><span class="linenos">1312</span></a>            <span class="c1">#if self.scanModeFlags[0]:</span>
</span><span id="Grib2Message.grid-1313"><a href="#Grib2Message.grid-1313"><span class="linenos">1313</span></a>            <span class="c1">#    lons = lons[::-1]</span>
</span><span id="Grib2Message.grid-1314"><a href="#Grib2Message.grid-1314"><span class="linenos">1314</span></a>            <span class="c1">#if not self.scanModeFlags[1]:</span>
</span><span id="Grib2Message.grid-1315"><a href="#Grib2Message.grid-1315"><span class="linenos">1315</span></a>            <span class="c1">#    lats = lats[::-1]</span>
</span><span id="Grib2Message.grid-1316"><a href="#Grib2Message.grid-1316"><span class="linenos">1316</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cyl&#39;</span>
</span><span id="Grib2Message.grid-1317"><a href="#Grib2Message.grid-1317"><span class="linenos">1317</span></a>            <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">)</span> <span class="c1"># make 2-d arrays.</span>
</span><span id="Grib2Message.grid-1318"><a href="#Grib2Message.grid-1318"><span class="linenos">1318</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">40</span><span class="p">:</span> <span class="c1"># Gaussian grid (only works for global!)</span>
</span><span id="Grib2Message.grid-1319"><a href="#Grib2Message.grid-1319"><span class="linenos">1319</span></a>            <span class="kn">from</span> <span class="nn">utils.gauss_grids</span> <span class="kn">import</span> <span class="n">gaussian_latitudes</span>
</span><span id="Grib2Message.grid-1320"><a href="#Grib2Message.grid-1320"><span class="linenos">1320</span></a>            <span class="n">lon1</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span>
</span><span id="Grib2Message.grid-1321"><a href="#Grib2Message.grid-1321"><span class="linenos">1321</span></a>            <span class="n">lon2</span><span class="p">,</span> <span class="n">lat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeLastGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeLastGridpoint</span>
</span><span id="Grib2Message.grid-1322"><a href="#Grib2Message.grid-1322"><span class="linenos">1322</span></a>            <span class="n">nlats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span>
</span><span id="Grib2Message.grid-1323"><a href="#Grib2Message.grid-1323"><span class="linenos">1323</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">reggrid</span><span class="p">:</span> <span class="c1"># Reduced Gaussian grid.</span>
</span><span id="Grib2Message.grid-1324"><a href="#Grib2Message.grid-1324"><span class="linenos">1324</span></a>                <span class="n">nlons</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nlats</span>
</span><span id="Grib2Message.grid-1325"><a href="#Grib2Message.grid-1325"><span class="linenos">1325</span></a>                <span class="n">dlon</span> <span class="o">=</span> <span class="mf">360.</span><span class="o">/</span><span class="n">nlons</span>
</span><span id="Grib2Message.grid-1326"><a href="#Grib2Message.grid-1326"><span class="linenos">1326</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.grid-1327"><a href="#Grib2Message.grid-1327"><span class="linenos">1327</span></a>                <span class="n">nlons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span>
</span><span id="Grib2Message.grid-1328"><a href="#Grib2Message.grid-1328"><span class="linenos">1328</span></a>                <span class="n">dlon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message.grid-1329"><a href="#Grib2Message.grid-1329"><span class="linenos">1329</span></a>            <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lon2</span><span class="o">+</span><span class="n">dlon</span><span class="p">,</span><span class="n">dlon</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1330"><a href="#Grib2Message.grid-1330"><span class="linenos">1330</span></a>            <span class="c1"># Compute Gaussian lats (north to south)</span>
</span><span id="Grib2Message.grid-1331"><a href="#Grib2Message.grid-1331"><span class="linenos">1331</span></a>            <span class="n">lats</span> <span class="o">=</span> <span class="n">gaussian_latitudes</span><span class="p">(</span><span class="n">nlats</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1332"><a href="#Grib2Message.grid-1332"><span class="linenos">1332</span></a>            <span class="k">if</span> <span class="n">lat1</span> <span class="o">&lt;</span> <span class="n">lat2</span><span class="p">:</span>  <span class="c1"># reverse them if necessary</span>
</span><span id="Grib2Message.grid-1333"><a href="#Grib2Message.grid-1333"><span class="linenos">1333</span></a>                <span class="n">lats</span> <span class="o">=</span> <span class="n">lats</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.grid-1334"><a href="#Grib2Message.grid-1334"><span class="linenos">1334</span></a>            <span class="c1"># flip if scan mode says to.</span>
</span><span id="Grib2Message.grid-1335"><a href="#Grib2Message.grid-1335"><span class="linenos">1335</span></a>            <span class="c1">#if self.scanModeFlags[0]:</span>
</span><span id="Grib2Message.grid-1336"><a href="#Grib2Message.grid-1336"><span class="linenos">1336</span></a>            <span class="c1">#    lons = lons[::-1]</span>
</span><span id="Grib2Message.grid-1337"><a href="#Grib2Message.grid-1337"><span class="linenos">1337</span></a>            <span class="c1">#if not self.scanModeFlags[1]:</span>
</span><span id="Grib2Message.grid-1338"><a href="#Grib2Message.grid-1338"><span class="linenos">1338</span></a>            <span class="c1">#    lats = lats[::-1]</span>
</span><span id="Grib2Message.grid-1339"><a href="#Grib2Message.grid-1339"><span class="linenos">1339</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cyl&#39;</span>
</span><span id="Grib2Message.grid-1340"><a href="#Grib2Message.grid-1340"><span class="linenos">1340</span></a>            <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">)</span> <span class="c1"># make 2-d arrays</span>
</span><span id="Grib2Message.grid-1341"><a href="#Grib2Message.grid-1341"><span class="linenos">1341</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">110</span><span class="p">]:</span>
</span><span id="Grib2Message.grid-1342"><a href="#Grib2Message.grid-1342"><span class="linenos">1342</span></a>            <span class="c1"># Mercator, Lambert Conformal, Stereographic, Albers Equal Area, Azimuthal Equidistant</span>
</span><span id="Grib2Message.grid-1343"><a href="#Grib2Message.grid-1343"><span class="linenos">1343</span></a>            <span class="n">dx</span><span class="p">,</span><span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message.grid-1344"><a href="#Grib2Message.grid-1344"><span class="linenos">1344</span></a>            <span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitudeFirstGridpoint</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitudeFirstGridpoint</span>
</span><span id="Grib2Message.grid-1345"><a href="#Grib2Message.grid-1345"><span class="linenos">1345</span></a>            <span class="k">if</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="c1"># Mercator.</span>
</span><span id="Grib2Message.grid-1346"><a href="#Grib2Message.grid-1346"><span class="linenos">1346</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_ts&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span>
</span><span id="Grib2Message.grid-1347"><a href="#Grib2Message.grid-1347"><span class="linenos">1347</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message.grid-1348"><a href="#Grib2Message.grid-1348"><span class="linenos">1348</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message.grid-1349"><a href="#Grib2Message.grid-1349"><span class="linenos">1349</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1350"><a href="#Grib2Message.grid-1350"><span class="linenos">1350</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1351"><a href="#Grib2Message.grid-1351"><span class="linenos">1351</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1352"><a href="#Grib2Message.grid-1352"><span class="linenos">1352</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1353"><a href="#Grib2Message.grid-1353"><span class="linenos">1353</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1354"><a href="#Grib2Message.grid-1354"><span class="linenos">1354</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1355"><a href="#Grib2Message.grid-1355"><span class="linenos">1355</span></a>            <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>  <span class="c1"># Stereographic</span>
</span><span id="Grib2Message.grid-1356"><a href="#Grib2Message.grid-1356"><span class="linenos">1356</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_ts&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_ts</span>
</span><span id="Grib2Message.grid-1357"><a href="#Grib2Message.grid-1357"><span class="linenos">1357</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message.grid-1358"><a href="#Grib2Message.grid-1358"><span class="linenos">1358</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span>
</span><span id="Grib2Message.grid-1359"><a href="#Grib2Message.grid-1359"><span class="linenos">1359</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message.grid-1360"><a href="#Grib2Message.grid-1360"><span class="linenos">1360</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1361"><a href="#Grib2Message.grid-1361"><span class="linenos">1361</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1362"><a href="#Grib2Message.grid-1362"><span class="linenos">1362</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1363"><a href="#Grib2Message.grid-1363"><span class="linenos">1363</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1364"><a href="#Grib2Message.grid-1364"><span class="linenos">1364</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1365"><a href="#Grib2Message.grid-1365"><span class="linenos">1365</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1366"><a href="#Grib2Message.grid-1366"><span class="linenos">1366</span></a>            <span class="k">elif</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">]:</span> <span class="c1"># Lambert, Albers</span>
</span><span id="Grib2Message.grid-1367"><a href="#Grib2Message.grid-1367"><span class="linenos">1367</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_1&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_1</span>
</span><span id="Grib2Message.grid-1368"><a href="#Grib2Message.grid-1368"><span class="linenos">1368</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_2&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_2</span>
</span><span id="Grib2Message.grid-1369"><a href="#Grib2Message.grid-1369"><span class="linenos">1369</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message.grid-1370"><a href="#Grib2Message.grid-1370"><span class="linenos">1370</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message.grid-1371"><a href="#Grib2Message.grid-1371"><span class="linenos">1371</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1372"><a href="#Grib2Message.grid-1372"><span class="linenos">1372</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1373"><a href="#Grib2Message.grid-1373"><span class="linenos">1373</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1374"><a href="#Grib2Message.grid-1374"><span class="linenos">1374</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1375"><a href="#Grib2Message.grid-1375"><span class="linenos">1375</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1376"><a href="#Grib2Message.grid-1376"><span class="linenos">1376</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1377"><a href="#Grib2Message.grid-1377"><span class="linenos">1377</span></a>            <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">110</span><span class="p">:</span> <span class="c1"># Azimuthal Equidistant</span>
</span><span id="Grib2Message.grid-1378"><a href="#Grib2Message.grid-1378"><span class="linenos">1378</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message.grid-1379"><a href="#Grib2Message.grid-1379"><span class="linenos">1379</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span>
</span><span id="Grib2Message.grid-1380"><a href="#Grib2Message.grid-1380"><span class="linenos">1380</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message.grid-1381"><a href="#Grib2Message.grid-1381"><span class="linenos">1381</span></a>                <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1382"><a href="#Grib2Message.grid-1382"><span class="linenos">1382</span></a>                <span class="n">llcrnrx</span><span class="p">,</span> <span class="n">llcrnry</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat1</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1383"><a href="#Grib2Message.grid-1383"><span class="linenos">1383</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">llcrnrx</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1384"><a href="#Grib2Message.grid-1384"><span class="linenos">1384</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">llcrnry</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1385"><a href="#Grib2Message.grid-1385"><span class="linenos">1385</span></a>                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1386"><a href="#Grib2Message.grid-1386"><span class="linenos">1386</span></a>                <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1387"><a href="#Grib2Message.grid-1387"><span class="linenos">1387</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="Grib2Message.grid-1388"><a href="#Grib2Message.grid-1388"><span class="linenos">1388</span></a>            <span class="c1"># Satellite Projection</span>
</span><span id="Grib2Message.grid-1389"><a href="#Grib2Message.grid-1389"><span class="linenos">1389</span></a>            <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthXDirection</span>
</span><span id="Grib2Message.grid-1390"><a href="#Grib2Message.grid-1390"><span class="linenos">1390</span></a>            <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridlengthYDirection</span>
</span><span id="Grib2Message.grid-1391"><a href="#Grib2Message.grid-1391"><span class="linenos">1391</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_proj</span>
</span><span id="Grib2Message.grid-1392"><a href="#Grib2Message.grid-1392"><span class="linenos">1392</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lon_0</span>
</span><span id="Grib2Message.grid-1393"><a href="#Grib2Message.grid-1393"><span class="linenos">1393</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_lat_0</span>
</span><span id="Grib2Message.grid-1394"><a href="#Grib2Message.grid-1394"><span class="linenos">1394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj4_h</span>
</span><span id="Grib2Message.grid-1395"><a href="#Grib2Message.grid-1395"><span class="linenos">1395</span></a>            <span class="n">pj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projparams</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1396"><a href="#Grib2Message.grid-1396"><span class="linenos">1396</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">),</span><span class="s1">&#39;f&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">,:,:]</span>
</span><span id="Grib2Message.grid-1397"><a href="#Grib2Message.grid-1397"><span class="linenos">1397</span></a>            <span class="n">x</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Grib2Message.grid-1398"><a href="#Grib2Message.grid-1398"><span class="linenos">1398</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">),</span><span class="s1">&#39;f&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:,:]</span>
</span><span id="Grib2Message.grid-1399"><a href="#Grib2Message.grid-1399"><span class="linenos">1399</span></a>            <span class="n">y</span> <span class="o">-=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Grib2Message.grid-1400"><a href="#Grib2Message.grid-1400"><span class="linenos">1400</span></a>            <span class="n">lons</span><span class="p">,</span><span class="n">lats</span> <span class="o">=</span> <span class="n">pj</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1401"><a href="#Grib2Message.grid-1401"><span class="linenos">1401</span></a>            <span class="c1"># Set lons,lats to 1.e30 where undefined</span>
</span><span id="Grib2Message.grid-1402"><a href="#Grib2Message.grid-1402"><span class="linenos">1402</span></a>            <span class="n">abslons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1403"><a href="#Grib2Message.grid-1403"><span class="linenos">1403</span></a>            <span class="n">abslats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1404"><a href="#Grib2Message.grid-1404"><span class="linenos">1404</span></a>            <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">abslons</span> <span class="o">&lt;</span> <span class="mf">1.e20</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="mf">1.e30</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1405"><a href="#Grib2Message.grid-1405"><span class="linenos">1405</span></a>            <span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">abslats</span> <span class="o">&lt;</span> <span class="mf">1.e20</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="mf">1.e30</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1406"><a href="#Grib2Message.grid-1406"><span class="linenos">1406</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.grid-1407"><a href="#Grib2Message.grid-1407"><span class="linenos">1407</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unsupported grid&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.grid-1408"><a href="#Grib2Message.grid-1408"><span class="linenos">1408</span></a>
</span><span id="Grib2Message.grid-1409"><a href="#Grib2Message.grid-1409"><span class="linenos">1409</span></a>        <span class="k">return</span> <span class="n">lats</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">),</span> <span class="n">lons</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return lats,lons (in degrees) of grid. Currently can handle reg. lat/lon, 
global Gaussian, mercator, stereographic, lambert conformal, albers equal-area, 
space-view and azimuthal equidistant grids.</p>

<h2 id="returns">Returns</h2>

<p><strong><code>lats, lons : numpy.ndarray</code></strong></p>

<p>Returns two numpy.ndarrays with dtype=numpy.float32 of grid latitudes and
longitudes in units of degrees.</p>
</div>


                            </div>
                            <div id="Grib2Message.addlocal" class="classattr">
                                        <input id="Grib2Message.addlocal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">addlocal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ludata</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.addlocal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.addlocal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.addlocal-1412"><a href="#Grib2Message.addlocal-1412"><span class="linenos">1412</span></a>    <span class="k">def</span> <span class="nf">addlocal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ludata</span><span class="p">):</span>
</span><span id="Grib2Message.addlocal-1413"><a href="#Grib2Message.addlocal-1413"><span class="linenos">1413</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.addlocal-1414"><a href="#Grib2Message.addlocal-1414"><span class="linenos">1414</span></a><span class="sd">        Add a Local Use Section [(Section 2)](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_sect2.shtml)</span>
</span><span id="Grib2Message.addlocal-1415"><a href="#Grib2Message.addlocal-1415"><span class="linenos">1415</span></a><span class="sd">        to the GRIB2 message.</span>
</span><span id="Grib2Message.addlocal-1416"><a href="#Grib2Message.addlocal-1416"><span class="linenos">1416</span></a>
</span><span id="Grib2Message.addlocal-1417"><a href="#Grib2Message.addlocal-1417"><span class="linenos">1417</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message.addlocal-1418"><a href="#Grib2Message.addlocal-1418"><span class="linenos">1418</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message.addlocal-1419"><a href="#Grib2Message.addlocal-1419"><span class="linenos">1419</span></a>
</span><span id="Grib2Message.addlocal-1420"><a href="#Grib2Message.addlocal-1420"><span class="linenos">1420</span></a><span class="sd">        **`ludata : bytes`**: Local Use data.</span>
</span><span id="Grib2Message.addlocal-1421"><a href="#Grib2Message.addlocal-1421"><span class="linenos">1421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.addlocal-1422"><a href="#Grib2Message.addlocal-1422"><span class="linenos">1422</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ludata</span><span class="p">,</span><span class="nb">bytes</span><span class="p">)</span>
</span><span id="Grib2Message.addlocal-1423"><a href="#Grib2Message.addlocal-1423"><span class="linenos">1423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_addlocal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="n">ludata</span><span class="p">)</span>
</span><span id="Grib2Message.addlocal-1424"><a href="#Grib2Message.addlocal-1424"><span class="linenos">1424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hasLocalUseSection</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Grib2Message.addlocal-1425"><a href="#Grib2Message.addlocal-1425"><span class="linenos">1425</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add a Local Use Section <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_sect2.shtml">(Section 2)</a>
to the GRIB2 message.</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>ludata : bytes</code></strong>: Local Use data.</p>
</div>


                            </div>
                            <div id="Grib2Message.addgrid" class="classattr">
                                        <input id="Grib2Message.addgrid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">addgrid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">gdsinfo</span>, </span><span class="param"><span class="n">gdtmpl</span>, </span><span class="param"><span class="n">deflist</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.addgrid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.addgrid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.addgrid-1428"><a href="#Grib2Message.addgrid-1428"><span class="linenos">1428</span></a>    <span class="k">def</span> <span class="nf">addgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdsinfo</span><span class="p">,</span> <span class="n">gdtmpl</span><span class="p">,</span> <span class="n">deflist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Grib2Message.addgrid-1429"><a href="#Grib2Message.addgrid-1429"><span class="linenos">1429</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.addgrid-1430"><a href="#Grib2Message.addgrid-1430"><span class="linenos">1430</span></a><span class="sd">        Add a Grid Definition Section [(Section 3)](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_doc/grib2_sect3.shtml) </span>
</span><span id="Grib2Message.addgrid-1431"><a href="#Grib2Message.addgrid-1431"><span class="linenos">1431</span></a><span class="sd">        to the GRIB2 message.</span>
</span><span id="Grib2Message.addgrid-1432"><a href="#Grib2Message.addgrid-1432"><span class="linenos">1432</span></a>
</span><span id="Grib2Message.addgrid-1433"><a href="#Grib2Message.addgrid-1433"><span class="linenos">1433</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message.addgrid-1434"><a href="#Grib2Message.addgrid-1434"><span class="linenos">1434</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message.addgrid-1435"><a href="#Grib2Message.addgrid-1435"><span class="linenos">1435</span></a>
</span><span id="Grib2Message.addgrid-1436"><a href="#Grib2Message.addgrid-1436"><span class="linenos">1436</span></a><span class="sd">        **`gdsinfo`**: Sequence containing information needed for the grid definition section.</span>
</span><span id="Grib2Message.addgrid-1437"><a href="#Grib2Message.addgrid-1437"><span class="linenos">1437</span></a>
</span><span id="Grib2Message.addgrid-1438"><a href="#Grib2Message.addgrid-1438"><span class="linenos">1438</span></a><span class="sd">        | Index | Description |</span>
</span><span id="Grib2Message.addgrid-1439"><a href="#Grib2Message.addgrid-1439"><span class="linenos">1439</span></a><span class="sd">        | :---: | :---        |</span>
</span><span id="Grib2Message.addgrid-1440"><a href="#Grib2Message.addgrid-1440"><span class="linenos">1440</span></a><span class="sd">        | gdsinfo[0] | Source of grid definition - [Code Table 3.0](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-0.shtml)|</span>
</span><span id="Grib2Message.addgrid-1441"><a href="#Grib2Message.addgrid-1441"><span class="linenos">1441</span></a><span class="sd">        | gdsinfo[1] | Number of data points|</span>
</span><span id="Grib2Message.addgrid-1442"><a href="#Grib2Message.addgrid-1442"><span class="linenos">1442</span></a><span class="sd">        | gdsinfo[2] | Number of octets for optional list of numbers defining number of points|</span>
</span><span id="Grib2Message.addgrid-1443"><a href="#Grib2Message.addgrid-1443"><span class="linenos">1443</span></a><span class="sd">        | gdsinfo[3] | Interpetation of list of numbers defining number of points - [Code Table 3.11](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-11.shtml)|</span>
</span><span id="Grib2Message.addgrid-1444"><a href="#Grib2Message.addgrid-1444"><span class="linenos">1444</span></a><span class="sd">        | gdsinfo[4] | Grid Definition Template Number - [Code Table 3.1](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-1.shtml)|</span>
</span><span id="Grib2Message.addgrid-1445"><a href="#Grib2Message.addgrid-1445"><span class="linenos">1445</span></a>
</span><span id="Grib2Message.addgrid-1446"><a href="#Grib2Message.addgrid-1446"><span class="linenos">1446</span></a><span class="sd">        **`gdtmpl`**: Sequence of values for the specified Grid Definition Template. Each </span>
</span><span id="Grib2Message.addgrid-1447"><a href="#Grib2Message.addgrid-1447"><span class="linenos">1447</span></a><span class="sd">        element of this integer array contains an entry (in the order specified) of Grid</span>
</span><span id="Grib2Message.addgrid-1448"><a href="#Grib2Message.addgrid-1448"><span class="linenos">1448</span></a><span class="sd">        Definition Template 3.NN</span>
</span><span id="Grib2Message.addgrid-1449"><a href="#Grib2Message.addgrid-1449"><span class="linenos">1449</span></a>
</span><span id="Grib2Message.addgrid-1450"><a href="#Grib2Message.addgrid-1450"><span class="linenos">1450</span></a><span class="sd">        **`deflist`**: Sequence containing the number of grid points contained in each </span>
</span><span id="Grib2Message.addgrid-1451"><a href="#Grib2Message.addgrid-1451"><span class="linenos">1451</span></a><span class="sd">        row (or column) of a non-regular grid.  Used if gdsinfo[2] != 0.</span>
</span><span id="Grib2Message.addgrid-1452"><a href="#Grib2Message.addgrid-1452"><span class="linenos">1452</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.addgrid-1453"><a href="#Grib2Message.addgrid-1453"><span class="linenos">1453</span></a>        <span class="k">if</span> <span class="mi">3</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="p">:</span>
</span><span id="Grib2Message.addgrid-1454"><a href="#Grib2Message.addgrid-1454"><span class="linenos">1454</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;GRIB2 Message already contains Grid Definition Section.&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.addgrid-1455"><a href="#Grib2Message.addgrid-1455"><span class="linenos">1455</span></a>        <span class="k">if</span> <span class="n">deflist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.addgrid-1456"><a href="#Grib2Message.addgrid-1456"><span class="linenos">1456</span></a>            <span class="n">_deflist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">deflist</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message.addgrid-1457"><a href="#Grib2Message.addgrid-1457"><span class="linenos">1457</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.addgrid-1458"><a href="#Grib2Message.addgrid-1458"><span class="linenos">1458</span></a>            <span class="n">_deflist</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.addgrid-1459"><a href="#Grib2Message.addgrid-1459"><span class="linenos">1459</span></a>        <span class="n">gdtnum</span> <span class="o">=</span> <span class="n">gdsinfo</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1460"><a href="#Grib2Message.addgrid-1460"><span class="linenos">1460</span></a>        <span class="k">if</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">32768</span><span class="p">,</span><span class="mi">32769</span><span class="p">]:</span>
</span><span id="Grib2Message.addgrid-1461"><a href="#Grib2Message.addgrid-1461"><span class="linenos">1461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1462"><a href="#Grib2Message.addgrid-1462"><span class="linenos">1462</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="c1"># mercator</span>
</span><span id="Grib2Message.addgrid-1463"><a href="#Grib2Message.addgrid-1463"><span class="linenos">1463</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1464"><a href="#Grib2Message.addgrid-1464"><span class="linenos">1464</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span> <span class="c1"># stereographic</span>
</span><span id="Grib2Message.addgrid-1465"><a href="#Grib2Message.addgrid-1465"><span class="linenos">1465</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1466"><a href="#Grib2Message.addgrid-1466"><span class="linenos">1466</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span> <span class="c1"># lambert conformal</span>
</span><span id="Grib2Message.addgrid-1467"><a href="#Grib2Message.addgrid-1467"><span class="linenos">1467</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1468"><a href="#Grib2Message.addgrid-1468"><span class="linenos">1468</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span> <span class="c1"># albers equal area.</span>
</span><span id="Grib2Message.addgrid-1469"><a href="#Grib2Message.addgrid-1469"><span class="linenos">1469</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1470"><a href="#Grib2Message.addgrid-1470"><span class="linenos">1470</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span> <span class="c1"># near-sided vertical perspective satellite projection</span>
</span><span id="Grib2Message.addgrid-1471"><a href="#Grib2Message.addgrid-1471"><span class="linenos">1471</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1472"><a href="#Grib2Message.addgrid-1472"><span class="linenos">1472</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">110</span><span class="p">:</span> <span class="c1"># azimuthal equidistant.</span>
</span><span id="Grib2Message.addgrid-1473"><a href="#Grib2Message.addgrid-1473"><span class="linenos">1473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1474"><a href="#Grib2Message.addgrid-1474"><span class="linenos">1474</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">120</span><span class="p">:</span>
</span><span id="Grib2Message.addgrid-1475"><a href="#Grib2Message.addgrid-1475"><span class="linenos">1475</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1476"><a href="#Grib2Message.addgrid-1476"><span class="linenos">1476</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span> <span class="c1"># curvilinear orthogonal</span>
</span><span id="Grib2Message.addgrid-1477"><a href="#Grib2Message.addgrid-1477"><span class="linenos">1477</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1478"><a href="#Grib2Message.addgrid-1478"><span class="linenos">1478</span></a>        <span class="k">elif</span> <span class="n">gdtnum</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1100</span><span class="p">]:</span>
</span><span id="Grib2Message.addgrid-1479"><a href="#Grib2Message.addgrid-1479"><span class="linenos">1479</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">int2bin</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Grib2Message.addgrid-1480"><a href="#Grib2Message.addgrid-1480"><span class="linenos">1480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_addgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span>
</span><span id="Grib2Message.addgrid-1481"><a href="#Grib2Message.addgrid-1481"><span class="linenos">1481</span></a>                                                   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gdsinfo</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message.addgrid-1482"><a href="#Grib2Message.addgrid-1482"><span class="linenos">1482</span></a>                                                   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gdtmpl</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message.addgrid-1483"><a href="#Grib2Message.addgrid-1483"><span class="linenos">1483</span></a>                                                   <span class="n">_deflist</span><span class="p">)</span>
</span><span id="Grib2Message.addgrid-1484"><a href="#Grib2Message.addgrid-1484"><span class="linenos">1484</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add a Grid Definition Section <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_doc/grib2_sect3.shtml">(Section 3)</a> 
to the GRIB2 message.</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>gdsinfo</code></strong>: Sequence containing information needed for the grid definition section.</p>

<table>
<thead>
<tr>
  <th style="text-align:center;">Index</th>
  <th style="text-align:left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">gdsinfo[0]</td>
  <td style="text-align:left;">Source of grid definition - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-0.shtml">Code Table 3.0</a></td>
</tr>
<tr>
  <td style="text-align:center;">gdsinfo[1]</td>
  <td style="text-align:left;">Number of data points</td>
</tr>
<tr>
  <td style="text-align:center;">gdsinfo[2]</td>
  <td style="text-align:left;">Number of octets for optional list of numbers defining number of points</td>
</tr>
<tr>
  <td style="text-align:center;">gdsinfo[3]</td>
  <td style="text-align:left;">Interpetation of list of numbers defining number of points - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-11.shtml">Code Table 3.11</a></td>
</tr>
<tr>
  <td style="text-align:center;">gdsinfo[4]</td>
  <td style="text-align:left;">Grid Definition Template Number - <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table3-1.shtml">Code Table 3.1</a></td>
</tr>
</tbody>
</table>

<p><strong><code>gdtmpl</code></strong>: Sequence of values for the specified Grid Definition Template. Each 
element of this integer array contains an entry (in the order specified) of Grid
Definition Template 3.NN</p>

<p><strong><code>deflist</code></strong>: Sequence containing the number of grid points contained in each 
row (or column) of a non-regular grid.  Used if gdsinfo[2] != 0.</p>
</div>


                            </div>
                            <div id="Grib2Message.addfield" class="classattr">
                                        <input id="Grib2Message.addfield-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">addfield</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">field</span>,</span><span class="param">	<span class="n">pdtnum</span>,</span><span class="param">	<span class="n">pdtmpl</span>,</span><span class="param">	<span class="n">coordlist</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">packing</span><span class="o">=</span><span class="s1">&#39;complex-spdiff&#39;</span>,</span><span class="param">	<span class="o">**</span><span class="n">packing_opts</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.addfield-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.addfield"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.addfield-1487"><a href="#Grib2Message.addfield-1487"><span class="linenos">1487</span></a>    <span class="k">def</span> <span class="nf">addfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">pdtnum</span><span class="p">,</span> <span class="n">pdtmpl</span><span class="p">,</span> <span class="n">coordlist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">packing</span><span class="o">=</span><span class="s2">&quot;complex-spdiff&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">packing_opts</span><span class="p">):</span> 
</span><span id="Grib2Message.addfield-1488"><a href="#Grib2Message.addfield-1488"><span class="linenos">1488</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.addfield-1489"><a href="#Grib2Message.addfield-1489"><span class="linenos">1489</span></a><span class="sd">        Add a Product Definition, Data Representation, Bitmap, and Data Sections </span>
</span><span id="Grib2Message.addfield-1490"><a href="#Grib2Message.addfield-1490"><span class="linenos">1490</span></a><span class="sd">        to `Grib2Message` instance (i.e. Sections 4-7).  Must be called after the grid </span>
</span><span id="Grib2Message.addfield-1491"><a href="#Grib2Message.addfield-1491"><span class="linenos">1491</span></a><span class="sd">        definition section has been added (`addfield`).</span>
</span><span id="Grib2Message.addfield-1492"><a href="#Grib2Message.addfield-1492"><span class="linenos">1492</span></a>
</span><span id="Grib2Message.addfield-1493"><a href="#Grib2Message.addfield-1493"><span class="linenos">1493</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message.addfield-1494"><a href="#Grib2Message.addfield-1494"><span class="linenos">1494</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message.addfield-1495"><a href="#Grib2Message.addfield-1495"><span class="linenos">1495</span></a>
</span><span id="Grib2Message.addfield-1496"><a href="#Grib2Message.addfield-1496"><span class="linenos">1496</span></a><span class="sd">        **`field`**: Numpy array of data values to pack.  If field is a masked array, then </span>
</span><span id="Grib2Message.addfield-1497"><a href="#Grib2Message.addfield-1497"><span class="linenos">1497</span></a><span class="sd">        a bitmap is created from the mask.</span>
</span><span id="Grib2Message.addfield-1498"><a href="#Grib2Message.addfield-1498"><span class="linenos">1498</span></a>
</span><span id="Grib2Message.addfield-1499"><a href="#Grib2Message.addfield-1499"><span class="linenos">1499</span></a><span class="sd">        **`pdtnum`**: integer Product Definition Template Number - [Code Table 4.0](http://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table4-0.shtml)</span>
</span><span id="Grib2Message.addfield-1500"><a href="#Grib2Message.addfield-1500"><span class="linenos">1500</span></a>
</span><span id="Grib2Message.addfield-1501"><a href="#Grib2Message.addfield-1501"><span class="linenos">1501</span></a><span class="sd">        **`pdtmpl`**: Sequence with the data values for the specified Product Definition </span>
</span><span id="Grib2Message.addfield-1502"><a href="#Grib2Message.addfield-1502"><span class="linenos">1502</span></a><span class="sd">        Template (N=pdtnum).  Each element of this integer array contains an entry (in </span>
</span><span id="Grib2Message.addfield-1503"><a href="#Grib2Message.addfield-1503"><span class="linenos">1503</span></a><span class="sd">        the order specified) of Product Definition Template 4.N.</span>
</span><span id="Grib2Message.addfield-1504"><a href="#Grib2Message.addfield-1504"><span class="linenos">1504</span></a>
</span><span id="Grib2Message.addfield-1505"><a href="#Grib2Message.addfield-1505"><span class="linenos">1505</span></a><span class="sd">        **`coordlist`**: Sequence containing floating point values intended to document the </span>
</span><span id="Grib2Message.addfield-1506"><a href="#Grib2Message.addfield-1506"><span class="linenos">1506</span></a><span class="sd">        vertical discretization with model data on hybrid coordinate vertical levels. Default is `None`.</span>
</span><span id="Grib2Message.addfield-1507"><a href="#Grib2Message.addfield-1507"><span class="linenos">1507</span></a>
</span><span id="Grib2Message.addfield-1508"><a href="#Grib2Message.addfield-1508"><span class="linenos">1508</span></a><span class="sd">        **`packing`**: String to specify the type of packing. Valid options are the following:</span>
</span><span id="Grib2Message.addfield-1509"><a href="#Grib2Message.addfield-1509"><span class="linenos">1509</span></a>
</span><span id="Grib2Message.addfield-1510"><a href="#Grib2Message.addfield-1510"><span class="linenos">1510</span></a><span class="sd">        | Packing Scheme | Description |</span>
</span><span id="Grib2Message.addfield-1511"><a href="#Grib2Message.addfield-1511"><span class="linenos">1511</span></a><span class="sd">        | :---:          | :---:       |</span>
</span><span id="Grib2Message.addfield-1512"><a href="#Grib2Message.addfield-1512"><span class="linenos">1512</span></a><span class="sd">        | &#39;simple&#39;         | [Simple packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-0.shtml) | </span>
</span><span id="Grib2Message.addfield-1513"><a href="#Grib2Message.addfield-1513"><span class="linenos">1513</span></a><span class="sd">        | &#39;complex&#39;        | [Complex packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-2.shtml) | </span>
</span><span id="Grib2Message.addfield-1514"><a href="#Grib2Message.addfield-1514"><span class="linenos">1514</span></a><span class="sd">        | &#39;complex-spdiff&#39; | [Complex packing with Spatial Differencing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-3.shtml) | </span>
</span><span id="Grib2Message.addfield-1515"><a href="#Grib2Message.addfield-1515"><span class="linenos">1515</span></a><span class="sd">        | &#39;jpeg&#39;           | [JPEG compression](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-40.shtml) | </span>
</span><span id="Grib2Message.addfield-1516"><a href="#Grib2Message.addfield-1516"><span class="linenos">1516</span></a><span class="sd">        | &#39;png&#39;            | [PNG compression](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-41.shtml) | </span>
</span><span id="Grib2Message.addfield-1517"><a href="#Grib2Message.addfield-1517"><span class="linenos">1517</span></a><span class="sd">        | &#39;spectral-simple&#39;| [Spectral Data - Simple packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-50.shtml) | </span>
</span><span id="Grib2Message.addfield-1518"><a href="#Grib2Message.addfield-1518"><span class="linenos">1518</span></a><span class="sd">        | &#39;spectral-complex&#39;| [Spectral Data - Complex packing](https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-51.shtml) | </span>
</span><span id="Grib2Message.addfield-1519"><a href="#Grib2Message.addfield-1519"><span class="linenos">1519</span></a>
</span><span id="Grib2Message.addfield-1520"><a href="#Grib2Message.addfield-1520"><span class="linenos">1520</span></a><span class="sd">        **`**packing_opts`**: Packing keyword arguments. The keywords are the same as Grib2Message attribute names for</span>
</span><span id="Grib2Message.addfield-1521"><a href="#Grib2Message.addfield-1521"><span class="linenos">1521</span></a><span class="sd">        the Data Representation Template (Section 5) metadata. Valid keywords per packing scheme are the following:</span>
</span><span id="Grib2Message.addfield-1522"><a href="#Grib2Message.addfield-1522"><span class="linenos">1522</span></a>
</span><span id="Grib2Message.addfield-1523"><a href="#Grib2Message.addfield-1523"><span class="linenos">1523</span></a><span class="sd">        | Packing Scheme | Keyword Arguments |</span>
</span><span id="Grib2Message.addfield-1524"><a href="#Grib2Message.addfield-1524"><span class="linenos">1524</span></a><span class="sd">        | :---:          | :---:                      |</span>
</span><span id="Grib2Message.addfield-1525"><a href="#Grib2Message.addfield-1525"><span class="linenos">1525</span></a><span class="sd">        | &#39;simple&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message.addfield-1526"><a href="#Grib2Message.addfield-1526"><span class="linenos">1526</span></a><span class="sd">        | &#39;complex&#39;     | `binScaleFactor`, `decScaleFactor`, `priMissingValue`, [`secMissingValue`] |</span>
</span><span id="Grib2Message.addfield-1527"><a href="#Grib2Message.addfield-1527"><span class="linenos">1527</span></a><span class="sd">        | &#39;complex-spdiff&#39;     | `binScaleFactor`, `decScaleFactor`, `spatialDifferenceOrder`, `priMissingValue`, [`secMissingValue`] |</span>
</span><span id="Grib2Message.addfield-1528"><a href="#Grib2Message.addfield-1528"><span class="linenos">1528</span></a><span class="sd">        | &#39;jpeg&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message.addfield-1529"><a href="#Grib2Message.addfield-1529"><span class="linenos">1529</span></a><span class="sd">        | &#39;png&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message.addfield-1530"><a href="#Grib2Message.addfield-1530"><span class="linenos">1530</span></a><span class="sd">        | &#39;spectral-simple&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message.addfield-1531"><a href="#Grib2Message.addfield-1531"><span class="linenos">1531</span></a><span class="sd">        | &#39;spectral-complex&#39;     | `binScaleFactor`, `decScaleFactor` |</span>
</span><span id="Grib2Message.addfield-1532"><a href="#Grib2Message.addfield-1532"><span class="linenos">1532</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.addfield-1533"><a href="#Grib2Message.addfield-1533"><span class="linenos">1533</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1534"><a href="#Grib2Message.addfield-1534"><span class="linenos">1534</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;addgrid() must be called before addfield()&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1535"><a href="#Grib2Message.addfield-1535"><span class="linenos">1535</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1536"><a href="#Grib2Message.addfield-1536"><span class="linenos">1536</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanModeFlags</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
</span><span id="Grib2Message.addfield-1537"><a href="#Grib2Message.addfield-1537"><span class="linenos">1537</span></a>                <span class="n">fieldsave</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="c1"># Casting makes a copy</span>
</span><span id="Grib2Message.addfield-1538"><a href="#Grib2Message.addfield-1538"><span class="linenos">1538</span></a>                <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">fieldsave</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1539"><a href="#Grib2Message.addfield-1539"><span class="linenos">1539</span></a>        <span class="n">fld</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1540"><a href="#Grib2Message.addfield-1540"><span class="linenos">1540</span></a>        <span class="k">if</span> <span class="n">ma</span><span class="o">.</span><span class="n">isMA</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ma</span><span class="o">.</span><span class="n">count_masked</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1541"><a href="#Grib2Message.addfield-1541"><span class="linenos">1541</span></a>            <span class="n">bitmapflag</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message.addfield-1542"><a href="#Grib2Message.addfield-1542"><span class="linenos">1542</span></a>            <span class="n">bmap</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">))</span>
</span><span id="Grib2Message.addfield-1543"><a href="#Grib2Message.addfield-1543"><span class="linenos">1543</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1544"><a href="#Grib2Message.addfield-1544"><span class="linenos">1544</span></a>            <span class="n">bitmapflag</span> <span class="o">=</span> <span class="mi">255</span>
</span><span id="Grib2Message.addfield-1545"><a href="#Grib2Message.addfield-1545"><span class="linenos">1545</span></a>            <span class="n">bmap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.addfield-1546"><a href="#Grib2Message.addfield-1546"><span class="linenos">1546</span></a>        <span class="k">if</span> <span class="n">coordlist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1547"><a href="#Grib2Message.addfield-1547"><span class="linenos">1547</span></a>            <span class="n">crdlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordlist</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1548"><a href="#Grib2Message.addfield-1548"><span class="linenos">1548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1549"><a href="#Grib2Message.addfield-1549"><span class="linenos">1549</span></a>            <span class="n">crdlist</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Message.addfield-1550"><a href="#Grib2Message.addfield-1550"><span class="linenos">1550</span></a>
</span><span id="Grib2Message.addfield-1551"><a href="#Grib2Message.addfield-1551"><span class="linenos">1551</span></a>        <span class="c1"># Set data representation template number and template values</span>
</span><span id="Grib2Message.addfield-1552"><a href="#Grib2Message.addfield-1552"><span class="linenos">1552</span></a>        <span class="n">drtnum</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Grib2Message.addfield-1553"><a href="#Grib2Message.addfield-1553"><span class="linenos">1553</span></a>        <span class="n">drtmpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">DEFAULT_DRT_LEN</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1554"><a href="#Grib2Message.addfield-1554"><span class="linenos">1554</span></a>        <span class="k">if</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;simple&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1555"><a href="#Grib2Message.addfield-1555"><span class="linenos">1555</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message.addfield-1556"><a href="#Grib2Message.addfield-1556"><span class="linenos">1556</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1557"><a href="#Grib2Message.addfield-1557"><span class="linenos">1557</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1558"><a href="#Grib2Message.addfield-1558"><span class="linenos">1558</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex&quot;</span> <span class="ow">or</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex-spdiff&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1559"><a href="#Grib2Message.addfield-1559"><span class="linenos">1559</span></a>            <span class="k">if</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1560"><a href="#Grib2Message.addfield-1560"><span class="linenos">1560</span></a>                <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Grib2Message.addfield-1561"><a href="#Grib2Message.addfield-1561"><span class="linenos">1561</span></a>            <span class="k">if</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;complex-spdiff&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1562"><a href="#Grib2Message.addfield-1562"><span class="linenos">1562</span></a>                <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="Grib2Message.addfield-1563"><a href="#Grib2Message.addfield-1563"><span class="linenos">1563</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s1">&#39;spatialDifferenceOrder&#39;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1564"><a href="#Grib2Message.addfield-1564"><span class="linenos">1564</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1565"><a href="#Grib2Message.addfield-1565"><span class="linenos">1565</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1566"><a href="#Grib2Message.addfield-1566"><span class="linenos">1566</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">((</span><span class="s2">&quot;priMissingValue&quot;</span><span class="p">,</span><span class="s2">&quot;secMissingValue&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">):</span>
</span><span id="Grib2Message.addfield-1567"><a href="#Grib2Message.addfield-1567"><span class="linenos">1567</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Grib2Message.addfield-1568"><a href="#Grib2Message.addfield-1568"><span class="linenos">1568</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_float_to_int</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;priMissingValue&quot;</span><span class="p">])</span>
</span><span id="Grib2Message.addfield-1569"><a href="#Grib2Message.addfield-1569"><span class="linenos">1569</span></a>                <span class="n">drtmpl</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_float_to_int</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;secMissingValue&quot;</span><span class="p">])</span>
</span><span id="Grib2Message.addfield-1570"><a href="#Grib2Message.addfield-1570"><span class="linenos">1570</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1571"><a href="#Grib2Message.addfield-1571"><span class="linenos">1571</span></a>                <span class="k">if</span> <span class="s2">&quot;priMissingValue&quot;</span> <span class="ow">in</span> <span class="n">packing_opts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Grib2Message.addfield-1572"><a href="#Grib2Message.addfield-1572"><span class="linenos">1572</span></a>                    <span class="n">drtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Grib2Message.addfield-1573"><a href="#Grib2Message.addfield-1573"><span class="linenos">1573</span></a>                    <span class="n">drtmpl</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">ieee_float_to_int</span><span class="p">(</span><span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;priMissingValue&quot;</span><span class="p">])</span>
</span><span id="Grib2Message.addfield-1574"><a href="#Grib2Message.addfield-1574"><span class="linenos">1574</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1575"><a href="#Grib2Message.addfield-1575"><span class="linenos">1575</span></a>                    <span class="n">drtmpl</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Grib2Message.addfield-1576"><a href="#Grib2Message.addfield-1576"><span class="linenos">1576</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;jpeg&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1577"><a href="#Grib2Message.addfield-1577"><span class="linenos">1577</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">40</span>
</span><span id="Grib2Message.addfield-1578"><a href="#Grib2Message.addfield-1578"><span class="linenos">1578</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1579"><a href="#Grib2Message.addfield-1579"><span class="linenos">1579</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1580"><a href="#Grib2Message.addfield-1580"><span class="linenos">1580</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;png&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1581"><a href="#Grib2Message.addfield-1581"><span class="linenos">1581</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">41</span>
</span><span id="Grib2Message.addfield-1582"><a href="#Grib2Message.addfield-1582"><span class="linenos">1582</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1583"><a href="#Grib2Message.addfield-1583"><span class="linenos">1583</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1584"><a href="#Grib2Message.addfield-1584"><span class="linenos">1584</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;spectral-simple&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1585"><a href="#Grib2Message.addfield-1585"><span class="linenos">1585</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">50</span>
</span><span id="Grib2Message.addfield-1586"><a href="#Grib2Message.addfield-1586"><span class="linenos">1586</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1587"><a href="#Grib2Message.addfield-1587"><span class="linenos">1587</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1588"><a href="#Grib2Message.addfield-1588"><span class="linenos">1588</span></a>        <span class="k">elif</span> <span class="n">packing</span> <span class="o">==</span> <span class="s2">&quot;spectral-complex&quot;</span><span class="p">:</span>
</span><span id="Grib2Message.addfield-1589"><a href="#Grib2Message.addfield-1589"><span class="linenos">1589</span></a>            <span class="n">drtnum</span> <span class="o">=</span> <span class="mi">51</span>
</span><span id="Grib2Message.addfield-1590"><a href="#Grib2Message.addfield-1590"><span class="linenos">1590</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;binScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1591"><a href="#Grib2Message.addfield-1591"><span class="linenos">1591</span></a>            <span class="n">drtmpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">packing_opts</span><span class="p">[</span><span class="s2">&quot;decScaleFactor&quot;</span><span class="p">]</span>
</span><span id="Grib2Message.addfield-1592"><a href="#Grib2Message.addfield-1592"><span class="linenos">1592</span></a>
</span><span id="Grib2Message.addfield-1593"><a href="#Grib2Message.addfield-1593"><span class="linenos">1593</span></a>        <span class="n">pdtnum</span> <span class="o">=</span> <span class="n">pdtnum</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pdtnum</span><span class="p">,</span><span class="n">Grib2Metadata</span><span class="p">)</span> <span class="k">else</span> <span class="n">pdtnum</span>
</span><span id="Grib2Message.addfield-1594"><a href="#Grib2Message.addfield-1594"><span class="linenos">1594</span></a>
</span><span id="Grib2Message.addfield-1595"><a href="#Grib2Message.addfield-1595"><span class="linenos">1595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_addfield</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span>
</span><span id="Grib2Message.addfield-1596"><a href="#Grib2Message.addfield-1596"><span class="linenos">1596</span></a>                                                    <span class="n">pdtnum</span><span class="p">,</span>
</span><span id="Grib2Message.addfield-1597"><a href="#Grib2Message.addfield-1597"><span class="linenos">1597</span></a>                                                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pdtmpl</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DEFAULT_NUMPY_INT</span><span class="p">),</span>
</span><span id="Grib2Message.addfield-1598"><a href="#Grib2Message.addfield-1598"><span class="linenos">1598</span></a>                                                    <span class="n">crdlist</span><span class="p">,</span>
</span><span id="Grib2Message.addfield-1599"><a href="#Grib2Message.addfield-1599"><span class="linenos">1599</span></a>                                                    <span class="n">drtnum</span><span class="p">,</span>
</span><span id="Grib2Message.addfield-1600"><a href="#Grib2Message.addfield-1600"><span class="linenos">1600</span></a>                                                    <span class="n">drtmpl</span><span class="p">,</span>
</span><span id="Grib2Message.addfield-1601"><a href="#Grib2Message.addfield-1601"><span class="linenos">1601</span></a>                                                    <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">fld</span><span class="p">),</span>
</span><span id="Grib2Message.addfield-1602"><a href="#Grib2Message.addfield-1602"><span class="linenos">1602</span></a>                                                    <span class="n">bitmapflag</span><span class="p">,</span>
</span><span id="Grib2Message.addfield-1603"><a href="#Grib2Message.addfield-1603"><span class="linenos">1603</span></a>                                                    <span class="n">bmap</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1604"><a href="#Grib2Message.addfield-1604"><span class="linenos">1604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1605"><a href="#Grib2Message.addfield-1605"><span class="linenos">1605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1606"><a href="#Grib2Message.addfield-1606"><span class="linenos">1606</span></a>        <span class="k">if</span> <span class="n">bmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Grib2Message.addfield-1607"><a href="#Grib2Message.addfield-1607"><span class="linenos">1607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add a Product Definition, Data Representation, Bitmap, and Data Sections 
to <code><a href="#Grib2Message">Grib2Message</a></code> instance (i.e. Sections 4-7).  Must be called after the grid 
definition section has been added (<code><a href="#Grib2Message.addfield">addfield</a></code>).</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>field</code></strong>: Numpy array of data values to pack.  If field is a masked array, then 
a bitmap is created from the mask.</p>

<p><strong><code>pdtnum</code></strong>: integer Product Definition Template Number - <a href="http://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table4-0.shtml">Code Table 4.0</a></p>

<p><strong><code>pdtmpl</code></strong>: Sequence with the data values for the specified Product Definition 
Template (N=pdtnum).  Each element of this integer array contains an entry (in 
the order specified) of Product Definition Template 4.N.</p>

<p><strong><code>coordlist</code></strong>: Sequence containing floating point values intended to document the 
vertical discretization with model data on hybrid coordinate vertical levels. Default is <code>None</code>.</p>

<p><strong><code>packing</code></strong>: String to specify the type of packing. Valid options are the following:</p>

<table>
<thead>
<tr>
  <th style="text-align:center;">Packing Scheme</th>
  <th style="text-align:center;">Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">'simple'</td>
  <td style="text-align:center;"><a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-0.shtml">Simple packing</a></td>
</tr>
<tr>
  <td style="text-align:center;">'complex'</td>
  <td style="text-align:center;"><a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-2.shtml">Complex packing</a></td>
</tr>
<tr>
  <td style="text-align:center;">'complex-spdiff'</td>
  <td style="text-align:center;"><a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-3.shtml">Complex packing with Spatial Differencing</a></td>
</tr>
<tr>
  <td style="text-align:center;">'jpeg'</td>
  <td style="text-align:center;"><a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-40.shtml">JPEG compression</a></td>
</tr>
<tr>
  <td style="text-align:center;">'png'</td>
  <td style="text-align:center;"><a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-41.shtml">PNG compression</a></td>
</tr>
<tr>
  <td style="text-align:center;">'spectral-simple'</td>
  <td style="text-align:center;"><a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-50.shtml">Spectral Data - Simple packing</a></td>
</tr>
<tr>
  <td style="text-align:center;">'spectral-complex'</td>
  <td style="text-align:center;"><a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_temp5-51.shtml">Spectral Data - Complex packing</a></td>
</tr>
</tbody>
</table>

<p><strong><code>**packing_opts</code></strong>: Packing keyword arguments. The keywords are the same as Grib2Message attribute names for
the Data Representation Template (Section 5) metadata. Valid keywords per packing scheme are the following:</p>

<table>
<thead>
<tr>
  <th style="text-align:center;">Packing Scheme</th>
  <th style="text-align:center;">Keyword Arguments</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:center;">'simple'</td>
  <td style="text-align:center;"><code>binScaleFactor</code>, <code>decScaleFactor</code></td>
</tr>
<tr>
  <td style="text-align:center;">'complex'</td>
  <td style="text-align:center;"><code>binScaleFactor</code>, <code>decScaleFactor</code>, <code>priMissingValue</code>, [<code>secMissingValue</code>]</td>
</tr>
<tr>
  <td style="text-align:center;">'complex-spdiff'</td>
  <td style="text-align:center;"><code>binScaleFactor</code>, <code>decScaleFactor</code>, <code>spatialDifferenceOrder</code>, <code>priMissingValue</code>, [<code>secMissingValue</code>]</td>
</tr>
<tr>
  <td style="text-align:center;">'jpeg'</td>
  <td style="text-align:center;"><code>binScaleFactor</code>, <code>decScaleFactor</code></td>
</tr>
<tr>
  <td style="text-align:center;">'png'</td>
  <td style="text-align:center;"><code>binScaleFactor</code>, <code>decScaleFactor</code></td>
</tr>
<tr>
  <td style="text-align:center;">'spectral-simple'</td>
  <td style="text-align:center;"><code>binScaleFactor</code>, <code>decScaleFactor</code></td>
</tr>
<tr>
  <td style="text-align:center;">'spectral-complex'</td>
  <td style="text-align:center;"><code>binScaleFactor</code>, <code>decScaleFactor</code></td>
</tr>
</tbody>
</table>
</div>


                            </div>
                            <div id="Grib2Message.end" class="classattr">
                                        <input id="Grib2Message.end-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">end</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.end-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.end"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.end-1610"><a href="#Grib2Message.end-1610"><span class="linenos">1610</span></a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Message.end-1611"><a href="#Grib2Message.end-1611"><span class="linenos">1611</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.end-1612"><a href="#Grib2Message.end-1612"><span class="linenos">1612</span></a><span class="sd">        Add End Section (Section 8) to the GRIB2 message. A GRIB2 message </span>
</span><span id="Grib2Message.end-1613"><a href="#Grib2Message.end-1613"><span class="linenos">1613</span></a><span class="sd">        is not complete without an end section.  Once an end section is added, </span>
</span><span id="Grib2Message.end-1614"><a href="#Grib2Message.end-1614"><span class="linenos">1614</span></a><span class="sd">        the GRIB2 message can be written to file.</span>
</span><span id="Grib2Message.end-1615"><a href="#Grib2Message.end-1615"><span class="linenos">1615</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.end-1616"><a href="#Grib2Message.end-1616"><span class="linenos">1616</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">g2clib</span><span class="o">.</span><span class="n">grib2_end</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">)</span>
</span><span id="Grib2Message.end-1617"><a href="#Grib2Message.end-1617"><span class="linenos">1617</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add End Section (Section 8) to the GRIB2 message. A GRIB2 message 
is not complete without an end section.  Once an end section is added, 
the GRIB2 message can be written to file.</p>
</div>


                            </div>
                            <div id="Grib2Message.to_bytes" class="classattr">
                                        <input id="Grib2Message.to_bytes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_bytes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">validate</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="Grib2Message.to_bytes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Message.to_bytes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Message.to_bytes-1619"><a href="#Grib2Message.to_bytes-1619"><span class="linenos">1619</span></a>    <span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Grib2Message.to_bytes-1620"><a href="#Grib2Message.to_bytes-1620"><span class="linenos">1620</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Message.to_bytes-1621"><a href="#Grib2Message.to_bytes-1621"><span class="linenos">1621</span></a><span class="sd">        Return grib data in byte format. Useful for exporting data in non-file formats.</span>
</span><span id="Grib2Message.to_bytes-1622"><a href="#Grib2Message.to_bytes-1622"><span class="linenos">1622</span></a><span class="sd">        For example, can be used to output grib data directly to S3 using the boto3 client</span>
</span><span id="Grib2Message.to_bytes-1623"><a href="#Grib2Message.to_bytes-1623"><span class="linenos">1623</span></a><span class="sd">        without the need to write a temporary file to upload first.</span>
</span><span id="Grib2Message.to_bytes-1624"><a href="#Grib2Message.to_bytes-1624"><span class="linenos">1624</span></a>
</span><span id="Grib2Message.to_bytes-1625"><a href="#Grib2Message.to_bytes-1625"><span class="linenos">1625</span></a><span class="sd">        Parameters</span>
</span><span id="Grib2Message.to_bytes-1626"><a href="#Grib2Message.to_bytes-1626"><span class="linenos">1626</span></a><span class="sd">        ----------</span>
</span><span id="Grib2Message.to_bytes-1627"><a href="#Grib2Message.to_bytes-1627"><span class="linenos">1627</span></a><span class="sd">        **`validate`**: bool (Default: True) If true, validates first/last four bytes for proper formatting, else</span>
</span><span id="Grib2Message.to_bytes-1628"><a href="#Grib2Message.to_bytes-1628"><span class="linenos">1628</span></a><span class="sd">        returns None. If False, message is output as is.</span>
</span><span id="Grib2Message.to_bytes-1629"><a href="#Grib2Message.to_bytes-1629"><span class="linenos">1629</span></a>
</span><span id="Grib2Message.to_bytes-1630"><a href="#Grib2Message.to_bytes-1630"><span class="linenos">1630</span></a><span class="sd">        Returns</span>
</span><span id="Grib2Message.to_bytes-1631"><a href="#Grib2Message.to_bytes-1631"><span class="linenos">1631</span></a><span class="sd">        -------</span>
</span><span id="Grib2Message.to_bytes-1632"><a href="#Grib2Message.to_bytes-1632"><span class="linenos">1632</span></a><span class="sd">        Returns GRIB2 formatted message as bytes.</span>
</span><span id="Grib2Message.to_bytes-1633"><a href="#Grib2Message.to_bytes-1633"><span class="linenos">1633</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Grib2Message.to_bytes-1634"><a href="#Grib2Message.to_bytes-1634"><span class="linenos">1634</span></a>        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
</span><span id="Grib2Message.to_bytes-1635"><a href="#Grib2Message.to_bytes-1635"><span class="linenos">1635</span></a>            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;GRIB7777&#39;</span><span class="p">:</span>
</span><span id="Grib2Message.to_bytes-1636"><a href="#Grib2Message.to_bytes-1636"><span class="linenos">1636</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span>
</span><span id="Grib2Message.to_bytes-1637"><a href="#Grib2Message.to_bytes-1637"><span class="linenos">1637</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.to_bytes-1638"><a href="#Grib2Message.to_bytes-1638"><span class="linenos">1638</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Grib2Message.to_bytes-1639"><a href="#Grib2Message.to_bytes-1639"><span class="linenos">1639</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Message.to_bytes-1640"><a href="#Grib2Message.to_bytes-1640"><span class="linenos">1640</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span>
</span></pre></div>


            <div class="docstring"><p>Return grib data in byte format. Useful for exporting data in non-file formats.
For example, can be used to output grib data directly to S3 using the boto3 client
without the need to write a temporary file to upload first.</p>

<h2 id="parameters">Parameters</h2>

<p><strong><code>validate</code></strong>: bool (Default: True) If true, validates first/last four bytes for proper formatting, else
returns None. If False, message is output as is.</p>

<h2 id="returns">Returns</h2>

<p>Returns GRIB2 formatted message as bytes.</p>
</div>


                            </div>
                </section>
                <section id="Grib2Metadata">
                            <input id="Grib2Metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Grib2Metadata</span>:

                <label class="view-source-button" for="Grib2Metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Metadata-1643"><a href="#Grib2Metadata-1643"><span class="linenos">1643</span></a><span class="k">class</span> <span class="nc">Grib2Metadata</span><span class="p">():</span>
</span><span id="Grib2Metadata-1644"><a href="#Grib2Metadata-1644"><span class="linenos">1644</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Grib2Metadata-1645"><a href="#Grib2Metadata-1645"><span class="linenos">1645</span></a><span class="sd">    Class to hold GRIB2 metadata both as numeric code value as stored in</span>
</span><span id="Grib2Metadata-1646"><a href="#Grib2Metadata-1646"><span class="linenos">1646</span></a><span class="sd">    GRIB2 and its plain langauge definition.</span>
</span><span id="Grib2Metadata-1647"><a href="#Grib2Metadata-1647"><span class="linenos">1647</span></a>
</span><span id="Grib2Metadata-1648"><a href="#Grib2Metadata-1648"><span class="linenos">1648</span></a><span class="sd">    **`value : int`**</span>
</span><span id="Grib2Metadata-1649"><a href="#Grib2Metadata-1649"><span class="linenos">1649</span></a>
</span><span id="Grib2Metadata-1650"><a href="#Grib2Metadata-1650"><span class="linenos">1650</span></a><span class="sd">    GRIB2 metadata integer code value.</span>
</span><span id="Grib2Metadata-1651"><a href="#Grib2Metadata-1651"><span class="linenos">1651</span></a>
</span><span id="Grib2Metadata-1652"><a href="#Grib2Metadata-1652"><span class="linenos">1652</span></a><span class="sd">    **`table : str, optional`**</span>
</span><span id="Grib2Metadata-1653"><a href="#Grib2Metadata-1653"><span class="linenos">1653</span></a>
</span><span id="Grib2Metadata-1654"><a href="#Grib2Metadata-1654"><span class="linenos">1654</span></a><span class="sd">    GRIB2 table to lookup the `value`. Default is None.</span>
</span><span id="Grib2Metadata-1655"><a href="#Grib2Metadata-1655"><span class="linenos">1655</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Grib2Metadata-1656"><a href="#Grib2Metadata-1656"><span class="linenos">1656</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Grib2Metadata-1657"><a href="#Grib2Metadata-1657"><span class="linenos">1657</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Grib2Metadata-1658"><a href="#Grib2Metadata-1658"><span class="linenos">1658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
</span><span id="Grib2Metadata-1659"><a href="#Grib2Metadata-1659"><span class="linenos">1659</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Metadata-1660"><a href="#Grib2Metadata-1660"><span class="linenos">1660</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">definition</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Metadata-1661"><a href="#Grib2Metadata-1661"><span class="linenos">1661</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Metadata-1662"><a href="#Grib2Metadata-1662"><span class="linenos">1662</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">definition</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_value_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</span><span id="Grib2Metadata-1663"><a href="#Grib2Metadata-1663"><span class="linenos">1663</span></a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Metadata-1664"><a href="#Grib2Metadata-1664"><span class="linenos">1664</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="Grib2Metadata-1665"><a href="#Grib2Metadata-1665"><span class="linenos">1665</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Metadata-1666"><a href="#Grib2Metadata-1666"><span class="linenos">1666</span></a>        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(</span><span class="si">%d</span><span class="s1">, table = </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</span><span id="Grib2Metadata-1667"><a href="#Grib2Metadata-1667"><span class="linenos">1667</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Grib2Metadata-1668"><a href="#Grib2Metadata-1668"><span class="linenos">1668</span></a>        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">definition</span><span class="p">)</span>
</span><span id="Grib2Metadata-1669"><a href="#Grib2Metadata-1669"><span class="linenos">1669</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
</span><span id="Grib2Metadata-1670"><a href="#Grib2Metadata-1670"><span class="linenos">1670</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span>
</span><span id="Grib2Metadata-1671"><a href="#Grib2Metadata-1671"><span class="linenos">1671</span></a>    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
</span><span id="Grib2Metadata-1672"><a href="#Grib2Metadata-1672"><span class="linenos">1672</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">other</span>
</span><span id="Grib2Metadata-1673"><a href="#Grib2Metadata-1673"><span class="linenos">1673</span></a>    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
</span><span id="Grib2Metadata-1674"><a href="#Grib2Metadata-1674"><span class="linenos">1674</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">other</span>
</span><span id="Grib2Metadata-1675"><a href="#Grib2Metadata-1675"><span class="linenos">1675</span></a>    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
</span><span id="Grib2Metadata-1676"><a href="#Grib2Metadata-1676"><span class="linenos">1676</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="n">other</span>
</span><span id="Grib2Metadata-1677"><a href="#Grib2Metadata-1677"><span class="linenos">1677</span></a>    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
</span><span id="Grib2Metadata-1678"><a href="#Grib2Metadata-1678"><span class="linenos">1678</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">other</span>
</span><span id="Grib2Metadata-1679"><a href="#Grib2Metadata-1679"><span class="linenos">1679</span></a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
</span><span id="Grib2Metadata-1680"><a href="#Grib2Metadata-1680"><span class="linenos">1680</span></a>        <span class="k">return</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">definition</span>
</span></pre></div>


            <div class="docstring"><p>Class to hold GRIB2 metadata both as numeric code value as stored in
GRIB2 and its plain langauge definition.</p>

<p><strong><code>value : int</code></strong></p>

<p>GRIB2 metadata integer code value.</p>

<p><strong><code>table : str, optional</code></strong></p>

<p>GRIB2 table to lookup the <code>value</code>. Default is None.</p>
</div>


                            <div id="Grib2Metadata.__init__" class="classattr">
                                        <input id="Grib2Metadata.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Grib2Metadata</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span>, </span><span class="param"><span class="n">table</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Grib2Metadata.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Grib2Metadata.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Grib2Metadata.__init__-1656"><a href="#Grib2Metadata.__init__-1656"><span class="linenos">1656</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Grib2Metadata.__init__-1657"><a href="#Grib2Metadata.__init__-1657"><span class="linenos">1657</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Grib2Metadata.__init__-1658"><a href="#Grib2Metadata.__init__-1658"><span class="linenos">1658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
</span><span id="Grib2Metadata.__init__-1659"><a href="#Grib2Metadata.__init__-1659"><span class="linenos">1659</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Grib2Metadata.__init__-1660"><a href="#Grib2Metadata.__init__-1660"><span class="linenos">1660</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">definition</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Grib2Metadata.__init__-1661"><a href="#Grib2Metadata.__init__-1661"><span class="linenos">1661</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Grib2Metadata.__init__-1662"><a href="#Grib2Metadata.__init__-1662"><span class="linenos">1662</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">definition</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">get_value_from_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="show_config">
                            <input id="show_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">show_config</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="show_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#show_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="show_config-13"><a href="#show_config-13"><span class="linenos">13</span></a><span class="k">def</span> <span class="nf">show_config</span><span class="p">():</span>
</span><span id="show_config-14"><a href="#show_config-14"><span class="linenos">14</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="show_config-15"><a href="#show_config-15"><span class="linenos">15</span></a><span class="sd">    Print grib2io build configuration information.</span>
</span><span id="show_config-16"><a href="#show_config-16"><span class="linenos">16</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="show_config-17"><a href="#show_config-17"><span class="linenos">17</span></a>    <span class="kn">from</span> <span class="nn">g2clib</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">g2clib_version</span>
</span><span id="show_config-18"><a href="#show_config-18"><span class="linenos">18</span></a>    <span class="n">have_jpeg</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="s1">&#39;jasper&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="ow">or</span> <span class="s1">&#39;openjp2&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="show_config-19"><a href="#show_config-19"><span class="linenos">19</span></a>    <span class="n">have_png</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="s1">&#39;png&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="show_config-20"><a href="#show_config-20"><span class="linenos">20</span></a>    <span class="n">jpeglib</span> <span class="o">=</span> <span class="s1">&#39;OpenJPEG&#39;</span> <span class="k">if</span> <span class="s1">&#39;openjp2&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;Jasper&#39;</span> <span class="k">if</span> <span class="s1">&#39;jasper&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="show_config-21"><a href="#show_config-21"><span class="linenos">21</span></a>    <span class="n">pnglib</span> <span class="o">=</span> <span class="s1">&#39;libpng&#39;</span> <span class="k">if</span> <span class="s1">&#39;png&#39;</span> <span class="ow">in</span> <span class="n">__config__</span><span class="o">.</span><span class="n">libraries</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="show_config-22"><a href="#show_config-22"><span class="linenos">22</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;grib2io version </span><span class="si">%s</span><span class="s2"> Configuration:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">__version__</span><span class="p">))</span>
</span><span id="show_config-23"><a href="#show_config-23"><span class="linenos">23</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">g2c library version:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">g2clib_version</span><span class="p">)</span>
</span><span id="show_config-24"><a href="#show_config-24"><span class="linenos">24</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">JPEG compression support:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">have_jpeg</span><span class="p">)</span>
</span><span id="show_config-25"><a href="#show_config-25"><span class="linenos">25</span></a>    <span class="k">if</span> <span class="n">have_jpeg</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Library:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">jpeglib</span><span class="p">)</span>
</span><span id="show_config-26"><a href="#show_config-26"><span class="linenos">26</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">PNG compression support:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">have_png</span><span class="p">)</span>
</span><span id="show_config-27"><a href="#show_config-27"><span class="linenos">27</span></a>    <span class="k">if</span> <span class="n">have_png</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">Library:&quot;</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">pnglib</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Print grib2io build configuration information.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>